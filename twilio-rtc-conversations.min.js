/*

twilio-rtc-conversations.js v0.8 (0.8.3.b1-c938128)

Copyright (c) 2015 Twilio, Inc. All rights reserved. <https://twilio.com>

THIS SOFTWARE IS PROVIDED BY THE AUTHOR "AS IS" AND ANY EXPRESS OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY
OF SUCH DAMAGE.

This software includes third party open source software components: SIP.js.
Each of these software components have their own license. Please see below.

--- begin SIP.js license ---

Name: SIP.js
Copyright (c) 2014 Junction Networks, Inc. <http://www.onsip.com>

License: The MIT License

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

~~~ SIP.js contains substantial portions of the JsSIP software under the following license: ~~~

Copyright (c) 2012-2013 Jos? Luis Mill?n - Versatica <http://www.versatica.com>

License: The MIT License

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

~~~ end JsSIP license ~~~

--- end SIP.js license ---
*/
(function e$$0(l,n,c){function g(e,b){if(!n[e]){if(!l[e]){var a="function"==typeof require&&require;if(!b&&a)return a(e,!0);if(f)return f(e,!0);a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a;}a=n[e]={exports:{}};l[e][0].call(a.exports,function(a){var b=l[e][1][a];return g(b?b:a)},a,a.exports,e$$0,l,n,c)}return n[e].exports}for(var f="function"==typeof require&&require,e=0;e<c.length;e++)g(c[e]);return g})({1:[function(k,l,n){function c(e){if(e instanceof c)return e;if(!(this instanceof
c))return new c(e);f.call(this);var b=g(e),a=null,d=!1,m=!1,p=new Date(1E3*b.exp),x=b.grants||[];x.forEach(function(b){var c=b.res.match(/^sip:(.*)@/);c&&(a=c[1],d=-1!==b.act.indexOf("invite"),m=-1!==b.act.indexOf("listen"))});var y=this;setTimeout(function(){y.emit("expired",y)},p-Date.now());Object.defineProperties(this,{accountSid:{enumerable:!0,value:b.sub},address:{enumerable:!0,value:a},canInvite:{enumerable:!0,value:d},canListen:{enumerable:!0,value:m},expires:{enumerable:!0,value:p},grants:{enumerable:!0,
value:x},isExpired:{enumerable:!0,get:function(){return new Date>=p}},jwt:{enumerable:!0,value:e},signingKeySid:{enumerable:!0,value:b.iss}});return Object.freeze(this)}function g(c){c=c.split(".");if(3!==c.length)throw Error("Token is invalid or malformed");c=e.base64URL.decode(c[1]);return JSON.parse(c)}n=k("util").inherits;var f=k("events").EventEmitter,e=k("./util");n(c,f);l.exports=c},{"./util":20,events:30,util:34}],2:[function(k,l,n){function c(a,e){if(!(this instanceof c))return new c(a,e);
var p=this;f.call(this);var h=new Set,g=null,A=new Set,v=new b("Conversation",a._logLevel);Object.defineProperties(this,{_dialogs:{value:h},_endpoint:{value:a},_localMedia:{set:function(a){g=a}},_log:{value:v},localMedia:{enumerable:!0,get:function(){return g}},participants:{enumerable:!0,value:A},sid:{enumerable:!0,get:function(){var a=null;h.forEach(function(b){a=a||b.conversationSid});return a}}});e=e||[];e.forEach(function(a){p._addDialog(a)});return Object.freeze(this)}var g=k("./util/constants"),
f=k("events").EventEmitter;n=k("util").inherits;k("./media/track");var e=k("./participant"),h=k("q"),b=k("./util/log"),a=g.twilioErrors;n(c,f);c.prototype._addDialog=function(a){if(this._dialogs.has(a))return this;var b=this;this._localMedia=this.localMedia||a.localMedia;var c=new e(this,a);this._dialogs.add(a);this.participants.add(c);setTimeout(function(){b.emit("participantConnected",c);setTimeout(function(){c.on("trackAdded",function y(a){if(!b.participants.has(c))return c.removeListener("trackAdded",
y);b.emit("trackAdded",c,a)});c.on("trackRemoved",function A(a){if(!b.participants.has(c))return c.removeListener("trackRemoved",A);b.emit("trackRemoved",c,a)});c.media.audioTracks.forEach(function(a){c.emit("trackAdded",a)});c.media.videoTracks.forEach(function(a){c.emit("trackAdded",a)})})});a.once("ended",function(){b._removeDialog(a)});return this};c.prototype._removeDialog=function(a){var b=this,c=null;this.participants.forEach(function(e){e._dialog===a&&(c=e,b.participants.delete(c))});this._dialogs.delete(a);
this.emit("participantDisconnected",c);this._dialogs.size||this.emit("ended",this);return this};c.prototype.getStats=function(){var a=[];this._dialogs.forEach(function(b){a.push(b.getStats())});return h.all(a)};c.prototype.disconnect=function(){var a=this,b=[];this._dialogs.forEach(function(a){b.push(a.end())});return h.all(b).then(function(){return a})};c.prototype.invite=function(b){b||this._log.throw(a.INVALID_ARGUMENT,"No address was provided");var c=!!b.forEach;b=c?b:[b];var e;this._dialogs.forEach(function(a){e=
e||a});b=b.map(this._invite.bind(this,e));return c?b:b[0]};c.prototype._invite=function(b,c){function e(a){a.address===c&&(y.removeListener("participantConnected",e),f.resolve(a))}var f=h.defer(),y=this;this.on("participantConnected",e);setTimeout(function(){y.removeListener("participantConnected",e);var b=a.CONVERSATION_INVITE_FAILED.clone("Invite to Participant timed out.");y.emit("participantFailed",c,b);f.reject(b)},g.DEFAULT_CALL_TIMEOUT);b.refer(c).catch(function(a){y.emit("participantFailed",
c,a);y.removeListener("participantConnected",e);f.reject(a)});return f.promise};Object.freeze(c.prototype);l.exports=c},{"./media/track":6,"./participant":7,"./util/constants":19,"./util/log":21,events:30,q:35,util:34}],3:[function(k,l,n){function c(e,f){if(!(this instanceof c))return new c(e,f);var p=this;b.call(this);f=A.withDefaults(f,{eventGateway:g.EVENT_GATEWAY,logLevel:g.DEFAULT_LOG_LEVEL,userAgent:x});var v=f.logLevel;!0===f.debug&&(v="debug",console.warn("Warning: EndpointOptions.debug is deprecated and will be removed in a future release. Please see EndpointOptions.logLevel."));
var k=new d("Endpoint",v);e=this._createToken(e,k);var l=null;f.iceServers&&(A.isValidIceServerArray(f.iceServers)||k.throw(h.INVALID_ARGUMENT,"Invalid ICE Servers"),l=new m(f.iceServers));var l=(l||A.fetchIceServers(e,k)).then(function(a){a=A.separateIceServers(a);p._userAgent._stunServers=a.stunServers;p._userAgent._turnServers=a.turnServers}),E=new Set,n=new Set,z=f.eventGateway,w=new Set,I=!1,D=new Map,G=new Set,J=new f.userAgent(e,f);J.on("invite",function(b){var c=b.conversationSid,d=b.participantSid,
e=b.cookie,f=p._pendingConversations.get(e);if(f)return b.accept({localMedia:f.conversation.localMedia}).then(f.onReceiveInvite).catch(function(a){a=h.CONVERSATION_INVITE_FAILED.clone(a.message||a);f.conversation.emit("participantFailed",a)});if(E.has(e))return b.reject();var m=null;n.forEach(function(a){a.sid===c&&(m=m||a)});if(m)return b.accept({localMedia:m.localMedia}).then(m._addDialog.bind(m));if(G.has(c+d))return b.reject();var D=null;w.forEach(function(a){a.conversationSid===c&&a.participantSid===
d&&(D=D||a)});if(D)return D._inviteServerTransactions.push(b);if(!p.isListening)return b.reject();var x=new a(p,b);w.add(x);x._promise.then(function(a){w.delete(x);n.add(a);a.once("ended",function(){n.delete(a);p._unregisterIfNotNeeded()})},function(){w.delete(x);p._unregisterIfNotNeeded();G.add(c+d);setTimeout(function(){G.delete(c+d)},3*g.DEFAULT_CALL_TIMEOUT)});p.emit("invite",x)});J.on("dialogCreated",function(a){new y(z,a,v)});Object.defineProperties(this,{_canceledConversations:{value:E},_fetchIceServers:{value:l},
_isListening:{set:function(a){I=a}},_isRegistered:{enumerable:!0,get:function(){return this._userAgent.isRegistered}},_log:{value:k},_logLevel:{value:v},_pendingConversations:{value:D},_needsRegistration:{get:function(){return I||D.size||n.size||w.size||J.inviteClientTransactions.size}},_options:{value:f},_userAgent:{value:J},address:{enumerable:!0,get:function(){return this._userAgent.token.address}},conversations:{enumerable:!0,value:n},invites:{enumerable:!0,value:w},isListening:{enumerable:!0,
get:function(){return I}},token:{enumerable:!0,get:function(){return this._userAgent.token}}});return Object.freeze(this)}n=k("util").inherits;var g=k("./util/constants"),f=k("./conversation"),e=k("./util/cancelablepromise"),h=g.twilioErrors,b=k("events").EventEmitter;k("./webrtc/getusermedia");var a=k("./invite"),d=k("./util/log"),m=k("q"),p=k("./accesstoken"),x=k("./signaling/sipjsuseragent"),y=k("./statsreporter"),A=k("./util"),v=k("./media").LocalMedia;n(c,b);c.prototype.unlisten=function(){this._isListening=
!1;return this._unregisterIfNotNeeded()};c.prototype._unregister=function(){if(!this._isRegistered)return new m(this);var a=this;return this._userAgent.unregister().then(function(){a._isListening=!1;return a})};c.prototype.listen=function(a){return!this.isListening||a&&a!==this.token?this._register(a).then(function(a){a._isListening=!0;return a}):(a=m.defer(),setTimeout(a.resolve.bind(a,this)),a.promise)};c.prototype._register=function(a){var b=this;return this._fetchIceServers.then(function(){a=
b._createToken.call(b,a);return b._userAgent.register(a)}).then(function(){return b},function(a){var c=A.getOrNull(a,"headers.X-Twilio-Error.0.raw");(a=a.cause)?b._log.throw(h.LISTEN_FAILED,"Received SIP error: "+a):b._log.throw(h.LISTEN_FAILED,"Gateway responded with: "+c)})};c.prototype.createConversation=function(a,b){function c(a){y._addDialog(a);y.once("ended",function(){n.conversations.delete(y);n._unregisterIfNotNeeded()});n.conversations.add(y);a=k.promise;a.isFulfilled()||a.isRejected()||
k.resolve(y)}b=A.withDefaults({},b,this._options);var d=b.localMedia,p=b.localStreamConstraints,x=b.localStream;!d||d instanceof v||this._log.throw(h.INVALID_ARGUMENT,"Invalid local media");x&&"object"!==typeof x&&this._log.throw(h.INVALID_ARGUMENT,"Invalid local media stream");p&&"undefined"===typeof p.audio&&"undefined"===typeof p.video&&this._log.throw(h.INVALID_ARGUMENT,"Invalid local media stream constraints");a||this._log.throw(h.INVALID_ARGUMENT,"No address was provided");a=a.forEach?a:[a];
var y=new f(this),k=m.defer(),z=null,l=!1,n=this,D=this._userAgent;if(1<a.length){var G=A.makeUUID();b.cookie=G;this._pendingConversations.set(G,{conversation:y,onReceiveInvite:c});setTimeout(function(){n._pendingConversations.delete(G);n._canceledConversations.delete(G);n._unregisterIfNotNeeded()},3*g.DEFAULT_CALL_TIMEOUT)}(d?new m(d):v.getLocalMedia(b)).catch(function(a){-1<["PermissionDeniedError","PERMISSION_DENIED"].indexOf(a.name)&&(a=h.MEDIA_ACCESS_DENIED);k.reject(a)}).then(function(a){y._localMedia=
a;b.localMedia=a}).then(this.listen.bind(this)).then(function(){if(l)throw Error("canceled");return z=D.invite(a,b)}).catch(function(a){switch(a.message){case "canceled":a="Conversation invite was canceled";break;case "rejected":a="Conversation invite was rejected or Participant does not exist";break;case "ignored":a="Conversation invite timed out";break;case "failed":a="Unable to reach Participant";break;default:a="An unknown error occurred"}k.reject(h.CONVERSATION_CREATE_FAILED.clone(a))}).then(c);
d=new e(k.promise);d.catch(function(a){"canceled"===a.message&&(n._canceledConversations.add(G),n._pendingConversations.delete(G),z?z.cancel():l=!0,n._unregisterIfNotNeeded());n._log.throw(a)});return d};c.prototype._createToken=function(a,b){if(!a)return this.token;b=b||this._log;try{a=new p(a)}catch(c){b.throw(h.INVALID_TOKEN,c.message)}var d=this;a.once("expired",function(a){a===d.token&&d.emit("error",h.TOKEN_EXPIRED)});return a};c.prototype._unregisterIfNotNeeded=function(){return this._needsRegistration?
new m(this):this._unregister()};Object.freeze(c.prototype);l.exports=c},{"./accesstoken":1,"./conversation":2,"./invite":4,"./media":5,"./signaling/sipjsuseragent":15,"./statsreporter":17,"./util":20,"./util/cancelablepromise":18,"./util/constants":19,"./util/log":21,"./webrtc/getusermedia":25,events:30,q:35,util:34}],4:[function(k,l,n){function c(a,b){if(!(this instanceof c))return new c(a,b);var h=this;f.call(this);var p=null,g=b.from,y=b.participantSid,A=b.to,k=e.defer(),l=[b];Object.defineProperties(this,
{_conversation:{set:function(a){p=a},get:function(){return p}},_deferred:{value:k},_endpoint:{value:a},_inviteServerTransaction:{value:b},_inviteServerTransactions:{value:l},_promise:{value:k.promise},accepted:{enumerable:!0,get:function(){return l.reduce(function(a,b){return a||b.accepted},!1)}},canceled:{enumerable:!0,get:function(){return l.reduce(function(a,b){return a&&b.canceled},!0)}},conversationSid:{enumerable:!0,value:b.conversationSid},from:{enumerable:!0,value:g},participantAddresses:{enumerable:!0,
get:function(){return l.map(function(a){return a.from})}},participantSid:{value:y},rejected:{enumerable:!0,get:function(){return l.reduce(function(a,b){return a||b.accepted},!1)?!1:l.reduce(function(a,b){return a||b.rejected},!1)}},status:{enumerable:!0,get:function(){switch(!0){case this.accepted:return"accepted";case this.rejected:return"rejected";case this.canceled:return"canceled";default:return"pending"}}},to:{enumerable:!0,value:A}});b.once("canceled",function(){h.emit("canceled",h)});return Object.freeze(this)}
var g=k("./conversation"),f=k("events").EventEmitter;n=k("util").inherits;var e=k("q"),h=k("./util"),b=k("./media").LocalMedia;n(c,f);c.prototype.accept=function(a){var c=this;if(this.accepted)return new e(this._conversation);a=a||{};return b.getLocalMedia(a).then(function(b){a.localMedia=b;b=c._inviteServerTransactions.map(function(b){return b.accept(a).then(function(a){c._conversation||(c._conversation=new g(c._endpoint),c._deferred.resolve(c._conversation));c._conversation._addDialog(a);return a})});
return h.race(b).then(function(){setTimeout(function(){c.emit("accepted",c)});return c._conversation},function(a){setTimeout(function(){c.emit("failed",c)});c._deferred.reject(a);throw a;})})};c.prototype.reject=function(){var a=this;return this.rejected?new e(this):this._inviteServerTransaction.reject().then(function(){setTimeout(function(){a.emit("rejected",a)});return a},function(b){setTimeout(function(){a.emit("rejected",a)});return a})};Object.freeze(c.prototype);l.exports=c},{"./conversation":2,
"./media":5,"./util":20,events:30,q:35,util:34}],5:[function(k,l,n){function c(b){a.call(this);b=new Map;var c=new Set,d=new Set,e=new Set;Object.defineProperties(this,{attachments:{enumerable:!0,value:b},audioTracks:{enumerable:!0,value:c},mediaStreams:{enumerable:!0,value:d},muted:{enumerable:!0,get:function(){var a=!0;c.forEach(function(b){a=a&&b.muted});return a},set:function(a){c.forEach(function(b){b.muted=a})}},paused:{enumerable:!0,get:function(){var a=!0;e.forEach(function(b){a=a&&b.paused});
return a},set:function(a){e.forEach(function(b){b.paused=a})}},videoTracks:{enumerable:!0,value:e}});return this}function g(a,b){if(a.attachments.has(b))return b;var c=new Map;[a.audioTracks,a.videoTracks].forEach(function(d){d.forEach(function(d){a._attachTrack(b,c,d)},a)},a);a.on("trackAdded",function q(d){if(!a.attachments.has(b))return a.removeListener("trackAdded",q);a._attachTrack(b,c,d)});a.attachments.set(b,c);return b}function f(a,b){if(!a.attachments.has(b))return b;var c=a.attachments.get(b);
a.attachments.delete(b);c.forEach(function(d,e){a._detachTrack(b,c,e)});return b}function e(a){var b=[];a.attachments.forEach(function(c,d){b.push(d);f(a,d)});return b}function h(){if(!(this instanceof h))return new h;c.call(this);var a=null;Object.defineProperties(this,{_needs:{value:new Set},_nextUserMedia:{get:function(){return a},set:function(b){a=b}}});return Object.freeze(this)}function b(a){this.mediaStreams.add(a);a.getAudioTracks().forEach(function(b){b=new p(a,b);this._addTrack(b)},this);
a.getVideoTracks().forEach(function(b){b=new x(a,b);this._addTrack(b)},this);return this}var a=k("events").EventEmitter,d=k("../webrtc/getusermedia");n=k("util").inherits;var m=k("q");k=k("./track");var p=k.AudioTrack,x=k.VideoTrack;n(c,a);c.prototype._addStream=b;c.prototype._addTrack=function(a){var b=this;this.mediaStreams.add(a.mediaStream);("audio"===a.kind?this.audioTracks:this.videoTracks).add(a);a.once("ended",function(c){b._removeTrack(a)});this.emit("trackAdded",a);return this};c.prototype._attachTrack=
function(a,b,c){var d=this,e=c.attach();this instanceof h&&c instanceof p&&(e.muted=!0);a.appendChild(e);b.set(c,e);c.once("ended",function(){d._detachTrack(a,b,c)});return this};c.prototype._detachTrack=function(a,b,c){var d=b.get(c);if(!d)return this;c.detach(d);a.removeChild(d);b.delete(c);return this};c.prototype._removeTrack=function(a){this.mediaStreams.delete(a.mediaStream);("audio"===a.kind?this.audioTracks:this.videoTracks).delete(a);this.emit("trackRemoved",a);return this};c.prototype.attach=
function(a){if(a){if("string"===typeof a){if("undefined"===typeof document)throw Error("document is undefined");a=document.querySelector(a);if(!a)throw Error("document.querySelector returned nothing");return this.attach(a)}return g(this,a)}if("undefined"===typeof document)throw Error("document is undefined");return this.attach(document.createElement("div"))};c.prototype.detach=function(a){if(a){if("string"===typeof a){if("undefined"===typeof document)throw Error("document is undefined");a=document.querySelector(a);
if(!a)throw Error("document.querySelector returned nothing");}return f(this,a)}return e(this)};h.getLocalMedia=function(a){a=a||{};if(a.localMedia)return new m(a.localMedia);var b=new h;return a.localStream?(b.addStream(a.localStream),new m(b.addStream(a.localStream))):d(a.localStreamConstraints).then(function(a){return b.addStream(a)})};n(h,c);h.prototype.addMicrophone=function(){var a=this,b=null;this.audioTracks.forEach(function(a){b=b||"microphone"===a.label&&a});return b?new m(b):d({audio:!0,
video:!1}).then(function(b){var c=b.getAudioTracks()[0];b=new p(b,c);a._addTrack(b);return b})};h.prototype.removeMicrophone=function(){var a=null;this.audioTracks.forEach(function(b){a=a||"microphone"===b.label&&b});return a?this._removeTrack(a):null};h.prototype.addCamera=function(){var a=this,b=null;this.videoTracks.forEach(function(a){b=b||"camera"===a.label&&a});return b?new m(b):d({audio:!1,video:!0}).then(function(b){var c=b.getVideoTracks()[0];b=new x(b,c);a._addTrack(b);return b})};h.prototype.removeCamera=
function(){var a=null;this.videoTracks.forEach(function(b){a=a||"camera"===b.label&&b});return a?this._removeTrack(a):null};h.prototype.addStream=b;h.prototype._removeTrack=function(a){var b=this;c.prototype._removeTrack.call(this,a);a.mediaStream.stop();[this.audioTracks,this.videoTracks].forEach(function(c){c.forEach(function(c){c.mediaStream===a.mediaStream&&(this._removeTrack(c),this._needs.add(c.label),this._nextUserMedia||(this._nextUserMedia=setTimeout(function(){b._nextUserMedia=null;var a=
b._needs.has("camera");b._needs.delete("camera");var c=b._needs.has("microphone");b._needs.delete("microphone");if(a||c)a&&!c?b.addCamera():c&&!a?b.addMicrophone():d().then(b.addStream.bind(b))})))},this)},this);this._needs.delete(a.label);return a};h.prototype.stop=function(){[this.audioTracks,this.videoTracks].forEach(function(a){a.forEach(function(a){a.stop()})});return this};c.LocalMedia=h;l.exports=c},{"../webrtc/getusermedia":25,"./track":6,events:30,q:35,util:34}],6:[function(k,l,n){function c(a,
b){x.call(this);Object.defineProperties(this,{label:{enumerable:!0,value:"audio"===b.kind?"microphone":"camera"},kind:{enumerable:!0,value:b.kind},mediaStream:{enumerable:!0,value:a},mediaStreamTrack:{enumerable:!0,value:b}});var c=this;b.onended=function(){c.emit("ended",c)}}function g(a,b){if(!(this instanceof g))return new g(a,b);c.call(this,a,b);Object.defineProperties(this,{muted:{enumerable:!0,get:function(){return!b.enabled},set:function(a){b.enabled=!a}},attachments:{enumerable:!0,value:new Set}});
return Object.freeze(this)}function f(a,b){if("undefined"!==typeof window&&"undefined"!==typeof navigator)return"function"===typeof navigator.webkitGetUserMedia?a.src=(window.URL||window.webkitURL).createObjectURL(b):"function"===typeof navigator.mozGetUserMedia&&(a.mozSrcObject=b),a.play(),a;throw Error("Cannot attach to <audio> element");}function e(a,b){if(!(this instanceof e))return new e(a,b);c.call(this,a,b);Object.defineProperties(this,{paused:{enumerable:!0,get:function(){return!b.enabled},
set:function(a){b.enabled=!a}},attachments:{value:new Set}});a.onaddtrack=function(){this.attachments.forEach(function(b){d(this,b);h(b,a)},this)}.bind(this);return Object.freeze(this)}function h(a,b){if("undefined"!==typeof window&&"undefined"!==typeof navigator)return"function"===typeof navigator.webkitGetUserMedia?a.src=(window.URL||window.webkitURL).createObjectURL(b):"function"===typeof navigator.mozGetUserMedia&&(a.mozSrcObject=b),a.muted=!0,a.play(),a;throw Error("Cannot attach to <video> element");
}function b(b,c){if(c){if("string"===typeof c){if("undefined"===typeof document)throw Error("document is undefined");var d=document.querySelector(c);if(!d)throw Error("document.querySelector returned nothing");return a(b,d)}return a(b,c)}if("undefined"===typeof document)throw Error("document is undefined");d=document.createElement(b.kind);return a(b,d)}function a(a,b){if(a.attachments.has(b))return b;("audio"===a.kind?f:h)(b,a.mediaStream);a.attachments.add(b);return b}function d(a,b){if(b){if("string"===
typeof b){if("undefined"===typeof document)throw Error("document is undefined");var c=document.querySelector(b);if(!c)throw Error("document.querySelector returned nothing");return m(a,c)}return m(a,b)}return p(a)}function m(a,b){if(!a.attachments.has(b))return b;b.removeAttribute("src");a.attachments.delete(b);return b}function p(a){var b=[];a.attachments.forEach(function(c){b.push(c);m(a,c)});return b}var x=k("events").EventEmitter;k=k("util").inherits;k(c,x);c.prototype.stop=function(){this.mediaStreamTrack.stop();
return this};k(g,c);g.prototype.attach=function(a){return b(this,a)};g.prototype.detach=function(a){return d(this,a)};k(e,c);e.prototype.attach=function(a){return b(this,a)};e.prototype.detach=function(a){return d(this,a)};c.AudioTrack=g;c.VideoTrack=e;l.exports=c},{events:30,util:34}],7:[function(k,l,n){function c(e,h){if(!(this instanceof c))return new c(e,h);g.call(this);var b=h.remoteMedia,a=h&&f.getOrNull(h,"session.mediaHandler.peerConnection");Object.defineProperties(this,{_dialog:{value:h},
address:{enumerable:!0,value:h.remote},conversation:{enumerable:!0,value:e},media:{enumerable:!0,value:b},peerConnection:{enumerable:!0,value:a},sid:{enumerable:!0,value:null}});b.on("trackAdded",this.emit.bind(this,"trackAdded"));b.on("trackRemoved",this.emit.bind(this,"trackRemoved"));return Object.freeze(this)}var g=k("events").EventEmitter;n=k("util").inherits;var f=k("./util");n(c,g);Object.freeze(c.prototype);l.exports=c},{"./util":20,events:30,util:34}],8:[function(k,l,n){function c(b,a,c,
e,p,h,y){function k(a,b){if(v.ended)p.removeListener("trackAdded",r),p.removeListener("trackRemoved",t);else{var c=!a,d=y.getLocalStreams();if(d){var e=!1;d.forEach(function(a){a===b.mediaStream&&(e=!0)});a&&!e?(y.addStream(b.mediaStream),v._reinvite()):c&&e&&(y.removeStream(b.mediaStream),v._reinvite())}}}var v=this;f.call(this);var l=!1,q=null;Object.defineProperties(this,{_ended:{set:function(a){l=a}},_sampleInterval:{get:function(){return q},set:function(a){q=a}},callSid:{enumerable:!0,value:e},
conversationSid:{enumerable:!0,value:c},ended:{enumerable:!0,get:function(){return l}},localMedia:{enumerable:!0,value:p},peerConnection:{enumerable:!0,value:y},remote:{enumerable:!0,value:a},remoteMedia:{enumerable:!0,value:h},userAgent:{enumerable:!0,value:b}});var r=k.bind(null,!0),t=k.bind(null,!1);p.on("trackAdded",r);p.on("trackRemoved",t);try{g(this,1E3)}catch(u){throw console.error(u),u;}return this}function g(b,a){var c=b.peerConnection;b._sampleInterval=setInterval(function(){e(c,function(a,
c){a||b.emit("stats",c)})},a);b.once("ended",function(){b._sampleInterval&&(clearInterval(b._sampleInterval),b._sampleInterval=null)})}var f=k("events").EventEmitter,e=k("../webrtc/getstatistics");n=k("util").inherits;var h=k("q");n(c,f);c.prototype.end=function(){if(this.ended)throw Error("Dialog already ended");this._ended=!0;var b=this,a=h.defer();setTimeout(function(){a.resolve(b);b.emit("ended",b)});return a.promise};c.prototype._reinvite=function(){var b=this,a=h.defer();setTimeout(function(){a.resolve(b);
b.emit("reinvite",b)});return a.promise};c.prototype.refer=function(b){return this._refer(b).then(this._onReferSuccess.bind(this),this._onReferFailure.bind(this))};c.prototype._refer=function(b){var a=this,c=h.defer();setTimeout(function(){c.resolve(a)});return c.promise};c.prototype._onReferSuccess=function(){return this};c.prototype._onReferFailure=function(b){throw b;};c.prototype.getStats=function(){var b=this,a=h.defer();e(this.peerConnection,function(c,e){if(c)return a.reject(c);a.resolve({callsid:b.callSid,
samples:[e]})});return a.promise};l.exports=c},{"../webrtc/getstatistics":24,events:30,q:35,util:34}],9:[function(k,l,n){function c(c){var h=this;g.call(this);var b=!1,a=!1,d=!1,m=!1,p=null,x=f.defer(),y=x.promise.then(function(a){p=a;setTimeout(function(){h.emit("accepted",p)});return p},function(a){switch(!0){case h.canceled:setTimeout(function(){h.emit("canceled",a)});break;case h.rejected:setTimeout(function(){h.emit("rejected",a)});break;default:setTimeout(function(){h.emit("failed",a)})}throw a;
});Object.defineProperties(this,{_accepted:{set:function(a){b=a}},_canceled:{set:function(b){a=b}},_deferred:{value:x},_failed:{set:function(a){d=a}},_promise:{value:y},_rejected:{set:function(a){m=a}},accepted:{enumerable:!0,get:function(){return b}},canceled:{enumerable:!0,get:function(){return a}},dialog:{enumerable:!0,get:function(){return p}},failed:{enumerable:!0,get:function(){return d}},rejected:{enumerable:!0,get:function(){return m}},userAgent:{enumerable:!0,value:c}});return this}var g=
k("events").EventEmitter;n=k("util").inherits;var f=k("q");c._checkInviteTransactionState=function(c){if(c.accepted)throw Error("InviteTransaction already accepted");if(c.canceled)throw Error("InviteTransaction already canceled");if(c.rejected)throw Error("InviteTransaction already rejected");if(c.failed)throw Error("InviteTransaction failed");};n(c,g);c.prototype.then=function(c,f){return this._promise.then(c,f)};Object.freeze(c.prototype);l.exports=c},{events:30,q:35,util:34}],10:[function(k,l,
n){function c(c,h,b){g.call(this,c,h,b);b=f.withDefaults(b,{});var a=b.localMedia;Object.defineProperties(this,{_media:{set:function(b){a=b}},media:{enumerable:!0,get:function(){return a}},to:{enumerable:!0,value:h}})}n=k("util").inherits;var g=k("./");k("q");var f=k("../../util");n(c,g);c.prototype.cancel=function(){var c=this;setTimeout(function(){try{g._checkInviteTransactionState(c)}catch(f){return}c._canceled=!0;c._deferred.reject(c)});return this.then(function(){g._checkInviteTransactionState(c)},
function(c){if(c.canceled)return c;g._checkInviteTransactionState(c)})};l.exports=c},{"../../util":20,"./":9,q:35,util:34}],11:[function(k,l,n){function c(c,f,b,a,d,m){g.call(this,c);Object.defineProperties(this,{callSid:{enumerable:!0,value:a},conversationSid:{enumerable:!0,value:b},cookie:{enumerable:!0,value:m},from:{enumerable:!0,value:f},participantSid:{value:d}});return this}n=k("util").inherits;var g=k("./"),f=k("../../util");n(c,g);c.prototype.accept=function(c){var h=this;c=f.withDefaults(c,
{});setTimeout(function(){try{g._checkInviteTransactionState(h)}catch(b){return}h._accepted=!0;h._deferred.resolve(h.dialog)});return this.then(function(){g._checkInviteTransactionState(h);return h},function(b){throw b;})};c.prototype.reject=function(){var c=this;setTimeout(function(){try{g._checkInviteTransactionState(c)}catch(f){return}c._rejected=!0;c._deferred.reject(c)});return this.then(function(){g._checkInviteTransactionState(c)},function(c){throw c;})};l.exports=c},{"../../util":20,"./":9,
util:34}],12:[function(k,l,n){function c(f,x,y){if(!(this instanceof c))return new c(f,x,y);var k=this;e.call(this,f);y=a.withDefaults(y,{stunServers:f.stunServers,turnServers:f.turnServers});x=x.forEach?x:[x];var l=y.callTimeout||h.DEFAULT_CALL_TIMEOUT,n=null,q=null;f.connect().then(function(){return m.getLocalMedia(y)}).then(function(c){k._media=c;if(k.canceled)return k._deferred.reject(Error("canceled"));q=g(f,x,y,c);n=setTimeout(function(){k.cancel();k._deferred.reject(Error("ignored"))},l);var e=
Date.now(),h=null;q.on("progress",function(a){180===a.statusCode&&(h=Date.now())});q.once("accepted",function(m){var g=m.getHeader("X-Twilio-CallSid"),y=q.mediaHandler.peerConnection,z=new d(y);q.mediaHandler.on("addStream",function(a){z._addStream(a.stream)});var l=h?h-e:null;m=a.parseConversationSIDFromContactHeader(m.getHeader("Contact"));g=new b(f,x[0],m,g,c,z,y,q,l);clearTimeout(n);k._deferred.resolve(g)});q.once("rejected",function(){k._rejected=!0;clearTimeout(n);k._deferred.reject(Error("rejected"))});
q.once("failed",function(){k.accepted&&k.canceled||(k._failed=!0,clearTimeout(n),k._deferred.reject(Error("failed")))})}).then(null,function(a){k._failed=!0;n&&clearTimeout(n);k._deferred.reject(a)});Object.defineProperties(this,{session:{enumerable:!0,get:function(){return q}}});return Object.freeze(this)}function g(a,b,c,d){var e=a.token,f=b.map(function(a){return"sip:"+a+"@"+h.REGISTRAR_SERVER(e.accountSid)});b=f.shift();var m=[h.headers.X_TWILIO_TOKEN+": "+e.jwt,h.headers.X_TWILIO_CLIENT+": "+
JSON.stringify({p:"browser"}),h.headers.X_TWILIO_CLIENTVERSION+": "+h.CLIENT_VERSION];f.length&&(f=f.join(",")+";cookie="+c.cookie,m.push(h.headers.X_TWILIO_PARTICIPANTS+": "+f));var g=[];d.mediaStreams.forEach(function(a){g.push(a)});return a._ua.invite(b,{extraHeaders:m,inviteWithoutSdp:c.inviteWithoutSdp,media:{stream:g[0]},stunServers:c.stunServers,turnServers:c.turnServers})}n=k("util").inherits;var f=k("./"),e=k("./inviteclienttransaction");k("q");var h=k("../../util/constants"),b=k("../sipjsdialog"),
a=k("../../util"),d=k("../../media"),m=d.LocalMedia;n(c,e);c.prototype.cancel=function(){var a=this;setTimeout(function(){try{f._checkInviteTransactionState(a)}catch(b){return}a.session?(a.session.once("cancel",function(){try{f._checkInviteTransactionState(a)}catch(b){return}a._canceled=!0;a._deferred.reject(a)}),a.session.cancel()):a._canceled=!0});return this.then(function(){f._checkInviteTransactionState(a)},function(a){if(a.canceled)return a;f._checkInviteTransactionState(a)})};Object.freeze(c.prototype);
l.exports=c},{"../../media":5,"../../util":20,"../../util/constants":19,"../sipjsdialog":14,"./":9,"./inviteclienttransaction":10,q:35,util:34}],13:[function(k,l,n){function c(b,d){if(!(this instanceof c))return new c(b,d);var m=d.request,k=m.from.uri.user,l=a.parseConversationSIDFromContactHeader(m.getHeader("Contact")),n=m.getHeader(f.X_TWILIO_CALLSID),q=m.getHeader(f.X_TWILIO_PARTICIPANTSID),m=(q=q?q.split(";"):null)?q[0]:null,r=/^cookie=([^\s]+)/i,q=q&&q[1]&&r.test(q[1])&&q[1].match(r)[1];e.call(this,
b,k,l,n,m,q);Object.defineProperties(this,{session:{enumerable:!0,value:d}});var t=this;d.once("cancel",function(){try{h._checkInviteTransactionState(t)}catch(a){return}t._canceled=!0;var b=g.CONVERSATION_JOIN_FAILED.clone("Incoming Invite was canceled by the sender");t._deferred.reject(b)});d.once("failed",function(b){try{h._checkInviteTransactionState(t)}catch(c){return}t._failed=!0;b=a.getOrNull(b,"headers.X-Twilio-Error.0.raw")||"An unknown error occurred";b=g.CONVERSATION_JOIN_FAILED.clone(b);
t._deferred.reject(b)});return Object.freeze(this)}var g=k("../../util/constants").twilioErrors,f=k("../../util/constants").headers;n=k("util").inherits;var e=k("./inviteservertransaction"),h=k("./"),b=k("../sipjsdialog");k("q");var a=k("../../util"),d=k("../../media"),m=d.LocalMedia;n(c,e);c.prototype.accept=function(c){var e=this;h._checkInviteTransactionState(this);c=a.withDefaults(c,{});m.getLocalMedia(c).then(function(a){var f=[];a.mediaStreams.forEach(function(a){f.push(a)});c.media=c.media||
{};c.media.stream=f[0];e.session.accept(c);e.session.once("accepted",function(){try{h._checkInviteTransactionState(e)}catch(c){return}var f=null,m=e.session.mediaHandler.peerConnection,p=new d(m);e.session.mediaHandler.on("addStream",function(a){a&&p._addStream(a.stream)});(m.getRemoteStreams()||[]).forEach(p._addStream,p);if(!e.session.hasOffer)f=new b(e.userAgent,e.from,e.conversationSid,e.callSid,a,p,m,e.session,null),e._accepted=!0,e._deferred.resolve(f);else if(e.session.hasOffer&&e.session.hasAnswer)f=
new b(e.userAgent,e.from,e.conversationSid,e.callSid,a,p,m,e.session,null),e._accepted=!0,e._deferred.resolve(f);else if(e.session.hasOffer&&!e.session.hasAnswer)e.session.mediaHandler.once("addStream",function(){f=new b(e.userAgent,e.from,e.conversationSid,e.callSid,a,p,m,e.session,null);e._accepted=!0;e._deferred.resolve(f)})})});return this};c.prototype.reject=function(){var a=this;setTimeout(function(){try{h._checkInviteTransactionState(a)}catch(b){return}a.session.once("rejected",function(){try{h._checkInviteTransactionState(a)}catch(b){return}a._rejected=
!0;a._deferred.reject(a)});a.session.reject()});return this.then(function(){h._checkInviteTransactionState(a)},function(a){if(a.rejected)return a;h._checkInviteTransactionState(a)})};Object.freeze(c.prototype);l.exports=c},{"../../media":5,"../../util":20,"../../util/constants":19,"../sipjsdialog":14,"./":9,"./inviteservertransaction":11,q:35,util:34}],14:[function(k,l,n){function c(f,b,a,d,m,p,x,k,l){if(!(this instanceof c))return new c(f,b,a,d,m,p,x,k,l);var v=this;g.call(this,f,b,a,d,m,p,x);Object.defineProperties(this,
{inviteTo180:{enumerable:!0,value:l},session:{enumerable:!0,value:k}});x.oniceconnectionstatechange=function(a){switch(a.target.iceConnectionState){case "failed":return v.emit("failed",e.ICE_CONNECT_FAILED);case "disconnected":return v.emit("disconnected",e.ICE_DISCONNECTED)}};k.once("failed",function(){v._ended=!0;v.emit("failed",v)});k.once("bye",function(){v._ended=!0;v.emit("ended",v)});return Object.freeze(this)}var g=k("./dialog");n=k("util").inherits;var f=k("q"),e=k("../util/constants").twilioErrors;
n(c,g);c.prototype.end=function(){if(this.ended)throw Error("Dialog already ended");this._ended=!0;var c=this,b=f.defer();c.session.once("bye",function(){b.resolve(c);c.emit("ended",c)});c.session.bye();return b.promise};c.prototype._reinvite=function(){this.session.sendReinvite()};c.prototype._refer=function(c){var b=this,a=f.defer();b.session.refer(c,{receiveResponse:function(c){202==c.status_code?a.resolve(b):a.reject(c)}});return a.promise};Object.freeze(c.prototype);l.exports=c},{"../util/constants":19,
"./dialog":8,q:35,util:34}],15:[function(k,l,n){function c(a,e){if(!(this instanceof c))return new c(a,e);var k=a.accountSid,l=a.address+"@"+f.REGISTRAR_SERVER(k);e=m.withDefaults(e,{inviteClientTransactionFactory:b,logLevel:f.DEFAULT_LOG_LEVEL,registrarServer:f.REGISTRAR_SERVER(k),wsServer:f.WS_SERVER(k),uaFactory:h.UA});var k="debug"===e.logLevel,v=/^wss:\/\//.test(e.wsServer),n=g.call(this,new e.uaFactory({autostart:!1,log:{builtinEnabled:k},register:!1,registrarServer:e.registrarServer,traceSip:k,
uri:l,wsServers:e.wsServer,hackWssInTransport:v})),q=[],r=[];Object.defineProperties(this,{_ua:{value:n},_stunServers:{set:function(a){q=a;m.overwriteArray(n.configuration.stunServers,q)}},_turnServers:{set:function(a){r=a;m.overwriteArray(n.configuration.turnServers,r)}},stunServers:{enumerable:!0,get:function(){return q}},turnServers:{enumerable:!0,get:function(){return r}}});d.call(this,a,e);return Object.freeze(this)}function g(b){var c=this;b.on("invite",function(b){b=new a(c,b);c._handleInviteServerTransaction(b)});
return b}var f=k("../util/constants");n=k("util").inherits;var e=k("q");k("../conversation");k("../accesstoken");var h=k("sip.js");k("./sipjsdialog.js");var b=k("./invitetransaction/sipjsinviteclienttransaction.js"),a=k("./invitetransaction/sipjsinviteservertransaction"),d=k("./useragent"),m=k("../util");n(c,d);c.prototype._register=function(a){function b(){var d=m.makeRegisterHeaders(a);c._ua.register({extraHeaders:d,closeWithHeaders:!0})}var c=this;return this.connect().then(function(){return m.promiseFromEvents(b,
c._ua,"registered","registrationFailed")})};c.prototype._unregister=function(){function a(){var d=m.makeRegisterHeaders(c);b._ua.unregister({extraHeaders:d})}var b=this,c=b.token;return this.connect().then(function(){return m.promiseFromEvents(a,b._ua,"unregistered")})};c.prototype._connect=function(){var a=this;return m.promiseFromEvents(function(){a._ua.start()},this._ua,"connected","disconnected")};c.prototype._disconnect=function(){this._ua.stop();this._ua.transport.disconnect();var a=e.defer();
setTimeout(a.resolve);return a.promise};Object.freeze(c.prototype);l.exports=c},{"../accesstoken":1,"../conversation":2,"../util":20,"../util/constants":19,"./invitetransaction/sipjsinviteclienttransaction.js":12,"./invitetransaction/sipjsinviteservertransaction":13,"./sipjsdialog.js":14,"./useragent":16,q:35,"sip.js":70,util:34}],16:[function(k,l,n){function c(b,a){g.call(this);a=h.withDefaults(a,{inviteClientTransactionFactory:f});var c=!1,e=!1;Object.defineProperties(this,{_inviteClientTransactionFactory:{value:a.inviteClientTransactionFactory},
_isConnected:{set:function(a){e=a}},_isRegistered:{set:function(a){c=a}},_token:{set:function(a){b=a}},callTimeout:{value:a&&a.callTimeout},dialogs:{enumerable:!0,value:new Set},inviteClientTransactions:{enumerable:!0,value:new Set},inviteServerTransactions:{enumerable:!0,value:new Set},isConnected:{enumerable:!0,get:function(){return e}},isRegistered:{enumerable:!0,get:function(){return c}},token:{enumerable:!0,get:function(){return b}}});if(!this.stunServers){var p=[];Object.defineProperties(this,
{_stunServers:{set:function(a){p=a}},stunServers:{enumerable:!0,get:function(){return p}}})}if(!this.turnServers){var x=[];Object.defineProperties(this,{_turnServers:{set:function(a){x=a}},turnServers:{enumerable:!0,get:function(){return x}}})}return this}var g=k("events").EventEmitter;n=k("util").inherits;var f=k("./invitetransaction/inviteclienttransaction"),e=k("q");k("../accesstoken");var h=k("../util");k("../util/constants");n(c,g);c.prototype.connect=function(){if(this.isConnected){var b=e.defer();
setTimeout(b.resolve);return b.promise}return this._connect().then(this._onConnectSuccess.bind(this),this._onConnectFailure.bind(this))};c.prototype._connect=function(){var b=e.defer();setTimeout(b.resolve);return b.promise};c.prototype._onConnectSuccess=function(){this.isConnected||this.emit("connected",this);this._isConnected=!0;return this};c.prototype._onConnectFailure=function(b){throw b;};c.prototype.disconnect=function(){if(!this.isConnected){var b=e.defer();setTimeout(b.resolve);return b.promise}return this._disconnect().then(this._onDisconnectSuccess.bind(this),
this._onDisconnectFailure.bind(this))};c.prototype._disconnect=function(){var b=e.defer();setTimeout(b.resolve);return b.promise};c.prototype._onDisconnectSuccess=function(){this.isConnected&&this.emit("disconnected",this);this._isConnected=!1;return this};c.prototype._onDisconnectFailure=function(b){throw b;};c.prototype.register=function(b){b=b||this.token;return this._register(b).then(this._onRegisterSuccess.bind(this,b),this._onRegisterFailure.bind(this))};c.prototype._register=function(b){b=
e.defer();setTimeout(b.resolve);return b.promise};c.prototype._onRegisterSuccess=function(b){this._isRegistered=!0;this._token=b;this.emit("registered",this);return this};c.prototype._onRegisterFailure=function(b){this.emit("registrationFailed",this);throw b;};c.prototype.unregister=function(){return this._unregister().then(this._onUnregisterSuccess.bind(this),this._onUnregisterFailure.bind(this))};c.prototype._unregister=function(){var b=e.defer();setTimeout(b.resolve);return b.promise};c.prototype._onUnregisterSuccess=
function(){this._isRegistered=!1;this.emit("unregistered",this);return this};c.prototype._onUnregisterFailure=function(b){throw b;};c.prototype.invite=function(b,a){a=h.extend({callTimeout:this.callTimeout,stunServers:this.stunServers,turnServers:this.turnServers},a);var c=new this._inviteClientTransactionFactory(this,b,a);this.inviteClientTransactions.add(c);c.then(this._onInviteSuccess.bind(this,c),this._onInviteFailure.bind(this,c));return c};c.prototype._onInviteSuccess=function(b,a){this.inviteClientTransactions.delete(b);
return this._dialogCreated(a)};c.prototype._onInviteFailure=function(b,a){this.inviteClientTransactions.delete(b);throw a;};c.prototype._handleInviteServerTransaction=function(b){this.inviteServerTransactions.add(b);b.then(this._onAcceptSuccess.bind(this,b),this._onAcceptFailure.bind(this,b));setTimeout(this.emit.bind(this,"invite",b))};c.prototype._onAcceptSuccess=function(b,a){this.inviteServerTransactions.delete(b);return this._dialogCreated(a)};c.prototype._dialogCreated=function(b){var a=this;
this.dialogs.add(b);b.once("disconnected",function(c){a.emit("dialogDisconnected",b)});b.once("failed",function(c){a.dialogs.delete(b);a.emit("dialogFailed",b)});b.once("ended",function(){a.dialogs.delete(b);a.emit("dialogEnded",b)});this.emit("dialogCreated",b);return b};c.prototype._onAcceptFailure=function(b,a){this.inviteServerTransactions.delete(b);throw a;};l.exports=c},{"../accesstoken":1,"../util":20,"../util/constants":19,"./invitetransaction/inviteclienttransaction":10,events:30,q:35,util:34}],
17:[function(k,l,n){(function(c){function g(a,b,c){if(!(this instanceof g))return new g(a,b,c);var d=this,h=!1,p=[],k=b.userAgent.token;c=new m("StatsReporter",c||"warn");Object.defineProperties(this,{_log:{value:c},dialog:{enumerable:!0,value:b},eventGateway:{enumerable:!0,value:a},token:{enumerable:!0,value:k}});b.on("stats",function(a){h&&10<=p.length?(a=p.splice(0,p.length),f(d,a)):p.push(a)});b.once("ended",function(){if(h){var a=p.splice(0,p.length);f(d,a)}});e(this).then(function(){h=!0})}
function f(a,b){var c=a._log;return h("https://"+a.eventGateway+"/v1/Calls/"+a.dialog.callSid+"/Statistics",a.token.jwt,{callsid:a.dialog.callSid,samples:b}).then(c.debug.bind(c,"Post to gateway succeeded"),c.debug.bind(c,"Post to gateway failed"))}function e(b){var c=b._log;return h("https://"+b.eventGateway+"/v1/Calls",b.token.jwt,{callsid:b.dialog.callSid,sip:{invite_to_180:b.dialog.inviteTo180},platform:{name:p.name,version:p.version,media_engine:"WebRTC",sdk:a}}).then(c.debug.bind(c,"Initial post to gateway succeeded"),
c.debug.bind(c,"Initial post to gateway failed"))}function h(a,b,c){return d.post({url:a,body:c,headers:{"Content-Type":"application/json","X-Twilio-Token":b}})}var b=k("./util"),a=k("../package.json").version,d=k("./util/request"),m=k("./util/log"),p={name:"Unknown",version:"0.0"};"undefined"!==typeof navigator&&navigator.userAgent?p=b.parseUserAgent(navigator.userAgent):"undefined"!==typeof c&&(p={name:"Node",version:c.version.node});l.exports=g}).call(this,k("_process"))},{"../package.json":72,
"./util":20,"./util/log":21,"./util/request":22,_process:32}],18:[function(k,l,n){function c(f){if(!(this instanceof c))return new c(f);if("function"===typeof f.cancel)return f;var e=g.defer(),h=g.all([f,e.promise]),b=g.defer();Object.defineProperties(this,{_deferred:{value:b}});f.then(function(){e.resolve()});h.then(function(a){b.resolve(a[0])},function(a){b.reject(a)})}var g=k("q");c.prototype.then=function(){var c=this._deferred.promise;return c.then.apply(c,arguments)};c.prototype.catch=function(){var c=
this._deferred.promise;return c.catch.apply(c,arguments)};c.prototype.cancel=function(){return this._deferred.reject(Error("canceled"))};l.exports=c},{q:35}],19:[function(k,l,n){n=k("q");l.exports.REALM=".dev";l.exports.CHUNDER_PORT=10193;l.exports.CLIENT_VERSION=2;l.exports.DEFAULT_LOG_LEVEL="warn";l.exports.EVENT_GATEWAY="eventgw.twilio.com";l.exports.REGISTRAR_SERVER=function(c){return c+".endpoint.twilio.com"};l.exports.WS_SERVER=function(c){return"wss://"+c+".endpoint.twilio.com"};l.exports.DEFAULT_PEER_NAME=
"Anonymous";l.exports.DEFAULT_CALL_TIMEOUT=5E4;l.exports.DEFAULT_ICE_SERVERS=new n([{url:"stun:global.stun.twilio.com:3478?transport=udp"}]);l.exports.headers={X_TWILIO_ACCOUNTSID:"X-Twilio-Accountsid",X_TWILIO_APIVERSION:"X-Twilio-Apiversion",X_TWILIO_CALLSID:"X-Twilio-Callsid",X_TWILIO_CLIENT:"X-Twilio-Client",X_TWILIO_CLIENTVERSION:"X-Twilio-Clientversion",X_TWILIO_PARAMS:"X-Twilio-Params",X_TWILIO_PARTICIPANTS:"X-Twilio-Participants",X_TWILIO_PARTICIPANTSID:"X-Twilio-ParticipantSid",X_TWILIO_TOKEN:"X-Twilio-Token",
X_TWILIO_USERNAME:"X-Twilio-Username",X_TWILIO_PASSWORD:"X-Twilio-Password",X_TWILIO_SESSION:"X-Twilio-Session"};l.exports.SOUNDS={incoming:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/incoming.mp3",outgoing:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/outgoing.mp3",disconnect:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/disconnect.mp3",dtmf0:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-0.mp3",dtmf1:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-1.mp3",
dtmf2:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-2.mp3",dtmf3:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-3.mp3",dtmf4:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-4.mp3",dtmf5:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-5.mp3",dtmf6:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-6.mp3",dtmf7:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-7.mp3",dtmf8:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-8.mp3",
dtmf9:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-9.mp3"};var c=k("./twilioerror");l.exports.twilioErrors=Array.prototype.reduce.call([{name:"GATEWAY_CONNECTION_FAILED",message:"Could not connect to Twilio's servers"},{name:"GATEWAY_DISCONNECTED",message:"Connection to Twilio's servers was lost"},{name:"INVALID_ARGUMENT",message:"One or more arguments passed were invalid"},{name:"INVALID_TOKEN",message:"The token is invalid or malformed"},{name:"LISTEN_FAILED",message:"Failed to listen with the supplied token"},
{name:"TOKEN_EXPIRED",message:"Endpoint's active token has expired"},{name:"CONVERSATION_CREATE_FAILED",message:"Failed to create Conversation"},{name:"CONVERSATION_INVITE_FAILED",message:"Failed to add Participant to Conversation"},{name:"CONVERSATION_JOIN_FAILED",message:"Failed to join Conversation"},{name:"SDP_NEGOTIATION_FAILED",message:"Failed to negotiate media with Participant(s)"},{name:"ICE_CONNECT_FAILED",message:"Could not find match for all candidates"},{name:"ICE_DISCONNECTED",message:"Liveliness check has failed; may be recoverable"},
{name:"MEDIA_ACCESS_DENIED",message:"Could not get access to microphone or camera"}],function(g,f){g[f.name]=new c(f);return g},{})},{"./twilioerror":23,q:35}],20:[function(k,l,n){(function(c,g){function f(a){return 0===a.length?[[]]:[a].concat(f(a.slice(1)))}function e(a){var b=[],c=[];a&&a.forEach(function(a){if(a.url){var e=a.url.split(":")[0];"stun"===e||"stuns"===e?b.push(a):"turn"!==e&&"turns"!==e||c.push(a)}});b=b.map(function(a){return a.url.split("?")[0]});c=c.map(function(a){return{urls:[a.url.split("?")[0]],
username:a.username,password:a.credential}});return{stunServers:b,turnServers:c}}k("util");var h=k("./cancelablepromise"),b=k("./constants"),a=b.twilioErrors,d=b.headers,m=k("q"),p=k("./request"),x="function"===typeof atob?atob:function(a){return(new g(a,"base64")).toString("ascii")},y="function"===typeof btoa?btoa:function(a){return(new g(a)).toString("base64")},n={decode:x,encode:y},v={decode:function(a){var b={};return function(){var c=Array.prototype.slice.call(arguments,0);return b[c]?b[c]:b[c]=
a.apply(null,c)}}(function(a){var b=a.length%4;0<b&&(a+=Array(4-b+1).join("="));a=a.replace(/-/g,"+").replace(/_/g,"/");return x(a)})},C=new Map;l.exports.base64=n;l.exports.base64URL=v;l.exports.deepClone=function(a){return JSON.parse(JSON.stringify(a))};l.exports.fromURLFormEncoded=function(a){if(!a)return{};var b={};a=a.split("&");for(var c=0;c<a.length;c++){var e=a[c].split("="),d=decodeURIComponent(e[0]),e=e[1]?decodeURIComponent(e[1]):null;b[d]=e}return b};l.exports.makeRegisterHeaders=function(a){var e=
"undefined"===typeof navigator?{}:navigator;return[d.X_TWILIO_TOKEN+": "+a.jwt,d.X_TWILIO_CLIENT+": "+JSON.stringify({p:"browser",v:c.env.SDK_VERSION||"unknown",browser:{userAgent:e.userAgent||"unknown",platform:e.platform||"unknown"},plugin:"rtc"}),d.X_TWILIO_CLIENTVERSION+": "+b.CLIENT_VERSION]};l.exports.makeTarget=function(a){return"sip:"+a+"@"+b.CHUNDER_HOST};l.exports.makeURI=function(a,c){return encodeURIComponent(c||b.DEFAULT_PEER_NAME)+"@"+a+".chunder.twilio.com"};l.exports.toURLFormEncoded=
function(a){var b="",c;for(c in a)b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c]);return b};l.exports.requireNoBrowserify=function(a){return eval("require('"+a+"')")};l.exports.getKeys=function(a){var b=[],c;for(c in a)b.push(c);return b};l.exports.getValues=function(a){var b=[],c;for(c in a)b.push(a[c]);return b};l.exports.makeUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};l.exports.race=
function(a){function b(a){d&&(d=!1,e.resolve(a))}function c(a){d&&(d=!1,e.reject(a))}var e=m.defer(),d=!0;a.forEach(function(a){a.done(b,c)});return e.promise};l.exports.any=function(a){function b(a){d&&(d=!1,e.resolve(a))}function c(b){f.push(b);f.length===a.length&&e.reject(b)}a=a.map(h);var e=m.defer();e.promise=new h(e.promise);var d=!0,f=[];a.forEach(function(a){a.then(b,c)});var p=e.promise.cancel.bind(e.promise);Object.defineProperties(e.promise,{cancel:{value:function(){d&&(d=!1,a.forEach(function(a){a.cancel()}),
p())}}});return e.promise};l.exports.withDefaults=function(a,b){a=a||{};b=Array.prototype.slice.call(arguments,1);b.forEach(function(b){var c=a,e;for(e in b)e in c||(c[e]=b[e])});return a};l.exports.extend=function(a,b){a=a||{};b=Array.prototype.slice.call(arguments,1);b.forEach(function(b){var c=a,e;for(e in b)c[e]=b[e]});return a};l.exports.tails=f;l.exports.sessionRegistry=C;l.exports.return=function(a){return function(){return a}};l.exports.separateIceServers=e;l.exports.getStunServers=function(a){return e(a).stunServers};
l.exports.getTurnServers=function(a){return e(a).turnServers};l.exports.promiseFromEvents=function(a,b,c,e){function d(){var a=[].slice.call(arguments);e&&b.removeListener(e,f);h.resolve.apply(null,a)}function f(){var a=[].slice.call(arguments);b.removeListener(c,d);h.reject.apply(null,a)}var h=m.defer();b.once(c,d);if(e)b.once(e,f);a();return h.promise};l.exports.parseConversationSIDFromContactHeader=function(a){return(a=a.match(/<sip:(.*)@(.*)$/))?a[1]:null};l.exports.emitNext=function(){var a=
[].slice.call(arguments),b=a[0],a=a.slice(1);setTimeout(function(){b.emit.call(b,a)});return b};l.exports.getOrNull=function(a,b){return b.split(".").reduce(function(a,b){return a?a[b]:null},a)};l.exports.isValidIceServerArray=function(a){return"undefined"===typeof a.forEach?!1:a.reduce(function(a,b){return a&&"undefined"!==typeof b.url},!0)};l.exports.parseUserAgent=function(a){var b=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)\.(\d+)/i)||[],b={name:b[1],version:b[2]+"."+
b[3]};if(/trident/i.test(b.name))return a=/\brv[ :]+(\d+)\.(\d+)/g.exec(a)||[],{name:"IE",version:a[1]?a[1]+"."+a[2]:""};if("Chrome"===b.name&&(a=a.match(/\b(OPR|Edge)\/(\d+)\.(\d+)/),null!==a))return{name:"Opera",version:a[2]+"."+a[3]};"MSIE"===b.name&&(b.name="IE");return b};l.exports.fetchIceServers=function(c,e,d){c={url:"https://"+(d||"api.twilio.com")+"/2010-04-01/Accounts/"+c.accountSid+"/Tokens.json",headers:{Authorization:"Basic "+y("Token:"+c.jwt)}};return p.post(c).then(function(a){return JSON.parse(a).ice_servers},
function(c){e&&e.warn(a.ICE_FETCH_FAILED,"Failed to fetch ephemeral TURN server credential",c);return b.DEFAULT_ICE_SERVERS})};l.exports.overwriteArray=function(a,b){a.splice(0,a.length);b.forEach(function(b){a.push(b)})}}).call(this,k("_process"),k("buffer").Buffer)},{"./cancelablepromise":18,"./constants":19,"./request":22,_process:32,buffer:26,q:35,util:34}],21:[function(k,l,n){function c(f,e){if(!(this instanceof c))return new c(f);e=e?c.getLevelByName(e):c.INFO;Object.defineProperties(this,{logLevel:{value:e},
name:{value:f}})}k("./");k("./twilioerror");var g=k("./constants").twilioErrors;Object.defineProperties(c,{DEBUG:{value:0},INFO:{value:1},WARN:{value:2},ERROR:{value:3},OFF:{value:4},_levels:{value:[{name:"DEBUG",logFn:console.log},{name:"INFO",logFn:console.info},{name:"WARN",logFn:console.warn},{name:"ERROR",logFn:console.error},{name:"OFF",logFn:function(){}}]}});c.getLevelByName=function(f){if(!isNaN(f))return parseInt(f,10);f=f.toUpperCase();if(-1===["OFF","ERROR","WARN","INFO","DEBUG"].indexOf(f))throw g.INVALID_ARGUMENT.clone('Log level must be one of: ["off", "error", "warn", "info", "debug"]');
return c[f]};c.prototype.log=function(f,e){this.logLevel<=f&&c._levels[f].logFn.apply(console,[this.name,c._levels[f].name].concat(e));return this};c.prototype.debug=function(){return this.log.call(this,c.DEBUG,[].slice.call(arguments))};c.prototype.info=function(){return this.log.call(this,c.INFO,[].slice.call(arguments))};c.prototype.warn=function(){return this.log.call(this,c.WARN,[].slice.call(arguments))};c.prototype.error=function(){return this.log.call(this,c.ERROR,[].slice.call(arguments))};
c.prototype.throw=function(f,e){f.clone&&(f=f.clone(e));this.log.call(this,c.ERROR,f);throw f;};l.exports=c},{"./":20,"./constants":19,"./twilioerror":23}],22:[function(k,l,n){function c(c,h){var b=g.defer(),a=new f;a.open(c,h.url,!0);a.onreadystatechange=function(){4===a.readyState&&(200<=a.status&&300>a.status?b.resolve(a.responseText):b.reject(a.responseText))};for(var d in h.headers)a.setRequestHeader(d,h.headers[d]);a.send(JSON.stringify(h.body));return b.promise}var g=k("q"),f="undefined"===
typeof XMLHttpRequest?k("xmlhttprequest").XMLHttpRequest:XMLHttpRequest;c.get=function(e){return c("GET",e)};c.post=function(e){return c("POST",e)};l.exports=c},{q:35,xmlhttprequest:71}],23:[function(k,l,n){function c(c,f){Object.defineProperties(this,{_errorData:{value:c},name:{value:c.name},message:{value:f||c.message}})}k=k("util").inherits;k(c,Error);c.prototype.toString=function(){return[this.name,this.message].join(" | ")};c.prototype.clone=function(g){return new c(this._errorData,g)};l.exports=
c},{util:34}],24:[function(k,l,n){function c(a,b){var c=[],d=null,f=[],h=null;a.result().forEach(function(a){var b=null;switch(a.type){case "googCandidatePair":a:{for(var b={},p={},x=a.names(),k=a.timestamp?Math.floor(a.timestamp/1E3):null,E=0;E<x.length;E++){var l=x[E],z=a.stat(l);switch(l){case "googActiveConnection":if("true"!==z){b=null;break a}break;case "googChannelId":b.connection=z;break;case "googLocalAddress":z.split&&(l=z.split(":"),m(b,"local","address",l[0]),m(b,"local","port",Number(l[1])));
break;case "googLocalCandidateType":m(b,"local","type",z);break;case "googRemoteAddress":z.split&&(l=z.split(":"),m(b,"remote","address",l[0]),m(b,"remote","port",Number(l[1])));break;case "googRemoteCandidateType":m(b,"remote","type",z);break;case "googRtt":b.rtt=Number(z);break;case "":break;default:p[l]=z}}b.timestamp=k;b=e(b,p)}b&&(d=d||b.known);break;case "ssrc":b=g(a);c.push(b.known);break;default:f.push(a)}b&&b.known&&"timestamp"in b.known&&(h=h||b.known.timestamp,delete b.known.timestamp)});
b(null,{timestamp:h,tracks:c,transport:d})}function g(a){var b={},c={},d=a.names(),f=null,h=null,g=a.timestamp?Math.floor(a.timestamp/1E3):null;d.forEach(function(e){var d=a.stat(e);switch(e){case "audioInputLevel":h="audio";m(b,"audio","inlvl",Number(d));break;case "audioOutputLevel":h="audio";m(b,"audio","outlvl",Number(d));break;case "bytesReceived":f="receiving";m(b,"bytes","recv",Number(d));break;case "bytesSent":f="sending";m(b,"bytes","sent",Number(d));break;case "googCodecName":""!==d&&(b.codecName=
d);break;case "googFrameHeightReceived":f="receiving";h="video";m(b,"video","height_recv",Number(d));break;case "googFrameHeightSent":f="sending";h="video";m(b,"video","height_sent",Number(d));break;case "googFrameWidthReceived":f="receiving";h="video";m(b,"video","width_recv",Number(d));break;case "googFrameWidthSent":f="sending";h="video";m(b,"video","width_sent",Number(d));break;case "googFrameRateDecoded":f="receiving";h="video";m(b,"video","fps_recv",Number(d));break;case "googFrameRateSent":f=
"sending";h="video";m(b,"video","fps_sent",Number(d));break;case "googJitterBufferMs":b.googJitterBufferMs=Number(d);break;case "googJitterReceived":e=Number(d);-1!==e&&(b.jitter=e);break;case "googRtt":e=Number(d);-1!==e&&(b.rtt=e);break;case "packetsLost":f="sending";-1!==Number(d)&&m(b,"packets","lost",Number(d));break;case "packetsReceived":f="receiving";m(b,"packets","recv",Number(d));break;case "packetsSent":f="sending";m(b,"packets","sent",Number(d));break;case "ssrc":b[e]=d;break;case "transportId":b.connection=
d;break;default:c[e]=d}});f&&(b.direction=f);h&&(b.media=h);b.timestamp=g;return e(b,c)}function f(a,b){var c=[],f=[],m=null,g={},k={},l;a.forEach(function(a){var b=null;switch(a.type){case "inboundrtp":var d={direction:"receiving"},b={},h;for(h in a){var p=a[h];switch(h){case "mozRtt":d.rtt=p;break;case "timestamp":d[h]=Math.floor(p/1E3);break;case "jitter":d[h]=1E3*p;break;case "framerateMean":d.fps=Math.round(p);break;case "mediaType":d.media=p;break;case "bytesReceived":case "packetsLost":case "packetsReceived":case "ssrc":d[h]=
p;break;default:b[h]=p}}b=e(d,b);break;case "outboundrtp":if(!1===a.isRemote){h={direction:"sending"};b={};for(d in a)switch(p=a[d],d){case "timestamp":h[d]=Math.floor(p/1E3);break;case "mediaType":h.media=p;break;case "bytesSent":case "packetsSent":case "ssrc":h[d]=p;break;default:b[d]=p}b=e(h,b)}break;case "candidatepair":h=l&&l.componentId;!a.selected||h&&-1!==h.indexOf("video")||(l=a);break;case "localcandidate":g[a.id]=a;break;case "remotecandidate":k[a.id]=a;break;default:f.push(a)}b&&(m=m||
b.known.timestamp,delete b.known.timestamp,c.push(b))});if(0===c.length||0===(c=h(c)).length)return b(null,{timestamp:m,ssrcs:[]});var n=g[l.localCandidateId],u=k[l.remoteCandidateId],n={local:{address:n.ipAddress,port:n.portNumber,type:"host"===n.candidateType?"local":n.candidateType},remote:{address:u.ipAddress,port:u.portNumber,type:"host"===u.candidateType?"local":u.candidateType}},n={timestamp:m,tracks:c.map(d),transport:n};b(null,n)}function e(a,c){var d=null;b(a)||(d=d||{},d.known=a);b(c)||
(d=d||{},d.unknown=c);return d}function h(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];d.known&&b.push(d.known)}return b}function b(a){if(!a)return!0;for(var b in a)return!1;return!0}function a(a,b){return function(){var c=Array.prototype.slice.call(arguments);c.push(b);return a.apply(null,c)}}function d(a){var b={ssrc:a.ssrc,media:a.media,direction:a.direction,codecName:a.codecName,packets:{lost:a.packetsLost,recvtot:a.packetsReceived,senttot:a.packetsSent},bytes:{recvtot:a.bytesReceived,senttot:a.bytesSent},
jitter:a.jitter,rtt:a.rtt};if("audioInputLevel"in a||"audioOutputLevel"in a)b.audio={inlvl:a.audioInputLevel,outlvl:a.audioOutputLevel};if("fps"in a||"width"in a||"height"in a)b.video={fps:a.fps,width:a.width,height:a.height};return b}function m(){var a=[].slice.call(arguments,0),b=a[0],c=a.slice(1,a.length-1),d=a[a.length-1],e=b;c.forEach(function(a,b){var f=b==c.length-1?d:{};e=e[a]=e[a]||f});return b}l.exports=function(b,d){var e=Error("WebRTC statistics are unsupported");null===b||"undefined"===
typeof navigator||"function"!==typeof b.getStats?d(e):navigator.webkitGetUserMedia?b.getStats(a(c,d),d):navigator.mozGetUserMedia?b.getStats(null,a(f,d),d):d(e)}},{}],25:[function(k,l,n){var c=k("q");l.exports=function(g){var f=c.defer();g=g||{audio:!0,video:!0};var e=f.resolve.bind(f),h=f.reject.bind(f);"undefined"!==typeof window&&"undefined"!==typeof navigator?"function"===typeof navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(g,e,h):"function"===typeof navigator.mozGetUserMedia&&navigator.mozGetUserMedia(g,
e,h):h(Error("getUserMedia is not supported"));return f.promise}},{q:35}],26:[function(k,l,n){function c(a){if(!(this instanceof c))return 1<arguments.length?new c(a,arguments[1]):new c(a);this.length=0;this.parent=void 0;if("number"===typeof a){var d;d=f(this,0>a?0:e(a)|0);if(!c.TYPED_ARRAY_SUPPORT)for(var h=0;h<a;h++)d[h]=0;return d}if("string"===typeof a){d=this;h=1<arguments.length?arguments[1]:"utf8";if("string"!==typeof h||""===h)h="utf8";var m=b(a,h)|0;d=f(d,m);d.write(a,h);return d}return g(this,
a)}function g(a,b){if(c.isBuffer(b)){var d=a,h=e(b.length)|0,d=f(d,h);b.copy(d,0,0,h);return d}if(E(b)){for(var d=a,h=e(b.length)|0,d=f(d,h),m=0;m<h;m+=1)d[m]=b[m]&255;return d}if(null==b)throw new TypeError("must start with number, buffer, array or string");if("undefined"!==typeof ArrayBuffer&&b.buffer instanceof ArrayBuffer){d=a;h=e(b.length)|0;d=f(d,h);for(m=0;m<h;m+=1)d[m]=b[m]&255;return d}if(b.length){d=a;h=e(b.length)|0;d=f(d,h);for(m=0;m<h;m+=1)d[m]=b[m]&255;return d}d=a;m=0;"Buffer"===b.type&&
E(b.data)&&(h=b.data,m=e(h.length)|0);for(var d=f(d,m),g=0;g<m;g+=1)d[g]=h[g]&255;return d}function f(a,b){c.TYPED_ARRAY_SUPPORT?a=c._augment(new Uint8Array(b)):(a.length=b,a._isBuffer=!0);0!==b&&b<=c.poolSize>>>1&&(a.parent=z);return a}function e(a){if(a>=H)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+H.toString(16)+" bytes");return a|0}function h(a,b){if(!(this instanceof h))return new h(a,b);var d=new c(a,b);delete d.parent;return d}function b(a,b){"string"!==
typeof a&&(a=String(a));if(0===a.length)return 0;switch(b||"utf8"){case "ascii":case "binary":case "raw":return a.length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*a.length;case "hex":return a.length>>>1;case "utf8":case "utf-8":return C(a).length;case "base64":return u.toByteArray(v(a)).length;default:return a.length}}function a(a,b,c){if(0!==a%1||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length");}function d(a,
b,d,e,f,h){if(!c.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>f||b<h)throw new RangeError("value is out of bounds");if(d+e>a.length)throw new RangeError("index out of range");}function m(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);e<f;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function p(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);e<f;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function x(a,b,c,d,e,f){if(b>e||b<f)throw new RangeError("value is out of bounds");
if(c+d>a.length)throw new RangeError("index out of range");if(0>c)throw new RangeError("index out of range");}function y(a,b,c,d,e){e||x(a,b,c,4,3.4028234663852886E38,-3.4028234663852886E38);F.write(a,b,c,d,23,4);return c+4}function A(a,b,c,d,e){e||x(a,b,c,8,1.7976931348623157E308,-1.7976931348623157E308);F.write(a,b,c,d,52,8);return c+8}function v(a){a=a.trim?a.trim():a.replace(/^\s+|\s+$/g,"");a=a.replace(I,"");if(2>a.length)return"";for(;0!==a.length%4;)a+="=";return a}function C(a,b){b=b||Infinity;
for(var c,d=a.length,e=null,f=[],h=0;h<d;h++){c=a.charCodeAt(h);if(55295<c&&57344>c)if(e)if(56320>c){-1<(b-=3)&&f.push(239,191,189);e=c;continue}else c=e-55296<<10|c-56320|65536,e=null;else{56319<c?-1<(b-=3)&&f.push(239,191,189):h+1===d?-1<(b-=3)&&f.push(239,191,189):e=c;continue}else e&&(-1<(b-=3)&&f.push(239,191,189),e=null);if(128>c){if(0>--b)break;f.push(c)}else if(2048>c){if(0>(b-=2))break;f.push(c>>6|192,c&63|128)}else if(65536>c){if(0>(b-=3))break;f.push(c>>12|224,c>>6&63|128,c&63|128)}else if(2097152>
c){if(0>(b-=4))break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw Error("Invalid code point");}return f}function q(a){for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b}function r(a,b,c,d){for(var e=0;e<d&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function t(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}var u=k("base64-js"),F=k("ieee754"),E=k("is-array");n.Buffer=c;n.SlowBuffer=h;n.INSPECT_MAX_BYTES=50;c.poolSize=8192;
var H=1073741823,z={};c.TYPED_ARRAY_SUPPORT=function(){try{var a=new ArrayBuffer(0),b=new Uint8Array(a);b.foo=function(){return 42};return 42===b.foo()&&"function"===typeof b.subarray&&0===(new Uint8Array(1)).subarray(1,1).byteLength}catch(c){return!1}}();c.isBuffer=function(a){return!(null==a||!a._isBuffer)};c.compare=function(a,b){if(!c.isBuffer(a)||!c.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var d=a.length,e=b.length,f=0,h=Math.min(d,e);f<h&&a[f]===b[f];)++f;
f!==h&&(d=a[f],e=b[f]);return d<e?-1:e<d?1:0};c.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "binary":case "base64":case "raw":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};c.concat=function(a,b){if(!E(a))throw new TypeError("list argument must be an Array of Buffers.");if(0===a.length)return new c(0);if(1===a.length)return a[0];var d;if(void 0===b)for(d=b=0;d<a.length;d++)b+=a[d].length;var e=new c(b),
f=0;for(d=0;d<a.length;d++){var h=a[d];h.copy(e,f);f+=h.length}return e};c.byteLength=b;c.prototype.length=void 0;c.prototype.parent=void 0;c.prototype.toString=function(a,b,c){var d=!1;b|=0;c=void 0===c||Infinity===c?this.length:c|0;a||(a="utf8");0>b&&(b=0);c>this.length&&(c=this.length);if(c<=b)return"";for(;;)switch(a){case "hex":a=b;b=this.length;if(!a||0>a)a=0;if(!c||0>c||c>b)c=b;for(b="";a<c;a++)d=this[a],d=16>d?"0"+d.toString(16):d.toString(16),b+=d;return b;case "utf8":case "utf-8":a=b;d=
b="";for(c=Math.min(this.length,c);a<c;a++)127>=this[a]?(b+=t(d)+String.fromCharCode(this[a]),d=""):d+="%"+this[a].toString(16);return b+t(d);case "ascii":a=b;b="";for(c=Math.min(this.length,c);a<c;a++)b+=String.fromCharCode(this[a]&127);return b;case "binary":a=b;b="";for(c=Math.min(this.length,c);a<c;a++)b+=String.fromCharCode(this[a]);return b;case "base64":return a=b,c=0===a&&c===this.length?u.fromByteArray(this):u.fromByteArray(this.slice(a,c)),c;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=
this.slice(b,c);a="";for(b=0;b<c.length;b+=2)a+=String.fromCharCode(c[b]+256*c[b+1]);return a;default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();d=!0}};c.prototype.equals=function(a){if(!c.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===c.compare(this,a)};c.prototype.inspect=function(){var a="",b=n.INSPECT_MAX_BYTES;0<this.length&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... "));return"<Buffer "+a+">"};
c.prototype.compare=function(a){if(!c.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?0:c.compare(this,a)};c.prototype.indexOf=function(a,b){function d(a,b,c){for(var e=-1,f=0;c+f<a.length;f++)if(a[c+f]===b[-1===e?0:f-e]){if(-1===e&&(e=f),f-e+1===b.length)return c+e}else e=-1;return-1}2147483647<b?b=2147483647:-2147483648>b&&(b=-2147483648);b>>=0;if(0===this.length||b>=this.length)return-1;0>b&&(b=Math.max(this.length+b,0));if("string"===typeof a)return 0===a.length?-1:
String.prototype.indexOf.call(this,a,b);if(c.isBuffer(a))return d(this,a,b);if("number"===typeof a)return c.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):d(this,[a],b);throw new TypeError("val must be string, number or Buffer");};c.prototype.get=function(a){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(a)};c.prototype.set=function(a,b){console.log(".set() is deprecated. Access using array indexes instead.");
return this.writeUInt8(a,b)};c.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"===typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b|=0,isFinite(c)?(c|=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b;b=c|0;c=e}e=this.length-b;if(void 0===c||c>e)c=e;if(0<a.length&&(0>c||0>b)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(e=!1;;)switch(d){case "hex":b=Number(b)||0;d=this.length-b;c?(c=
Number(c),c>d&&(c=d)):c=d;d=a.length;if(0!==d%2)throw Error("Invalid hex string");c>d/2&&(c=d/2);for(d=0;d<c;d++){e=parseInt(a.substr(2*d,2),16);if(isNaN(e))throw Error("Invalid hex string");this[b+d]=e}return d;case "utf8":case "utf-8":return r(C(a,this.length-b),this,b,c);case "ascii":return r(q(a),this,b,c);case "binary":return r(q(a),this,b,c);case "base64":return r(u.toByteArray(v(a)),this,b,c);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":d=this.length-b;for(var f=void 0,f=e=void 0,
h=[],m=0;m<a.length&&!(0>(d-=2));m++)f=a.charCodeAt(m),e=f>>8,f%=256,h.push(f),h.push(e);return r(h,this,b,c);default:if(e)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();e=!0}};c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};c.prototype.slice=function(a,b){var d=this.length;a=~~a;b=void 0===b?d:~~b;0>a?(a+=d,0>a&&(a=0)):a>d&&(a=d);0>b?(b+=d,0>b&&(b=0)):b>d&&(b=d);b<a&&(b=a);if(c.TYPED_ARRAY_SUPPORT)d=c._augment(this.subarray(a,
b));else for(var e=b-a,d=new c(e,void 0),f=0;f<e;f++)d[f]=this[f+a];d.length&&(d.parent=this.parent||this);return d};c.prototype.readUIntLE=function(b,c,d){b|=0;c|=0;d||a(b,c,this.length);d=this[b];for(var e=1,f=0;++f<c&&(e*=256);)d+=this[b+f]*e;return d};c.prototype.readUIntBE=function(b,c,d){b|=0;c|=0;d||a(b,c,this.length);d=this[b+--c];for(var e=1;0<c&&(e*=256);)d+=this[b+--c]*e;return d};c.prototype.readUInt8=function(b,c){c||a(b,1,this.length);return this[b]};c.prototype.readUInt16LE=function(b,
c){c||a(b,2,this.length);return this[b]|this[b+1]<<8};c.prototype.readUInt16BE=function(b,c){c||a(b,2,this.length);return this[b]<<8|this[b+1]};c.prototype.readUInt32LE=function(b,c){c||a(b,4,this.length);return(this[b]|this[b+1]<<8|this[b+2]<<16)+16777216*this[b+3]};c.prototype.readUInt32BE=function(b,c){c||a(b,4,this.length);return 16777216*this[b]+(this[b+1]<<16|this[b+2]<<8|this[b+3])};c.prototype.readIntLE=function(b,c,d){b|=0;c|=0;d||a(b,c,this.length);d=this[b];for(var e=1,f=0;++f<c&&(e*=256);)d+=
this[b+f]*e;d>=128*e&&(d-=Math.pow(2,8*c));return d};c.prototype.readIntBE=function(b,c,d){b|=0;c|=0;d||a(b,c,this.length);d=c;for(var e=1,f=this[b+--d];0<d&&(e*=256);)f+=this[b+--d]*e;f>=128*e&&(f-=Math.pow(2,8*c));return f};c.prototype.readInt8=function(b,c){c||a(b,1,this.length);return this[b]&128?-1*(255-this[b]+1):this[b]};c.prototype.readInt16LE=function(b,c){c||a(b,2,this.length);var d=this[b]|this[b+1]<<8;return d&32768?d|4294901760:d};c.prototype.readInt16BE=function(b,c){c||a(b,2,this.length);
var d=this[b+1]|this[b]<<8;return d&32768?d|4294901760:d};c.prototype.readInt32LE=function(b,c){c||a(b,4,this.length);return this[b]|this[b+1]<<8|this[b+2]<<16|this[b+3]<<24};c.prototype.readInt32BE=function(b,c){c||a(b,4,this.length);return this[b]<<24|this[b+1]<<16|this[b+2]<<8|this[b+3]};c.prototype.readFloatLE=function(b,c){c||a(b,4,this.length);return F.read(this,b,!0,23,4)};c.prototype.readFloatBE=function(b,c){c||a(b,4,this.length);return F.read(this,b,!1,23,4)};c.prototype.readDoubleLE=function(b,
c){c||a(b,8,this.length);return F.read(this,b,!0,52,8)};c.prototype.readDoubleBE=function(b,c){c||a(b,8,this.length);return F.read(this,b,!1,52,8)};c.prototype.writeUIntLE=function(a,b,c,e){a=+a;b|=0;c|=0;e||d(this,a,b,c,Math.pow(2,8*c),0);e=1;var f=0;for(this[b]=a&255;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c};c.prototype.writeUIntBE=function(a,b,c,e){a=+a;b|=0;c|=0;e||d(this,a,b,c,Math.pow(2,8*c),0);e=c-1;var f=1;for(this[b+e]=a&255;0<=--e&&(f*=256);)this[b+e]=a/f&255;return b+c};c.prototype.writeUInt8=
function(a,b,e){a=+a;b|=0;e||d(this,a,b,1,255,0);c.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));this[b]=a;return b+1};c.prototype.writeUInt16LE=function(a,b,e){a=+a;b|=0;e||d(this,a,b,2,65535,0);c.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):m(this,a,b,!0);return b+2};c.prototype.writeUInt16BE=function(a,b,e){a=+a;b|=0;e||d(this,a,b,2,65535,0);c.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):m(this,a,b,!1);return b+2};c.prototype.writeUInt32LE=function(a,b,e){a=+a;b|=0;e||d(this,a,b,4,4294967295,0);
c.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=a):p(this,a,b,!0);return b+4};c.prototype.writeUInt32BE=function(a,b,e){a=+a;b|=0;e||d(this,a,b,4,4294967295,0);c.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):p(this,a,b,!1);return b+4};c.prototype.writeIntLE=function(a,b,c,e){a=+a;b|=0;e||(e=Math.pow(2,8*c-1),d(this,a,b,c,e-1,-e));e=0;var f=1,h=0>a?1:0;for(this[b]=a&255;++e<c&&(f*=256);)this[b+e]=(a/f>>0)-h&255;return b+c};c.prototype.writeIntBE=
function(a,b,c,e){a=+a;b|=0;e||(e=Math.pow(2,8*c-1),d(this,a,b,c,e-1,-e));e=c-1;var f=1,h=0>a?1:0;for(this[b+e]=a&255;0<=--e&&(f*=256);)this[b+e]=(a/f>>0)-h&255;return b+c};c.prototype.writeInt8=function(a,b,e){a=+a;b|=0;e||d(this,a,b,1,127,-128);c.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));0>a&&(a=255+a+1);this[b]=a;return b+1};c.prototype.writeInt16LE=function(a,b,e){a=+a;b|=0;e||d(this,a,b,2,32767,-32768);c.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):m(this,a,b,!0);return b+2};c.prototype.writeInt16BE=
function(a,b,e){a=+a;b|=0;e||d(this,a,b,2,32767,-32768);c.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):m(this,a,b,!1);return b+2};c.prototype.writeInt32LE=function(a,b,e){a=+a;b|=0;e||d(this,a,b,4,2147483647,-2147483648);c.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):p(this,a,b,!0);return b+4};c.prototype.writeInt32BE=function(a,b,e){a=+a;b|=0;e||d(this,a,b,4,2147483647,-2147483648);0>a&&(a=4294967295+a+1);c.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>
16,this[b+2]=a>>>8,this[b+3]=a):p(this,a,b,!1);return b+4};c.prototype.writeFloatLE=function(a,b,c){return y(this,a,b,!0,c)};c.prototype.writeFloatBE=function(a,b,c){return y(this,a,b,!1,c)};c.prototype.writeDoubleLE=function(a,b,c){return A(this,a,b,!0,c)};c.prototype.writeDoubleBE=function(a,b,c){return A(this,a,b,!1,c)};c.prototype.copy=function(a,b,d,e){d||(d=0);e||0===e||(e=this.length);b>=a.length&&(b=a.length);b||(b=0);0<e&&e<d&&(e=d);if(e===d||0===a.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");
if(0>d||d>=this.length)throw new RangeError("sourceStart out of bounds");if(0>e)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length);a.length-b<e-d&&(e=a.length-b+d);e-=d;if(1E3>e||!c.TYPED_ARRAY_SUPPORT)for(var f=0;f<e;f++)a[f+b]=this[f+d];else a._set(this.subarray(d,d+e),b);return e};c.prototype.fill=function(a,b,c){a||(a=0);b||(b=0);c||(c=this.length);if(c<b)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new RangeError("start out of bounds");
if(0>c||c>this.length)throw new RangeError("end out of bounds");if("number"===typeof a)for(;b<c;b++)this[b]=a;else{a=C(a.toString());for(var d=a.length;b<c;b++)this[b]=a[b%d]}return this}};c.prototype.toArrayBuffer=function(){if("undefined"!==typeof Uint8Array){if(c.TYPED_ARRAY_SUPPORT)return(new c(this)).buffer;for(var a=new Uint8Array(this.length),b=0,d=a.length;b<d;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser");};var w=c.prototype;c._augment=
function(a){a.constructor=c;a._isBuffer=!0;a._set=a.set;a.get=w.get;a.set=w.set;a.write=w.write;a.toString=w.toString;a.toLocaleString=w.toString;a.toJSON=w.toJSON;a.equals=w.equals;a.compare=w.compare;a.indexOf=w.indexOf;a.copy=w.copy;a.slice=w.slice;a.readUIntLE=w.readUIntLE;a.readUIntBE=w.readUIntBE;a.readUInt8=w.readUInt8;a.readUInt16LE=w.readUInt16LE;a.readUInt16BE=w.readUInt16BE;a.readUInt32LE=w.readUInt32LE;a.readUInt32BE=w.readUInt32BE;a.readIntLE=w.readIntLE;a.readIntBE=w.readIntBE;a.readInt8=
w.readInt8;a.readInt16LE=w.readInt16LE;a.readInt16BE=w.readInt16BE;a.readInt32LE=w.readInt32LE;a.readInt32BE=w.readInt32BE;a.readFloatLE=w.readFloatLE;a.readFloatBE=w.readFloatBE;a.readDoubleLE=w.readDoubleLE;a.readDoubleBE=w.readDoubleBE;a.writeUInt8=w.writeUInt8;a.writeUIntLE=w.writeUIntLE;a.writeUIntBE=w.writeUIntBE;a.writeUInt16LE=w.writeUInt16LE;a.writeUInt16BE=w.writeUInt16BE;a.writeUInt32LE=w.writeUInt32LE;a.writeUInt32BE=w.writeUInt32BE;a.writeIntLE=w.writeIntLE;a.writeIntBE=w.writeIntBE;
a.writeInt8=w.writeInt8;a.writeInt16LE=w.writeInt16LE;a.writeInt16BE=w.writeInt16BE;a.writeInt32LE=w.writeInt32LE;a.writeInt32BE=w.writeInt32BE;a.writeFloatLE=w.writeFloatLE;a.writeFloatBE=w.writeFloatBE;a.writeDoubleLE=w.writeDoubleLE;a.writeDoubleBE=w.writeDoubleBE;a.fill=w.fill;a.inspect=w.inspect;a.toArrayBuffer=w.toArrayBuffer;return a};var I=/[^+\/0-9A-z\-]/g},{"base64-js":27,ieee754:28,"is-array":29}],27:[function(k,l,n){(function(c){function g(c){c=c.charCodeAt(0);if(43===c||45===c)return 62;
if(47===c||95===c)return 63;if(48>c)return-1;if(58>c)return c-48+52;if(91>c)return c-65;if(123>c)return c-97+26}var f="undefined"!==typeof Uint8Array?Uint8Array:Array;c.toByteArray=function(c){function h(a){p[k++]=a}var b,a,d,m,p;if(0<c.length%4)throw Error("Invalid string. Length must be a multiple of 4");b=c.length;m="="===c.charAt(b-2)?2:"="===c.charAt(b-1)?1:0;p=new f(3*c.length/4-m);a=0<m?c.length-4:c.length;var k=0;for(b=0;b<a;b+=4)d=g(c.charAt(b))<<18|g(c.charAt(b+1))<<12|g(c.charAt(b+2))<<
6|g(c.charAt(b+3)),h((d&16711680)>>16),h((d&65280)>>8),h(d&255);2===m?(d=g(c.charAt(b))<<2|g(c.charAt(b+1))>>4,h(d&255)):1===m&&(d=g(c.charAt(b))<<10|g(c.charAt(b+1))<<4|g(c.charAt(b+2))>>2,h(d>>8&255),h(d&255));return p};c.fromByteArray=function(c){var f,b=c.length%3,a="",d,m;f=0;for(m=c.length-b;f<m;f+=3)d=(c[f]<<16)+(c[f+1]<<8)+c[f+2],d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>
12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d&63),a+=d;switch(b){case 1:d=c[c.length-1];a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>2);a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d<<4&63);a+="==";break;case 2:d=(c[c.length-2]<<8)+c[c.length-1],a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>
10),a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>4&63),a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d<<2&63),a+="="}return a}})("undefined"===typeof n?this.base64js={}:n)},{}],28:[function(k,l,n){n.read=function(c,g,f,e,h){var b;b=8*h-e-1;var a=(1<<b)-1,d=a>>1,m=-7;h=f?h-1:0;var p=f?-1:1,k=c[g+h];h+=p;f=k&(1<<-m)-1;k>>=-m;for(m+=b;0<m;f=256*f+c[g+h],h+=p,m-=8);b=f&(1<<-m)-1;f>>=-m;for(m+=e;0<m;b=256*b+c[g+h],h+=p,m-=8);if(0===f)f=
1-d;else{if(f===a)return b?NaN:Infinity*(k?-1:1);b+=Math.pow(2,e);f-=d}return(k?-1:1)*b*Math.pow(2,f-e)};n.write=function(c,g,f,e,h,b){var a,d=8*b-h-1,m=(1<<d)-1,p=m>>1,k=23===h?Math.pow(2,-24)-Math.pow(2,-77):0;b=e?0:b-1;var l=e?1:-1,n=0>g||0===g&&0>1/g?1:0;g=Math.abs(g);isNaN(g)||Infinity===g?(g=isNaN(g)?1:0,e=m):(e=Math.floor(Math.log(g)/Math.LN2),1>g*(a=Math.pow(2,-e))&&(e--,a*=2),g=1<=e+p?g+k/a:g+k*Math.pow(2,1-p),2<=g*a&&(e++,a/=2),e+p>=m?(g=0,e=m):1<=e+p?(g=(g*a-1)*Math.pow(2,h),e+=p):(g=g*
Math.pow(2,p-1)*Math.pow(2,h),e=0));for(;8<=h;c[f+b]=g&255,b+=l,g/=256,h-=8);e=e<<h|g;for(d+=h;0<d;c[f+b]=e&255,b+=l,e/=256,d-=8);c[f+b-l]|=128*n}},{}],29:[function(k,l,n){var c=Object.prototype.toString;l.exports=Array.isArray||function(g){return!!g&&"[object Array]"==c.call(g)}},{}],30:[function(k,l,n){function c(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function g(c){return"function"===typeof c}function f(c){return"object"===typeof c&&null!==c}l.exports=c;c.EventEmitter=
c;c.prototype._events=void 0;c.prototype._maxListeners=void 0;c.defaultMaxListeners=10;c.prototype.setMaxListeners=function(c){if("number"!==typeof c||0>c||isNaN(c))throw TypeError("n must be a positive number");this._maxListeners=c;return this};c.prototype.emit=function(c){var h,b,a,d;this._events||(this._events={});if("error"===c&&(!this._events.error||f(this._events.error)&&!this._events.error.length)){h=arguments[1];if(h instanceof Error)throw h;throw TypeError('Uncaught, unspecified "error" event.');
}b=this._events[c];if(void 0===b)return!1;if(g(b))switch(arguments.length){case 1:b.call(this);break;case 2:b.call(this,arguments[1]);break;case 3:b.call(this,arguments[1],arguments[2]);break;default:h=arguments.length;a=Array(h-1);for(d=1;d<h;d++)a[d-1]=arguments[d];b.apply(this,a)}else if(f(b)){h=arguments.length;a=Array(h-1);for(d=1;d<h;d++)a[d-1]=arguments[d];b=b.slice();h=b.length;for(d=0;d<h;d++)b[d].apply(this,a)}return!0};c.prototype.addListener=function(e,h){var b;if(!g(h))throw TypeError("listener must be a function");
this._events||(this._events={});this._events.newListener&&this.emit("newListener",e,g(h.listener)?h.listener:h);this._events[e]?f(this._events[e])?this._events[e].push(h):this._events[e]=[this._events[e],h]:this._events[e]=h;f(this._events[e])&&!this._events[e].warned&&(b=void 0!==this._maxListeners?this._maxListeners:c.defaultMaxListeners)&&0<b&&this._events[e].length>b&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[e].length),"function"===typeof console.trace&&console.trace());return this};c.prototype.on=c.prototype.addListener;c.prototype.once=function(c,f){function b(){this.removeListener(c,b);a||(a=!0,f.apply(this,arguments))}if(!g(f))throw TypeError("listener must be a function");var a=!1;b.listener=f;this.on(c,b);return this};c.prototype.removeListener=function(c,h){var b,a,d;if(!g(h))throw TypeError("listener must be a function");if(!this._events||!this._events[c])return this;b=this._events[c];
d=b.length;a=-1;if(b===h||g(b.listener)&&b.listener===h)delete this._events[c],this._events.removeListener&&this.emit("removeListener",c,h);else if(f(b)){for(;0<d--;)if(b[d]===h||b[d].listener&&b[d].listener===h){a=d;break}if(0>a)return this;1===b.length?(b.length=0,delete this._events[c]):b.splice(a,1);this._events.removeListener&&this.emit("removeListener",c,h)}return this};c.prototype.removeAllListeners=function(c){var f;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?
this._events={}:this._events[c]&&delete this._events[c],this;if(0===arguments.length){for(f in this._events)"removeListener"!==f&&this.removeAllListeners(f);this.removeAllListeners("removeListener");this._events={};return this}f=this._events[c];if(g(f))this.removeListener(c,f);else for(;f.length;)this.removeListener(c,f[f.length-1]);delete this._events[c];return this};c.prototype.listeners=function(c){return this._events&&this._events[c]?g(this._events[c])?[this._events[c]]:this._events[c].slice():
[]};c.listenerCount=function(c,f){return c._events&&c._events[f]?g(c._events[f])?1:c._events[f].length:0}},{}],31:[function(k,l,n){l.exports="function"===typeof Object.create?function(c,g){c.super_=g;c.prototype=Object.create(g.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}})}:function(c,g){c.super_=g;var f=function(){};f.prototype=g.prototype;c.prototype=new f;c.prototype.constructor=c}},{}],32:[function(k,l,n){function c(){if(!e){e=!0;for(var c,b=f.length;b;){c=f;f=[];
for(var a=-1;++a<b;)c[a]();b=f.length}e=!1}}function g(){}k=l.exports={};var f=[],e=!1;k.nextTick=function(h){f.push(h);e||setTimeout(c,0)};k.title="browser";k.browser=!0;k.env={};k.argv=[];k.version="";k.versions={};k.on=g;k.addListener=g;k.once=g;k.off=g;k.removeListener=g;k.removeAllListeners=g;k.emit=g;k.binding=function(c){throw Error("process.binding is not supported");};k.cwd=function(){return"/"};k.chdir=function(c){throw Error("process.chdir is not supported");};k.umask=function(){return 0}},
{}],33:[function(k,l,n){l.exports=function(c){return c&&"object"===typeof c&&"function"===typeof c.copy&&"function"===typeof c.fill&&"function"===typeof c.readUInt8}},{}],34:[function(k,l,n){(function(c,g){function f(b,c){var d={seen:[],stylize:h};3<=arguments.length&&(d.depth=arguments[2]);4<=arguments.length&&(d.colors=arguments[3]);v(c)?d.showHidden=c:c&&n._extend(d,c);r(d.showHidden)&&(d.showHidden=!1);r(d.depth)&&(d.depth=2);r(d.colors)&&(d.colors=!1);r(d.customInspect)&&(d.customInspect=!0);
d.colors&&(d.stylize=e);return a(d,b,d.depth)}function e(a,b){var c=f.styles[b];return c?"\u001b["+f.colors[c][0]+"m"+a+"\u001b["+f.colors[c][1]+"m":a}function h(a,b){return a}function b(a){var b={};a.forEach(function(a,c){b[a]=!0});return b}function a(c,e,f){if(c.customInspect&&e&&H(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var h=e.inspect(f,c);q(h)||(h=a(c,h,f));return h}if(h=d(c,e))return h;var g=Object.keys(e),k=b(g);c.showHidden&&(g=Object.getOwnPropertyNames(e));
if(E(e)&&(0<=g.indexOf("message")||0<=g.indexOf("description")))return m(e);if(0===g.length){if(H(e))return c.stylize("[Function"+(e.name?": "+e.name:"")+"]","special");if(t(e))return c.stylize(RegExp.prototype.toString.call(e),"regexp");if(F(e))return c.stylize(Date.prototype.toString.call(e),"date");if(E(e))return m(e)}var h="",z=!1,v=["{","}"];A(e)&&(z=!0,v=["[","]"]);H(e)&&(h=" [Function"+(e.name?": "+e.name:"")+"]");t(e)&&(h=" "+RegExp.prototype.toString.call(e));F(e)&&(h=" "+Date.prototype.toUTCString.call(e));
E(e)&&(h=" "+m(e));if(0===g.length&&(!z||0==e.length))return v[0]+h+v[1];if(0>f)return t(e)?c.stylize(RegExp.prototype.toString.call(e),"regexp"):c.stylize("[Object]","special");c.seen.push(e);g=z?p(c,e,f,k,g):g.map(function(a){return x(c,e,f,k,a,z)});c.seen.pop();return l(g,h,v)}function d(a,b){if(r(b))return a.stylize("undefined","undefined");if(q(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}if(C(b))return a.stylize(""+
b,"number");if(v(b))return a.stylize(""+b,"boolean");if(null===b)return a.stylize("null","null")}function m(a){return"["+Error.prototype.toString.call(a)+"]"}function p(a,b,c,d,e){for(var f=[],h=0,m=b.length;h<m;++h)Object.prototype.hasOwnProperty.call(b,String(h))?f.push(x(a,b,c,d,String(h),!0)):f.push("");e.forEach(function(e){e.match(/^\d+$/)||f.push(x(a,b,c,d,e,!0))});return f}function x(b,c,d,e,f,h){var m,g;c=Object.getOwnPropertyDescriptor(c,f)||{value:c[f]};c.get?g=c.set?b.stylize("[Getter/Setter]",
"special"):b.stylize("[Getter]","special"):c.set&&(g=b.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(e,f)||(m="["+f+"]");g||(0>b.seen.indexOf(c.value)?(g=null===d?a(b,c.value,null):a(b,c.value,d-1),-1<g.indexOf("\n")&&(g=h?g.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+g.split("\n").map(function(a){return"   "+a}).join("\n"))):g=b.stylize("[Circular]","special"));if(r(m)){if(h&&f.match(/^\d+$/))return g;m=JSON.stringify(""+f);m.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?
(m=m.substr(1,m.length-2),m=b.stylize(m,"name")):(m=m.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),m=b.stylize(m,"string"))}return m+": "+g}function l(a,b,c){var d=0;return 60<a.reduce(function(a,b){d++;0<=b.indexOf("\n")&&d++;return a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function A(a){return Array.isArray(a)}function v(a){return"boolean"===typeof a}function C(a){return"number"===typeof a}
function q(a){return"string"===typeof a}function r(a){return void 0===a}function t(a){return u(a)&&"[object RegExp]"===Object.prototype.toString.call(a)}function u(a){return"object"===typeof a&&null!==a}function F(a){return u(a)&&"[object Date]"===Object.prototype.toString.call(a)}function E(a){return u(a)&&("[object Error]"===Object.prototype.toString.call(a)||a instanceof Error)}function H(a){return"function"===typeof a}function z(a){return 10>a?"0"+a.toString(10):a.toString(10)}function w(){var a=
new Date,b=[z(a.getHours()),z(a.getMinutes()),z(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}var I=/%[sdj%]/g;n.format=function(a){if(!q(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(f(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,e=d.length,b=String(a).replace(I,function(a){if("%%"===a)return"%";if(c>=e)return a;switch(a){case "%s":return String(d[c++]);case "%d":return Number(d[c++]);case "%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),
h=d[c];c<e;h=d[++c])b=null!==h&&u(h)?b+(" "+f(h)):b+(" "+h);return b};n.deprecate=function(a,b){if(r(g.process))return function(){return n.deprecate(a,b).apply(this,arguments)};if(!0===c.noDeprecation)return a;var d=!1;return function(){if(!d){if(c.throwDeprecation)throw Error(b);c.traceDeprecation?console.trace(b):console.error(b);d=!0}return a.apply(this,arguments)}};var D={},G;n.debuglog=function(a){r(G)&&(G=c.env.NODE_DEBUG||"");a=a.toUpperCase();if(!D[a])if((new RegExp("\\b"+a+"\\b","i")).test(G)){var b=
c.pid;D[a]=function(){var c=n.format.apply(n,arguments);console.error("%s %d: %s",a,b,c)}}else D[a]=function(){};return D[a]};n.inspect=f;f.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};f.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};n.isArray=A;n.isBoolean=v;n.isNull=
function(a){return null===a};n.isNullOrUndefined=function(a){return null==a};n.isNumber=C;n.isString=q;n.isSymbol=function(a){return"symbol"===typeof a};n.isUndefined=r;n.isRegExp=t;n.isObject=u;n.isDate=F;n.isError=E;n.isFunction=H;n.isPrimitive=function(a){return null===a||"boolean"===typeof a||"number"===typeof a||"string"===typeof a||"symbol"===typeof a||"undefined"===typeof a};n.isBuffer=k("./support/isBuffer");var J="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");n.log=function(){console.log("%s - %s",
w(),n.format.apply(n,arguments))};n.inherits=k("inherits");n._extend=function(a,b){if(!b||!u(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,k("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":33,_process:32,inherits:31}],35:[function(k,l,n){(function(c){(function(c){if("function"===typeof bootstrap)bootstrap("promise",c);else if("object"===typeof n&&"object"===typeof l)l.exports=
c();else if("function"===typeof define&&define.amd)define(c);else if("undefined"!==typeof ses)ses.ok()&&(ses.makeQ=c);else if("undefined"!==typeof window||"undefined"!==typeof self){var f="undefined"!==typeof window?window:self,e=f.Q;f.Q=c();f.Q.noConflict=function(){f.Q=e;return this}}else throw Error("This environment was not anticipated by Q. Please file a bug.");})(function(){function g(a){return function(){return W.apply(a,arguments)}}function f(a,b){if(D&&b.stack&&"object"===typeof a&&null!==
a&&a.stack&&-1===a.stack.indexOf("From previous event:")){for(var c=[],d=b;d;d=d.source)d.stack&&c.unshift(d.stack);c.unshift(a.stack);for(var c=c.join("\nFrom previous event:\n").split("\n"),d=[],f=0;f<c.length;++f){var h=c[f],m;if(m=e(h)){var g=m[1];m=m[0]===U&&g>=J&&g<=X}else m=!1;m||(m=h,m=-1!==m.indexOf("(module.js:")||-1!==m.indexOf("(node.js:"));m||!h||d.push(h)}c=d.join("\n");a.stack=c}}function e(a){var b=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(b||(b=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a)))return[b[1],
Number(b[2])];if(a=/.*@(.+):(\d+)$/.exec(a))return[a[1],Number(a[2])]}function h(){if(D)try{throw Error();}catch(a){var b=a.stack.split("\n"),b=0<b[0].indexOf("@")?b[1]:b[2];if(b=e(b))return U=b[0],b[1]}}function b(a){return a instanceof p?a:v(a)?F(a):u(a)}function a(){function c(a){f=a;m.source=a;L(d,function(c,d){b.nextTick(function(){a.promiseDispatch.apply(a,d)})},void 0);e=d=void 0}var d=[],e=[],f,h=P(a.prototype),m=P(p.prototype);m.promiseDispatch=function(a,c,h){var m=B(arguments);d?(d.push(m),
"when"===c&&h[1]&&e.push(h[1])):b.nextTick(function(){f.promiseDispatch.apply(f,m)})};m.valueOf=function(){if(d)return m;var a=l(f);n(a)&&(f=a);return a};m.inspect=function(){return f?f.inspect():{state:"pending"}};if(b.longStackSupport&&D)try{throw Error();}catch(g){m.stack=g.stack.substring(g.stack.indexOf("\n")+1)}h.promise=m;h.resolve=function(a){f||c(b(a))};h.fulfill=function(a){f||c(u(a))};h.reject=function(a){f||c(t(a))};h.notify=function(a){f||L(e,function(c,d){b.nextTick(function(){d(a)})},
void 0)};return h}function d(b){if("function"!==typeof b)throw new TypeError("resolver must be a function.");var c=a();try{b(c.resolve,c.reject,c.notify)}catch(d){c.reject(d)}return c.promise}function m(a){return d(function(c,d){for(var e=0,f=a.length;e<f;e++)b(a[e]).then(c,d)})}function p(a,b,c){void 0===b&&(b=function(a){return t(Error("Promise does not support operation: "+a))});void 0===c&&(c=function(){return{state:"unknown"}});var d=P(p.prototype);d.promiseDispatch=function(c,e,f){var h;try{h=
a[e]?a[e].apply(d,f):b.call(d,e,f)}catch(m){h=t(m)}c&&c(h)};if(d.inspect=c){var e=c();"rejected"===e.state&&(d.exception=e.reason);d.valueOf=function(){var a=c();return"pending"===a.state||"rejected"===a.state?d:a.value}}return d}function k(a,c,d,e){return b(a).then(c,d,e)}function l(a){if(n(a)){var b=a.inspect();if("fulfilled"===b.state)return b.value}return a}function n(a){return a instanceof p}function v(a){return a===Object(a)&&"function"===typeof a.then}function C(){K.length=0;M.length=0;N||
(N=!0)}function q(a,d){N&&("object"===typeof c&&"function"===typeof c.emit&&b.nextTick.runAfter(function(){-1!==Q(M,a)&&(c.emit("unhandledRejection",d,a),S.push(a))}),M.push(a),d&&"undefined"!==typeof d.stack?K.push(d.stack):K.push("(no stack) "+d))}function r(a){if(N){var d=Q(M,a);-1!==d&&("object"===typeof c&&"function"===typeof c.emit&&b.nextTick.runAfter(function(){var b=Q(S,a);-1!==b&&(c.emit("rejectionHandled",K[d],a),S.splice(b,1))}),M.splice(d,1),K.splice(d,1))}}function t(a){var b=p({when:function(b){b&&
r(this);return b?b(a):this}},function(){return this},function(){return{state:"rejected",reason:a}});q(b,a);return b}function u(a){return p({when:function(){return a},get:function(b){return a[b]},set:function(b,c){a[b]=c},"delete":function(b){delete a[b]},post:function(b,c){return null===b||void 0===b?a.apply(void 0,c):a[b].apply(a,c)},apply:function(b,c){return a.apply(b,c)},keys:function(){return Y(a)}},void 0,function(){return{state:"fulfilled",value:a}})}function F(c){var d=a();b.nextTick(function(){try{c.then(d.resolve,
d.reject,d.notify)}catch(a){d.reject(a)}});return d.promise}function E(a,c,d){return b(a).spread(c,d)}function H(a,c,d){return b(a).dispatch(c,d)}function z(b){return k(b,function(b){var c=0,d=a();L(b,function(a,e,f){var h;n(e)&&"fulfilled"===(h=e.inspect()).state?b[f]=h.value:(++c,k(e,function(a){b[f]=a;0===--c&&d.resolve(b)},d.reject,function(a){d.notify({index:f,value:a})}))},void 0);0===c&&d.resolve(b);return d.promise})}function w(a){if(0===a.length)return b.resolve();var c=b.defer(),d=0;L(a,
function(b,e,f){b=a[f];d++;k(b,function(a){c.resolve(a)},function(){d--;0===d&&c.reject(Error("Can't get fulfillment value from any promise, all promises were rejected."))},function(a){c.notify({index:f,value:a})})},void 0);return c.promise}function I(a){return k(a,function(a){a=R(a,b);return k(z(R(a,function(a){return k(a,V,V)})),function(){return a})})}var D=!1;try{throw Error();}catch(G){D=!!G.stack}var J=h(),U,V=function(){},O=function(){function a(){for(var c,e;d.next;){d=d.next;c=d.task;d.task=
void 0;if(e=d.domain)d.domain=void 0,e.enter();b(c,e)}for(;g.length;)c=g.pop(),b(c);f=!1}function b(c,d){try{c()}catch(e){if(m)throw d&&d.exit(),setTimeout(a,0),d&&d.enter(),e;setTimeout(function(){throw e;},0)}d&&d.exit()}var d={task:void 0,next:null},e=d,f=!1,h=void 0,m=!1,g=[];O=function(a){e=e.next={task:a,domain:m&&c.domain,next:null};f||(f=!0,h())};if("object"===typeof c&&"[object process]"===c.toString()&&c.nextTick)m=!0,h=function(){c.nextTick(a)};else if("function"===typeof setImmediate)h=
"undefined"!==typeof window?setImmediate.bind(window,a):function(){setImmediate(a)};else if("undefined"!==typeof MessageChannel){var p=new MessageChannel;p.port1.onmessage=function(){h=k;p.port1.onmessage=a;a()};var k=function(){p.port2.postMessage(0)},h=function(){setTimeout(a,0);k()}}else h=function(){setTimeout(a,0)};O.runAfter=function(a){g.push(a);f||(f=!0,h())};return O}(),W=Function.call,B=g(Array.prototype.slice),L=g(Array.prototype.reduce||function(a,b){var c=0,d=this.length;if(1===arguments.length){do{if(c in
this){b=this[c++];break}if(++c>=d)throw new TypeError;}while(1)}for(;c<d;c++)c in this&&(b=a(b,this[c],c));return b}),Q=g(Array.prototype.indexOf||function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),R=g(Array.prototype.map||function(a,b){var c=this,d=[];L(c,function(e,f,h){d.push(a.call(b,f,h,c))},void 0);return d}),P=Object.create||function(a){function b(){}b.prototype=a;return new b},Z=g(Object.prototype.hasOwnProperty),Y=Object.keys||function(a){var b=[],c;for(c in a)Z(a,
c)&&b.push(c);return b},aa=g(Object.prototype.toString),T;T="undefined"!==typeof ReturnValue?ReturnValue:function(a){this.value=a};b.resolve=b;b.nextTick=O;b.longStackSupport=!1;"object"===typeof c&&c&&c.env&&c.env.Q_DEBUG&&(b.longStackSupport=!0);b.defer=a;a.prototype.makeNodeResolver=function(){var a=this;return function(b,c){b?a.reject(b):2<arguments.length?a.resolve(B(arguments,1)):a.resolve(c)}};b.Promise=d;b.promise=d;d.race=m;d.all=z;d.reject=t;d.resolve=b;b.passByCopy=function(a){return a};
p.prototype.passByCopy=function(){return this};b.join=function(a,c){return b(a).join(c)};p.prototype.join=function(a){return b([this,a]).spread(function(a,b){if(a===b)return a;throw Error("Can't join: not the same: "+a+" "+b);})};b.race=m;p.prototype.race=function(){return this.then(b.race)};b.makePromise=p;p.prototype.toString=function(){return"[object Promise]"};p.prototype.then=function(c,d,e){function h(a){try{return"function"===typeof c?c(a):a}catch(b){return t(b)}}function m(a){if("function"===
typeof d){f(a,g);try{return d(a)}catch(b){return t(b)}}return t(a)}var g=this,p=a(),k=!1;b.nextTick(function(){g.promiseDispatch(function(a){k||(k=!0,p.resolve(h(a)))},"when",[function(a){k||(k=!0,p.resolve(m(a)))}])});g.promiseDispatch(void 0,"when",[void 0,function(a){var c,d=!1;try{c="function"===typeof e?e(a):a}catch(f){if(d=!0,b.onerror)b.onerror(f);else throw f;}d||p.notify(c)}]);return p.promise};b.tap=function(a,c){return b(a).tap(c)};p.prototype.tap=function(a){a=b(a);return this.then(function(b){return a.fcall(b).thenResolve(b)})};
b.when=k;p.prototype.thenResolve=function(a){return this.then(function(){return a})};b.thenResolve=function(a,c){return b(a).thenResolve(c)};p.prototype.thenReject=function(a){return this.then(function(){throw a;})};b.thenReject=function(a,c){return b(a).thenReject(c)};b.nearer=l;b.isPromise=n;b.isPromiseAlike=v;b.isPending=function(a){return n(a)&&"pending"===a.inspect().state};p.prototype.isPending=function(){return"pending"===this.inspect().state};b.isFulfilled=function(a){return!n(a)||"fulfilled"===
a.inspect().state};p.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state};b.isRejected=function(a){return n(a)&&"rejected"===a.inspect().state};p.prototype.isRejected=function(){return"rejected"===this.inspect().state};var K=[],M=[],S=[],N=!0;b.resetUnhandledRejections=C;b.getUnhandledReasons=function(){return K.slice()};b.stopUnhandledRejectionTracking=function(){C();N=!1};C();b.reject=t;b.fulfill=u;b.master=function(a){return p({isDef:function(){}},function(b,c){return H(a,
b,c)},function(){return b(a).inspect()})};b.spread=E;p.prototype.spread=function(a,b){return this.all().then(function(b){return a.apply(void 0,b)},b)};b.async=function(a){return function(){function c(a,h){var m;if("undefined"===typeof StopIteration){try{m=d[a](h)}catch(g){return t(g)}return m.done?b(m.value):k(m.value,e,f)}try{m=d[a](h)}catch(p){return"[object StopIteration]"===aa(p)||p instanceof T?b(p.value):t(p)}return k(m,e,f)}var d=a.apply(this,arguments),e=c.bind(c,"next"),f=c.bind(c,"throw");
return e()}};b.spawn=function(a){b.done(b.async(a)())};b["return"]=function(a){throw new T(a);};b.promised=function(a){return function(){return E([this,z(arguments)],function(b,c){return a.apply(b,c)})}};b.dispatch=H;p.prototype.dispatch=function(c,d){var e=this,f=a();b.nextTick(function(){e.promiseDispatch(f.resolve,c,d)});return f.promise};b.get=function(a,c){return b(a).dispatch("get",[c])};p.prototype.get=function(a){return this.dispatch("get",[a])};b.set=function(a,c,d){return b(a).dispatch("set",
[c,d])};p.prototype.set=function(a,b){return this.dispatch("set",[a,b])};b.del=b["delete"]=function(a,c){return b(a).dispatch("delete",[c])};p.prototype.del=p.prototype["delete"]=function(a){return this.dispatch("delete",[a])};b.mapply=b.post=function(a,c,d){return b(a).dispatch("post",[c,d])};p.prototype.mapply=p.prototype.post=function(a,b){return this.dispatch("post",[a,b])};b.send=b.mcall=b.invoke=function(a,c){return b(a).dispatch("post",[c,B(arguments,2)])};p.prototype.send=p.prototype.mcall=
p.prototype.invoke=function(a){return this.dispatch("post",[a,B(arguments,1)])};b.fapply=function(a,c){return b(a).dispatch("apply",[void 0,c])};p.prototype.fapply=function(a){return this.dispatch("apply",[void 0,a])};b["try"]=b.fcall=function(a){return b(a).dispatch("apply",[void 0,B(arguments,1)])};p.prototype.fcall=function(){return this.dispatch("apply",[void 0,B(arguments)])};b.fbind=function(a){var c=b(a),d=B(arguments,1);return function(){return c.dispatch("apply",[this,d.concat(B(arguments))])}};
p.prototype.fbind=function(){var a=this,b=B(arguments);return function(){return a.dispatch("apply",[this,b.concat(B(arguments))])}};b.keys=function(a){return b(a).dispatch("keys",[])};p.prototype.keys=function(){return this.dispatch("keys",[])};b.all=z;p.prototype.all=function(){return z(this)};b.any=w;p.prototype.any=function(){return w(this)};b.allResolved=function(a,b,c){return function(){"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(b+" is deprecated, use "+c+" instead.",
Error("").stack);return a.apply(a,arguments)}}(I,"allResolved","allSettled");p.prototype.allResolved=function(){return I(this)};b.allSettled=function(a){return b(a).allSettled()};p.prototype.allSettled=function(){return this.then(function(a){return z(R(a,function(a){function c(){return a.inspect()}a=b(a);return a.then(c,c)}))})};b.fail=b["catch"]=function(a,c){return b(a).then(void 0,c)};p.prototype.fail=p.prototype["catch"]=function(a){return this.then(void 0,a)};b.progress=function(a,c){return b(a).then(void 0,
void 0,c)};p.prototype.progress=function(a){return this.then(void 0,void 0,a)};b.fin=b["finally"]=function(a,c){return b(a)["finally"](c)};p.prototype.fin=p.prototype["finally"]=function(a){a=b(a);return this.then(function(b){return a.fcall().then(function(){return b})},function(b){return a.fcall().then(function(){throw b;})})};b.done=function(a,c,d,e){return b(a).done(c,d,e)};p.prototype.done=function(a,d,e){var h=function(a){b.nextTick(function(){f(a,m);if(b.onerror)b.onerror(a);else throw a;})},
m=a||d||e?this.then(a,d,e):this;"object"===typeof c&&c&&c.domain&&(h=c.domain.bind(h));m.then(void 0,h)};b.timeout=function(a,c,d){return b(a).timeout(c,d)};p.prototype.timeout=function(b,c){var d=a(),e=setTimeout(function(){c&&"string"!==typeof c||(c=Error(c||"Timed out after "+b+" ms"),c.code="ETIMEDOUT");d.reject(c)},b);this.then(function(a){clearTimeout(e);d.resolve(a)},function(a){clearTimeout(e);d.reject(a)},d.notify);return d.promise};b.delay=function(a,c){void 0===c&&(c=a,a=void 0);return b(a).delay(c)};
p.prototype.delay=function(b){return this.then(function(c){var d=a();setTimeout(function(){d.resolve(c)},b);return d.promise})};b.nfapply=function(a,c){return b(a).nfapply(c)};p.prototype.nfapply=function(b){var c=a();b=B(b);b.push(c.makeNodeResolver());this.fapply(b).fail(c.reject);return c.promise};b.nfcall=function(a){var c=B(arguments,1);return b(a).nfapply(c)};p.prototype.nfcall=function(){var b=B(arguments),c=a();b.push(c.makeNodeResolver());this.fapply(b).fail(c.reject);return c.promise};b.nfbind=
b.denodeify=function(c){var d=B(arguments,1);return function(){var e=d.concat(B(arguments)),f=a();e.push(f.makeNodeResolver());b(c).fapply(e).fail(f.reject);return f.promise}};p.prototype.nfbind=p.prototype.denodeify=function(){var a=B(arguments);a.unshift(this);return b.denodeify.apply(void 0,a)};b.nbind=function(c,d){var e=B(arguments,2);return function(){var f=e.concat(B(arguments)),h=a();f.push(h.makeNodeResolver());b(function(){return c.apply(d,arguments)}).fapply(f).fail(h.reject);return h.promise}};
p.prototype.nbind=function(){var a=B(arguments,0);a.unshift(this);return b.nbind.apply(void 0,a)};b.nmapply=b.npost=function(a,c,d){return b(a).npost(c,d)};p.prototype.nmapply=p.prototype.npost=function(b,c){var d=B(c||[]),e=a();d.push(e.makeNodeResolver());this.dispatch("post",[b,d]).fail(e.reject);return e.promise};b.nsend=b.nmcall=b.ninvoke=function(c,d){var e=B(arguments,2),f=a();e.push(f.makeNodeResolver());b(c).dispatch("post",[d,e]).fail(f.reject);return f.promise};p.prototype.nsend=p.prototype.nmcall=
p.prototype.ninvoke=function(b){var c=B(arguments,1),d=a();c.push(d.makeNodeResolver());this.dispatch("post",[b,c]).fail(d.reject);return d.promise};b.nodeify=function(a,c){return b(a).nodeify(c)};p.prototype.nodeify=function(a){if(a)this.then(function(c){b.nextTick(function(){a(null,c)})},function(c){b.nextTick(function(){a(c)})});else return this};b.noConflict=function(){throw Error("Q.noConflict only works when Q is used as a global");};var X=h();return b})}).call(this,k("_process"))},{_process:32}],
36:[function(k,l,n){l.exports={name:"sip.js",title:"SIP.js",description:"A simple, intuitive, and powerful JavaScript signaling library",version:"0.7.0",main:"src/index.js",browser:{"./src/environment.js":"./src/environment_browser.js"},homepage:"http://sipjs.com",author:{name:"Will Mitchell",email:"will@onsip.com"},contributors:[{url:"http://sipjs.com/authors/"}],repository:{type:"git",url:"https://github.com/onsip/SIP.js.git"},keywords:["sip","websocket","webrtc","library","javascript"],devDependencies:{browserify:"^4.1.8",
grunt:"~0.4.0","grunt-browserify":"^2.1.0","grunt-cli":"~0.1.6","grunt-contrib-copy":"^0.5.0","grunt-contrib-jasmine":"~0.8.0","grunt-contrib-jshint":">0.5.0","grunt-contrib-uglify":"~0.2.0","grunt-peg":"~1.3.1","grunt-trimtrailingspaces":"^0.4.0",pegjs:"^0.8.0"},engines:{node:">=0.8"},license:"MIT",scripts:{prepublish:"cd src/Grammar && mkdir -p dist && pegjs --extra-options-file peg.json src/Grammar.pegjs dist/Grammar.js",test:"grunt travis --verbose"},dependencies:{ws:"^0.6.4",promiscuous:"^0.6.0"},
optionalDependencies:{promiscuous:"^0.6.0"},gitHead:"5542a6c6935099c20025e6f851a194b957013b52",readme:'# SIP.js\n\n[![Build Status](https://travis-ci.org/onsip/SIP.js.png?branch=master)](https://travis-ci.org/onsip/SIP.js)\n\nA JavaScript SIP stack for WebRTC, instant messaging, and more!\n\n\n## Website and Documentation\n\n* [SIPjs.com](http://sipjs.com)\n* [Mailing List](https://groups.google.com/forum/#!forum/sip_js)\n* [Issue Tracking](https://github.com/onsip/sip.js/issues)\n\n\n## Download\n\n* [sipjs.com/download](http://sipjs.com/download/)\n* Bower: `bower install sip.js`\n* npm: `npm install sip.js`\n\n## Authors\n\n### Will Mitchell\n\n* Lead Developer\n* <will@onsip.com>\n* /wakamoleguy on [GitHub](http://github.com/wakamoleguy), [Twitter](http://twitter.com/wakamoleguy)\n\n### James Criscuolo\n\n* <james@onsip.com>\n\n### Eric Green\n\n* <eric.green@onsip.com>\n\n### Joseph Frazier\n\n* <joseph@onsip.com>\n\n### JsSIP Authors\n\nSIP.js contains substantial portions of the JsSIP software. JsSIP\'s authors at time of fork are listed below. For up to date information about JsSIP, please visit [jssip.net](http://jssip.net)\n\n* Jos\u00e9 Luis Mill\u00e1n\n* I\u00f1aki Baz Castillo\n* Sa\u00fal Ibarra Corretg\u00e9\n\n## License\n\nSIP.js is released under the [MIT license](http://sipjs.com/license).\n\nSIP.js contains substantial portions of the JsSIP software, under the following license:\n\n~~~\nCopyright (c) 2012-2013 Jos\u00e9 Luis Mill\u00e1n - Versatica <http://www.versatica.com>\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n"Software"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\nLIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\nOF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\nWITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n~~~\n',
readmeFilename:"README.md",bugs:{url:"https://github.com/onsip/SIP.js/issues"},_id:"sip.js@0.7.0",_shasum:"a27bcdebf65e32e6d3f4f6bd2235b03215aa58cd",_from:"git+ssh://git@code.hq.twilio.com/client/SIP.js.git#stable-twilio",_resolved:"git+ssh://git@code.hq.twilio.com/client/SIP.js.git#5542a6c6935099c20025e6f851a194b957013b52"}},{}],37:[function(k,l,n){l.exports=function(c){var g;g=function(f,e,h,b){var a=h;if(void 0===h)throw new TypeError("Not enough arguments");this.ua=f;this.logger=f.getLogger("sip.clientcontext");
this.method=e;h=f.normalizeTarget(h);if(!h)throw new TypeError("Invalid target: "+a);b=Object.create(b||Object.prototype);b.extraHeaders=(b.extraHeaders||[]).slice();b.contentType&&(this.contentType=b.contentType,b.extraHeaders.push("Content-Type: "+this.contentType));this.request=new c.OutgoingRequest(this.method,h,this.ua,b.params,b.extraHeaders);b.body&&(this.body=b.body,this.request.body=this.body);this.localIdentity=this.request.from;this.remoteIdentity=this.request.to;this.data={}};g.prototype=
Object.create(c.EventEmitter.prototype);g.prototype.send=function(){(new c.RequestSender(this,this.ua)).send();return this};g.prototype.cancel=function(f){f=f||{};f=c.Utils.getCancelReason(f.status_code,f.reason_phrase);this.request.cancel(f);this.emit("cancel")};g.prototype.receiveResponse=function(f){var e=c.Utils.getReasonPhrase(f.status_code);switch(!0){case /^1[0-9]{2}$/.test(f.status_code):this.emit("progress",f,e);break;case /^2[0-9]{2}$/.test(f.status_code):this.ua.applicants[this]&&delete this.ua.applicants[this];
this.emit("accepted",f,e);break;default:this.ua.applicants[this]&&delete this.ua.applicants[this],this.emit("rejected",f,e),this.emit("failed",f,e)}};g.prototype.onRequestTimeout=function(){this.emit("failed",null,c.C.causes.REQUEST_TIMEOUT)};g.prototype.onTransportError=function(){this.emit("failed",null,c.C.causes.CONNECTION_ERROR)};c.ClientContext=g}},{}],38:[function(k,l,n){l.exports=function(c,g){return{USER_AGENT:c+"/"+g,SIP:"sip",SIPS:"sips",causes:{CONNECTION_ERROR:"Connection Error",REQUEST_TIMEOUT:"Request Timeout",
SIP_FAILURE_CODE:"SIP Failure Code",INTERNAL_ERROR:"Internal Error",BUSY:"Busy",REJECTED:"Rejected",REDIRECTED:"Redirected",UNAVAILABLE:"Unavailable",NOT_FOUND:"Not Found",ADDRESS_INCOMPLETE:"Address Incomplete",INCOMPATIBLE_SDP:"Incompatible SDP",AUTHENTICATION_ERROR:"Authentication Error",DIALOG_ERROR:"Dialog Error",WEBRTC_NOT_SUPPORTED:"WebRTC Not Supported",WEBRTC_ERROR:"WebRTC Error",CANCELED:"Canceled",NO_ANSWER:"No Answer",EXPIRES:"Expires",NO_ACK:"No ACK",NO_PRACK:"No PRACK",USER_DENIED_MEDIA_ACCESS:"User Denied Media Access",
BAD_MEDIA_DESCRIPTION:"Bad Media Description",RTP_TIMEOUT:"RTP Timeout"},supported:{UNSUPPORTED:"none",SUPPORTED:"supported",REQUIRED:"required"},SIP_ERROR_CAUSES:{REDIRECTED:[300,301,302,305,380],BUSY:[486,600],REJECTED:[403,603],NOT_FOUND:[404,604],UNAVAILABLE:[480,410,408,430],ADDRESS_INCOMPLETE:[484],INCOMPATIBLE_SDP:[488,606],AUTHENTICATION_ERROR:[401,407]},ACK:"ACK",BYE:"BYE",CANCEL:"CANCEL",INFO:"INFO",INVITE:"INVITE",MESSAGE:"MESSAGE",NOTIFY:"NOTIFY",OPTIONS:"OPTIONS",REGISTER:"REGISTER",
UPDATE:"UPDATE",SUBSCRIBE:"SUBSCRIBE",REFER:"REFER",PRACK:"PRACK",REASON_PHRASE:{100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",
407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",436:"Bad Identity-Info",437:"Unsupported Certificate",
438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",500:"Internal Server Error",
501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"}}}},{}],39:[function(k,l,n){l.exports=function(c){var g;g=function(c,e,h){this.dialog=c;this.applicant=e;this.request=h;this.reattempt=!1;this.reattemptTimer=null};g.prototype={send:function(){var f=this,e=new c.RequestSender(this,this.dialog.owner.ua);
e.send();this.request.method===c.C.INVITE&&e.clientTransaction.state!==c.Transactions.C.STATUS_TERMINATED&&(this.dialog.uac_pending_reply=!0,e.clientTransaction.on("stateChanged",function b(){if(this.state===c.Transactions.C.STATUS_ACCEPTED||this.state===c.Transactions.C.STATUS_COMPLETED||this.state===c.Transactions.C.STATUS_TERMINATED)if(this.removeListener("stateChanged",b),f.dialog.uac_pending_reply=!1,!1===f.dialog.uas_pending_reply)f.dialog.owner.onReadyToReinvite()}))},onRequestTimeout:function(){this.applicant.onRequestTimeout()},
onTransportError:function(){this.applicant.onTransportError()},receiveResponse:function(f){var e=this;if(408===f.status_code||481===f.status_code)this.applicant.onDialogError(f);else f.method===c.C.INVITE&&491===f.status_code?this.reattempt?this.applicant.receiveResponse(f):(this.request.cseq.value=this.dialog.local_seqnum+=1,this.reattemptTimer=c.Timers.setTimeout(function(){e.applicant.owner.status!==c.Session.C.STATUS_TERMINATED&&(e.reattempt=!0,e.request_sender.send())},this.getReattemptTimeout())):
this.applicant.receiveResponse(f)}};return g}},{}],40:[function(k,l,n){l.exports=function(c){var g=k("./Dialog/RequestSender")(c),f,e={STATUS_EARLY:1,STATUS_CONFIRMED:2};f=function(f,b,a,d){var m;this.uas_pending_reply=this.uac_pending_reply=!1;if(!b.hasHeader("contact"))return{error:"unable to create a Dialog without Contact header field"};d=b instanceof c.IncomingResponse?200>b.status_code?e.STATUS_EARLY:e.STATUS_CONFIRMED:d||e.STATUS_CONFIRMED;m=b.parseHeader("contact");"UAS"===a?(this.id={call_id:b.call_id,
local_tag:b.to_tag,remote_tag:b.from_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},this.state=d,this.remote_seqnum=b.cseq,this.local_uri=b.parseHeader("to").uri,this.remote_uri=b.parseHeader("from").uri,this.remote_target=m.uri,this.route_set=b.getHeaders("record-route"),this.local_seqnum=this.invite_seqnum=b.cseq):"UAC"===a&&(this.id={call_id:b.call_id,local_tag:b.from_tag,remote_tag:b.to_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},
this.state=d,this.local_seqnum=this.invite_seqnum=b.cseq,this.local_uri=b.parseHeader("from").uri,this.pracked=[],this.remote_uri=b.parseHeader("to").uri,this.remote_target=m.uri,this.route_set=b.getHeaders("record-route").reverse(),this.state!==e.STATUS_EARLY||f.hasOffer||(this.mediaHandler=f.mediaHandlerFactory(f)));this.logger=f.ua.getLogger("sip.dialog",this.id.toString());this.owner=f;f.ua.dialogs[this.id.toString()]=this;this.logger.log("new "+a+" dialog created with status "+(this.state===
e.STATUS_EARLY?"EARLY":"CONFIRMED"));f.emit("dialog",this)};f.prototype={update:function(c,b){this.state=e.STATUS_CONFIRMED;this.logger.log("dialog "+this.id.toString()+"  changed to CONFIRMED state");"UAC"===b&&(this.route_set=c.getHeaders("record-route").reverse())},terminate:function(){this.logger.log("dialog "+this.id.toString()+" deleted");this.mediaHandler&&this.state!==e.STATUS_CONFIRMED&&this.mediaHandler.peerConnection.close();delete this.owner.ua.dialogs[this.id.toString()]},createRequest:function(e,
b,a){var d;b=(b||[]).slice();this.local_seqnum||(this.local_seqnum=Math.floor(1E4*Math.random()));d=e===c.C.CANCEL||e===c.C.ACK?this.invite_seqnum:this.local_seqnum+=1;e=new c.OutgoingRequest(e,this.remote_target,this.owner.ua,{cseq:d,call_id:this.id.call_id,from_uri:this.local_uri,from_tag:this.id.local_tag,to_uri:this.remote_uri,to_tag:this.id.remote_tag,route_set:this.route_set},b,a);e.dialog=this;return e},checkInDialogRequest:function(e){var b=this;if(this.remote_seqnum){if(e.cseq<this.remote_seqnum)return e.method!==
c.C.ACK&&e.reply(500),e.cseq===this.invite_seqnum?!0:!1;e.cseq>this.remote_seqnum&&(this.remote_seqnum=e.cseq)}else this.remote_seqnum=e.cseq;switch(e.method){case c.C.INVITE:if(!0===this.uac_pending_reply)e.reply(491);else{if(!0===this.uas_pending_reply){var a=(10*Math.random()|0)+1;e.reply(500,null,["Retry-After:"+a]);return!1}this.uas_pending_reply=!0;e.server_transaction.on("stateChanged",function m(){if(this.state===c.Transactions.C.STATUS_ACCEPTED||this.state===c.Transactions.C.STATUS_COMPLETED||
this.state===c.Transactions.C.STATUS_TERMINATED)if(this.removeListener("stateChanged",m),b.uas_pending_reply=!1,!1===b.uac_pending_reply)b.owner.onReadyToReinvite()})}if(e.hasHeader("contact"))e.server_transaction.on("stateChanged",function(){this.state===c.Transactions.C.STATUS_ACCEPTED&&(b.remote_target=e.parseHeader("contact").uri)});break;case c.C.NOTIFY:if(e.hasHeader("contact"))e.server_transaction.on("stateChanged",function(){this.state===c.Transactions.C.STATUS_COMPLETED&&(b.remote_target=
e.parseHeader("contact").uri)})}return!0},sendRequest:function(c,b,a){a=a||{};var d=(a.extraHeaders||[]).slice();b=this.createRequest(b,d,a.body||null);(new g(this,c,b)).send();return b},receiveRequest:function(c){this.checkInDialogRequest(c)&&this.owner.receiveRequest(c)}};f.C=e;c.Dialog=f}},{"./Dialog/RequestSender":39}],41:[function(k,l,n){l.exports=function(c){var g;g=function(c){this.logger=c.getLogger("sipjs.digestauthentication");this.username=c.configuration.authorizationUser;this.password=
c.configuration.password;this.cnonce=null;this.nc=0;this.ncHex="00000000";this.response=null};g.prototype.authenticate=function(f,e){this.algorithm=e.algorithm;this.realm=e.realm;this.nonce=e.nonce;this.opaque=e.opaque;this.stale=e.stale;if(this.algorithm){if("MD5"!==this.algorithm)return this.logger.warn('challenge with Digest algorithm different than "MD5", authentication aborted'),!1}else this.algorithm="MD5";if(!this.realm)return this.logger.warn("challenge without Digest realm, authentication aborted"),
!1;if(!this.nonce)return this.logger.warn("challenge without Digest nonce, authentication aborted"),!1;if(e.qop)if(-1<e.qop.indexOf("auth"))this.qop="auth";else if(-1<e.qop.indexOf("auth-int"))this.qop="auth-int";else return this.logger.warn('challenge without Digest qop different than "auth" or "auth-int", authentication aborted'),!1;else this.qop=null;this.method=f.method;this.uri=f.ruri;this.cnonce=c.createRandomToken(12);this.nc+=1;this.updateNcHex();4294967296===this.nc&&(this.nc=1,this.ncHex=
"00000001");this.calculateResponse();return!0};g.prototype.calculateResponse=function(){var f,e;f=c.calculateMD5(this.username+":"+this.realm+":"+this.password);"auth"===this.qop?(e=c.calculateMD5(this.method+":"+this.uri),this.response=c.calculateMD5(f+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth:"+e)):"auth-int"===this.qop?(e=c.calculateMD5(this.method+":"+this.uri+":"+c.calculateMD5(this.body?this.body:"")),this.response=c.calculateMD5(f+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth-int:"+
e)):null===this.qop&&(e=c.calculateMD5(this.method+":"+this.uri),this.response=c.calculateMD5(f+":"+this.nonce+":"+e))};g.prototype.toString=function(){var c=[];if(!this.response)throw Error("response field does not exist, cannot generate Authorization header");c.push("algorithm="+this.algorithm);c.push('username="'+this.username+'"');c.push('realm="'+this.realm+'"');c.push('nonce="'+this.nonce+'"');c.push('uri="'+this.uri+'"');c.push('response="'+this.response+'"');this.opaque&&c.push('opaque="'+
this.opaque+'"');this.qop&&(c.push("qop="+this.qop),c.push('cnonce="'+this.cnonce+'"'),c.push("nc="+this.ncHex));return"Digest "+c.join(", ")};g.prototype.updateNcHex=function(){var c=Number(this.nc).toString(16);this.ncHex="00000000".substr(0,8-c.length)+c};return g}},{}],42:[function(k,l,n){var c=k("events").EventEmitter;l.exports=function(g){function f(){c.call(this)}f.prototype=Object.create(c.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}});f.prototype.off=function(c,
f){var b;b="SIP.EventEmitter#off is deprecated and may be removed in future SIP.js versions.\nPlease use removeListener or removeAllListeners instead.\n";b+="See here for more details:\n";b+="http://nodejs.org/api/events.html#events_emitter_removelistener_event_listener";g.warn(b);return 2>arguments.length?this.removeAllListeners.apply(this,arguments):this.removeListener(c,f)};return f}},{events:30}],43:[function(k,l,n){l.exports={ConfigurationError:function(){var c=function(c,f){this.code=1;this.name=
"CONFIGURATION_ERROR";this.parameter=c;this.message=(this.value=f)?"Invalid value "+JSON.stringify(this.value)+' for parameter "'+this.parameter+'"':"Missing parameter: "+this.parameter};c.prototype=Error();return c}(),InvalidStateError:function(){var c=function(c){this.code=2;this.name="INVALID_STATE_ERROR";this.status=c;this.message="Invalid status: "+c};c.prototype=Error();return c}(),NotSupportedError:function(){var c=function(c){this.code=3;this.name="NOT_SUPPORTED_ERROR";this.message=c};c.prototype=
Error();return c}(),GetDescriptionError:function(){var c=function(c){this.code=4;this.name="GET_DESCRIPTION_ERROR";this.message=c};c.prototype=Error();return c}()}},{}],44:[function(k,l,n){var c=k("./Grammar/dist/Grammar");l.exports=function(g){return{parse:function(f,e){var h={startRule:e,SIP:g};try{c.parse(f,h)}catch(b){h.data=-1}return h.data}}}},{"./Grammar/dist/Grammar":45}],45:[function(k,l,n){l.exports=function(){function c(c,f,e,h,b,a){this.message=c;this.expected=f;this.found=e;this.offset=
h;this.line=b;this.column=a;this.name="SyntaxError"}(function(c,f){function e(){this.constructor=c}e.prototype=f.prototype;c.prototype=new e})(c,Error);return{SyntaxError:c,parse:function(g){function f(){return g.substring(C,v)}function e(a){if(q!==a){q>a&&(q=0,r={line:1,column:1,seenCR:!1});var b=r,c,d;for(c=q;c<a;c++)d=g.charAt(c),"\n"===d?(b.seenCR||b.line++,b.column=1,b.seenCR=!1):"\r"===d||"\u2028"===d||"\u2029"===d?(b.line++,b.column=1,b.seenCR=!0):(b.column++,b.seenCR=!1);q=a}return r}function h(a){v<
t||(v>t&&(t=v,u=[]),u.push(a))}function b(a){var b=Array(a.length),c;for(c=0;c<a.length;c++)b[c]=a.charCodeAt(c)-32;return b}function a(b){function c(a){return"[object Array]"===Object.prototype.toString.apply(a)?[]:a}b=n[b];for(var d=0,e=[],f=b.length,p=[],k=[],x,q;;){for(;d<f;)switch(b[d]){case 0:k.push(c(l[b[d+1]]));d+=2;break;case 1:k.push(v);d++;break;case 2:k.pop();d++;break;case 3:v=k.pop();d++;break;case 4:k.length-=b[d+1];d+=2;break;case 5:k.splice(-2,1);d++;break;case 6:k[k.length-2].push(k.pop());
d++;break;case 7:k.push(k.splice(k.length-b[d+1],b[d+1]));d+=2;break;case 8:k.pop();k.push(g.substring(k[k.length-1],v));d++;break;case 9:p.push(f);e.push(d+3+b[d+1]+b[d+2]);k[k.length-1]?(f=d+3+b[d+1],d+=3):(f=d+3+b[d+1]+b[d+2],d+=3+b[d+1]);break;case 10:p.push(f);e.push(d+3+b[d+1]+b[d+2]);k[k.length-1]===m?(f=d+3+b[d+1],d+=3):(f=d+3+b[d+1]+b[d+2],d+=3+b[d+1]);break;case 11:p.push(f);e.push(d+3+b[d+1]+b[d+2]);k[k.length-1]!==m?(f=d+3+b[d+1],d+=3):(f=d+3+b[d+1]+b[d+2],d+=3+b[d+1]);break;case 12:k[k.length-
1]!==m?(p.push(f),e.push(d),f=d+2+b[d+1],d+=2):d+=2+b[d+1];break;case 13:p.push(f);e.push(d+3+b[d+1]+b[d+2]);g.length>v?(f=d+3+b[d+1],d+=3):(f=d+3+b[d+1]+b[d+2],d+=3+b[d+1]);break;case 14:p.push(f);e.push(d+4+b[d+2]+b[d+3]);g.substr(v,l[b[d+1]].length)===l[b[d+1]]?(f=d+4+b[d+2],d+=4):(f=d+4+b[d+2]+b[d+3],d+=4+b[d+2]);break;case 15:p.push(f);e.push(d+4+b[d+2]+b[d+3]);g.substr(v,l[b[d+1]].length).toLowerCase()===l[b[d+1]]?(f=d+4+b[d+2],d+=4):(f=d+4+b[d+2]+b[d+3],d+=4+b[d+2]);break;case 16:p.push(f);
e.push(d+4+b[d+2]+b[d+3]);l[b[d+1]].test(g.charAt(v))?(f=d+4+b[d+2],d+=4):(f=d+4+b[d+2]+b[d+3],d+=4+b[d+2]);break;case 17:k.push(g.substr(v,b[d+1]));v+=b[d+1];d+=2;break;case 18:k.push(l[b[d+1]]);v+=l[b[d+1]].length;d+=2;break;case 19:k.push(m);0===F&&h(l[b[d+1]]);d+=2;break;case 20:C=k[k.length-1-b[d+1]];d+=2;break;case 21:C=v;d++;break;case 22:x=b.slice(d+4,d+4+b[d+3]);for(q=0;q<b[d+3];q++)x[q]=k[k.length-1-x[q]];k.splice(k.length-b[d+2],b[d+2],l[b[d+1]].apply(null,x));d+=4+b[d+3];break;case 23:k.push(a(b[d+
1]));d+=2;break;case 24:F++;d++;break;case 25:F--;d++;break;default:throw Error("Invalid opcode: "+b[d]+".");}if(0<p.length)f=p.pop(),d=e.pop();else break}return k[0]}var d=1<arguments.length?arguments[1]:{},m={},p={Contact:118,Name_Addr_Header:155,Record_Route:175,Request_Response:81,SIP_URI:45,Subscription_State:185,Via:193,absoluteURI:84,Call_ID:117,Content_Disposition:129,Content_Length:134,Content_Type:135,CSeq:145,displayName:121,Event:148,From:150,host:52,Max_Forwards:153,Proxy_Authenticate:156,
quoted_string:40,Refer_To:177,Replaces:178,stun_URI:212,To:191,turn_URI:219,uuid:222,WWW_Authenticate:208,challenge:157},k=118,l=["\r\n",{type:"literal",value:"\r\n",description:'"\\r\\n"'},/^[0-9]/,{type:"class",value:"[0-9]",description:"[0-9]"},/^[a-zA-Z]/,{type:"class",value:"[a-zA-Z]",description:"[a-zA-Z]"},/^[0-9a-fA-F]/,{type:"class",value:"[0-9a-fA-F]",description:"[0-9a-fA-F]"},/^[\0-\xFF]/,{type:"class",value:"[\\0-\\xFF]",description:"[\\0-\\xFF]"},/^["]/,{type:"class",value:'["]',description:'["]'},
" ",{type:"literal",value:" ",description:'" "'},"\t",{type:"literal",value:"\t",description:'"\\t"'},/^[a-zA-Z0-9]/,{type:"class",value:"[a-zA-Z0-9]",description:"[a-zA-Z0-9]"},";",{type:"literal",value:";",description:'";"'},"/",{type:"literal",value:"/",description:'"/"'},"?",{type:"literal",value:"?",description:'"?"'},":",{type:"literal",value:":",description:'":"'},"@",{type:"literal",value:"@",description:'"@"'},"&",{type:"literal",value:"&",description:'"&"'},"=",{type:"literal",value:"=",
description:'"="'},"+",{type:"literal",value:"+",description:'"+"'},"$",{type:"literal",value:"$",description:'"$"'},",",{type:"literal",value:",",description:'","'},"-",{type:"literal",value:"-",description:'"-"'},"_",{type:"literal",value:"_",description:'"_"'},".",{type:"literal",value:".",description:'"."'},"!",{type:"literal",value:"!",description:'"!"'},"~",{type:"literal",value:"~",description:'"~"'},"*",{type:"literal",value:"*",description:'"*"'},"'",{type:"literal",value:"'",description:'"\'"'},
"(",{type:"literal",value:"(",description:'"("'},")",{type:"literal",value:")",description:'")"'},m,"%",{type:"literal",value:"%",description:'"%"'},function(a){return a.join("")},null,[],function(){return" "},function(){return":"},function(){return f()},/^[!-~]/,{type:"class",value:"[!-~]",description:"[!-~]"},/^[\x80-\uFFFF]/,{type:"class",value:"[\\x80-\\uFFFF]",description:"[\\x80-\\uFFFF]"},/^[\x80-\xBF]/,{type:"class",value:"[\\x80-\\xBF]",description:"[\\x80-\\xBF]"},/^[a-f]/,{type:"class",
value:"[a-f]",description:"[a-f]"},"`",{type:"literal",value:"`",description:'"`"'},function(){return f()},"<",{type:"literal",value:"<",description:'"<"'},">",{type:"literal",value:">",description:'">"'},"\\",{type:"literal",value:"\\",description:'"\\\\"'},"[",{type:"literal",value:"[",description:'"["'},"]",{type:"literal",value:"]",description:'"]"'},"{",{type:"literal",value:"{",description:'"{"'},"}",{type:"literal",value:"}",description:'"}"'},function(){return"*"},function(){return"/"},function(){return"="},
function(){return"("},function(){return")"},function(){return">"},function(){return"<"},function(){return","},function(){return";"},function(){return":"},function(){return'"'},/^[!-']/,{type:"class",value:"[!-']",description:"[!-']"},/^[*-[]/,{type:"class",value:"[*-[]",description:"[*-[]"},/^[\]-~]/,{type:"class",value:"[\\]-~]",description:"[\\]-~]"},function(a){return a},/^[#-[]/,{type:"class",value:"[#-[]",description:"[#-[]"},/^[\0-\t]/,{type:"class",value:"[\\0-\\t]",description:"[\\0-\\t]"},
/^[\x0B-\f]/,{type:"class",value:"[\\x0B-\\f]",description:"[\\x0B-\\f]"},/^[\x0E-\u007f]/,{type:"class",value:"[\\x0E-\u007f]",description:"[\\x0E-\u007f]"},function(){d.data.uri=new d.SIP.URI(d.data.scheme,d.data.user,d.data.host,d.data.port);delete d.data.scheme;delete d.data.user;delete d.data.host;delete d.data.host_type;delete d.data.port},function(){d.data.uri=new d.SIP.URI(d.data.scheme,d.data.user,d.data.host,d.data.port,d.data.uri_params,d.data.uri_headers);delete d.data.scheme;delete d.data.user;
delete d.data.host;delete d.data.host_type;delete d.data.port;delete d.data.uri_params;"SIP_URI"===d.startRule&&(d.data=d.data.uri)},"sips",{type:"literal",value:"sips",description:'"sips"'},"sip",{type:"literal",value:"sip",description:'"sip"'},function(a){d.data.scheme=a.toLowerCase()},function(){d.data.user=decodeURIComponent(f().slice(0,-1))},function(){d.data.password=f()},function(){d.data.host=f();return d.data.host},function(){d.data.host_type="domain";return f()},/^[a-zA-Z0-9_\-]/,{type:"class",
value:"[a-zA-Z0-9_\\-]",description:"[a-zA-Z0-9_\\-]"},/^[a-zA-Z0-9\-]/,{type:"class",value:"[a-zA-Z0-9\\-]",description:"[a-zA-Z0-9\\-]"},function(){d.data.host_type="IPv6";return f()},"::",{type:"literal",value:"::",description:'"::"'},function(){d.data.host_type="IPv6";return f()},function(){d.data.host_type="IPv4";return f()},"25",{type:"literal",value:"25",description:'"25"'},/^[0-5]/,{type:"class",value:"[0-5]",description:"[0-5]"},"2",{type:"literal",value:"2",description:'"2"'},/^[0-4]/,{type:"class",
value:"[0-4]",description:"[0-4]"},"1",{type:"literal",value:"1",description:'"1"'},/^[1-9]/,{type:"class",value:"[1-9]",description:"[1-9]"},function(a){a=parseInt(a.join(""));return d.data.port=a},"transport=",{type:"literal",value:"transport=",description:'"transport="'},"udp",{type:"literal",value:"udp",description:'"udp"'},"tcp",{type:"literal",value:"tcp",description:'"tcp"'},"sctp",{type:"literal",value:"sctp",description:'"sctp"'},"tls",{type:"literal",value:"tls",description:'"tls"'},function(a){d.data.uri_params||
(d.data.uri_params={});d.data.uri_params.transport=a.toLowerCase()},"user=",{type:"literal",value:"user=",description:'"user="'},"phone",{type:"literal",value:"phone",description:'"phone"'},"ip",{type:"literal",value:"ip",description:'"ip"'},function(a){d.data.uri_params||(d.data.uri_params={});d.data.uri_params.user=a.toLowerCase()},"method=",{type:"literal",value:"method=",description:'"method="'},function(a){d.data.uri_params||(d.data.uri_params={});d.data.uri_params.method=a},"ttl=",{type:"literal",
value:"ttl=",description:'"ttl="'},function(a){d.data.params||(d.data.params={});d.data.params.ttl=a},"maddr=",{type:"literal",value:"maddr=",description:'"maddr="'},function(a){d.data.uri_params||(d.data.uri_params={});d.data.uri_params.maddr=a},"lr",{type:"literal",value:"lr",description:'"lr"'},function(){d.data.uri_params||(d.data.uri_params={});d.data.uri_params.lr=void 0},function(a,b){d.data.uri_params||(d.data.uri_params={});b=null===b?void 0:b[1];d.data.uri_params[a.toLowerCase()]=b&&b.toLowerCase()},
function(a){return a.join("")},function(a){return a.join("")},function(a,b){a=a.join("").toLowerCase();b=b.join("");d.data.uri_headers||(d.data.uri_headers={});d.data.uri_headers[a]?d.data.uri_headers[a].push(b):d.data.uri_headers[a]=[b]},function(){"Refer_To"===d.startRule&&(d.data.uri=new d.SIP.URI(d.data.scheme,d.data.user,d.data.host,d.data.port,d.data.uri_params,d.data.uri_headers),delete d.data.scheme,delete d.data.user,delete d.data.host,delete d.data.host_type,delete d.data.port,delete d.data.uri_params)},
"//",{type:"literal",value:"//",description:'"//"'},function(){d.data.scheme=f()},{type:"literal",value:"SIP",description:'"SIP"'},function(){d.data.sip_version=f()},"INVITE",{type:"literal",value:"INVITE",description:'"INVITE"'},"ACK",{type:"literal",value:"ACK",description:'"ACK"'},"VXACH",{type:"literal",value:"VXACH",description:'"VXACH"'},"OPTIONS",{type:"literal",value:"OPTIONS",description:'"OPTIONS"'},"BYE",{type:"literal",value:"BYE",description:'"BYE"'},"CANCEL",{type:"literal",value:"CANCEL",
description:'"CANCEL"'},"REGISTER",{type:"literal",value:"REGISTER",description:'"REGISTER"'},"SUBSCRIBE",{type:"literal",value:"SUBSCRIBE",description:'"SUBSCRIBE"'},"NOTIFY",{type:"literal",value:"NOTIFY",description:'"NOTIFY"'},"REFER",{type:"literal",value:"REFER",description:'"REFER"'},function(){d.data.method=f();return d.data.method},function(a){d.data.status_code=parseInt(a.join(""))},function(){d.data.reason_phrase=f()},function(){d.data=f()},function(){var a,b;b=d.data.multi_header.length;
for(a=0;a<b;a++)if(null===d.data.multi_header[a].parsed){d.data=null;break}d.data=null!==d.data?d.data.multi_header:-1},function(){var a;d.data.multi_header||(d.data.multi_header=[]);try{a=new d.SIP.NameAddrHeader(d.data.uri,d.data.displayName,d.data.params),delete d.data.uri,delete d.data.displayName,delete d.data.params}catch(b){a=null}d.data.multi_header.push({position:v,offset:C,parsed:a})},function(a){a=f().trim();'"'===a[0]&&(a=a.substring(1,a.length-1));d.data.displayName=a},"q",{type:"literal",
value:"q",description:'"q"'},function(a){d.data.params||(d.data.params={});d.data.params.q=a},"expires",{type:"literal",value:"expires",description:'"expires"'},function(a){d.data.params||(d.data.params={});d.data.params.expires=a},function(a){return parseInt(a.join(""))},"0",{type:"literal",value:"0",description:'"0"'},function(){return parseFloat(f())},function(a,b){d.data.params||(d.data.params={});b=null===b?void 0:b[1];d.data.params[a.toLowerCase()]=b},"render",{type:"literal",value:"render",
description:'"render"'},"session",{type:"literal",value:"session",description:'"session"'},"icon",{type:"literal",value:"icon",description:'"icon"'},"alert",{type:"literal",value:"alert",description:'"alert"'},function(){"Content_Disposition"===d.startRule&&(d.data.type=f().toLowerCase())},"handling",{type:"literal",value:"handling",description:'"handling"'},"optional",{type:"literal",value:"optional",description:'"optional"'},"required",{type:"literal",value:"required",description:'"required"'},
function(a){d.data=parseInt(a.join(""))},function(){d.data=f()},"text",{type:"literal",value:"text",description:'"text"'},"image",{type:"literal",value:"image",description:'"image"'},"audio",{type:"literal",value:"audio",description:'"audio"'},"video",{type:"literal",value:"video",description:'"video"'},"application",{type:"literal",value:"application",description:'"application"'},"message",{type:"literal",value:"message",description:'"message"'},"multipart",{type:"literal",value:"multipart",description:'"multipart"'},
"x-",{type:"literal",value:"x-",description:'"x-"'},function(a){d.data.value=parseInt(a.join(""))},function(a){d.data=a},function(a){d.data.event=a.toLowerCase()},function(){var a=d.data.tag;d.data=new d.SIP.NameAddrHeader(d.data.uri,d.data.displayName,d.data.params);a&&d.data.setParam("tag",a)},"tag",{type:"literal",value:"tag",description:'"tag"'},function(a){d.data.tag=a},function(a){d.data=parseInt(a.join(""))},function(a){d.data=a},function(){d.data=new d.SIP.NameAddrHeader(d.data.uri,d.data.displayName,
d.data.params)},"digest",{type:"literal",value:"Digest",description:'"Digest"'},"realm",{type:"literal",value:"realm",description:'"realm"'},function(a){d.data.realm=a},"domain",{type:"literal",value:"domain",description:'"domain"'},"nonce",{type:"literal",value:"nonce",description:'"nonce"'},function(a){d.data.nonce=a},"opaque",{type:"literal",value:"opaque",description:'"opaque"'},function(a){d.data.opaque=a},"stale",{type:"literal",value:"stale",description:'"stale"'},"true",{type:"literal",value:"true",
description:'"true"'},function(){d.data.stale=!0},"false",{type:"literal",value:"false",description:'"false"'},function(){d.data.stale=!1},"algorithm",{type:"literal",value:"algorithm",description:'"algorithm"'},"md5",{type:"literal",value:"MD5",description:'"MD5"'},"md5-sess",{type:"literal",value:"MD5-sess",description:'"MD5-sess"'},function(a){d.data.algorithm=a.toUpperCase()},"qop",{type:"literal",value:"qop",description:'"qop"'},"auth-int",{type:"literal",value:"auth-int",description:'"auth-int"'},
"auth",{type:"literal",value:"auth",description:'"auth"'},function(a){d.data.qop||(d.data.qop=[]);d.data.qop.push(a.toLowerCase())},function(a){d.data.value=parseInt(a.join(""))},function(){var a,b;b=d.data.multi_header.length;for(a=0;a<b;a++)if(null===d.data.multi_header[a].parsed){d.data=null;break}d.data=null!==d.data?d.data.multi_header:-1},function(){var a;d.data.multi_header||(d.data.multi_header=[]);try{a=new d.SIP.NameAddrHeader(d.data.uri,d.data.displayName,d.data.params),delete d.data.uri,
delete d.data.displayName,delete d.data.params}catch(b){a=null}d.data.multi_header.push({position:v,offset:C,parsed:a})},function(){d.data=new d.SIP.NameAddrHeader(d.data.uri,d.data.displayName,d.data.params)},function(){d.data.replaces_from_tag&&d.data.replaces_to_tag||(d.data=-1)},function(){d.data={call_id:d.data}},"from-tag",{type:"literal",value:"from-tag",description:'"from-tag"'},function(a){d.data.replaces_from_tag=a},"to-tag",{type:"literal",value:"to-tag",description:'"to-tag"'},function(a){d.data.replaces_to_tag=
a},"early-only",{type:"literal",value:"early-only",description:'"early-only"'},function(){d.data.early_only=!0},function(a){d.data.value=parseInt(a.join(""))},"active",{type:"literal",value:"active",description:'"active"'},"pending",{type:"literal",value:"pending",description:'"pending"'},"terminated",{type:"literal",value:"terminated",description:'"terminated"'},function(){d.data.state=f()},"reason",{type:"literal",value:"reason",description:'"reason"'},function(a){"undefined"!==typeof a&&(d.data.reason=
a)},function(a){"undefined"!==typeof a&&(d.data.expires=a)},"retry_after",{type:"literal",value:"retry_after",description:'"retry_after"'},function(a){"undefined"!==typeof a&&(d.data.retry_after=a)},"deactivated",{type:"literal",value:"deactivated",description:'"deactivated"'},"probation",{type:"literal",value:"probation",description:'"probation"'},"rejected",{type:"literal",value:"rejected",description:'"rejected"'},"timeout",{type:"literal",value:"timeout",description:'"timeout"'},"giveup",{type:"literal",
value:"giveup",description:'"giveup"'},"noresource",{type:"literal",value:"noresource",description:'"noresource"'},"invariant",{type:"literal",value:"invariant",description:'"invariant"'},function(){var a=d.data.tag;d.data=new d.SIP.NameAddrHeader(d.data.uri,d.data.displayName,d.data.params);a&&d.data.setParam("tag",a)},"ttl",{type:"literal",value:"ttl",description:'"ttl"'},function(a){d.data.ttl=a},"maddr",{type:"literal",value:"maddr",description:'"maddr"'},function(a){d.data.maddr=a},"received",
{type:"literal",value:"received",description:'"received"'},function(a){d.data.received=a},"branch",{type:"literal",value:"branch",description:'"branch"'},function(a){d.data.branch=a},"rport",{type:"literal",value:"rport",description:'"rport"'},function(){"undefined"!==typeof response_port&&(d.data.rport=response_port.join(""))},function(a){d.data.protocol=a},{type:"literal",value:"UDP",description:'"UDP"'},{type:"literal",value:"TCP",description:'"TCP"'},{type:"literal",value:"TLS",description:'"TLS"'},
{type:"literal",value:"SCTP",description:'"SCTP"'},function(a){d.data.transport=a},function(){d.data.host=f()},function(a){d.data.port=parseInt(a.join(""))},function(a){return parseInt(a.join(""))},"stuns",{type:"literal",value:"stuns",description:'"stuns"'},"stun",{type:"literal",value:"stun",description:'"stun"'},function(a){d.data.scheme=a},function(a){d.data.host=a},function(){return f()},"?transport=",{type:"literal",value:"?transport=",description:'"?transport="'},"turns",{type:"literal",value:"turns",
description:'"turns"'},"turn",{type:"literal",value:"turn",description:'"turn"'},function(){d.data.transport=transport},function(){d.data=f()}],n=[b('. ""2 3!'),b('0"""1!3#'),b('0$""1!3%'),b('0&""1!3\''),b("7'*# \"7("),b('0(""1!3)'),b('0*""1!3+'),b('.,""2,3-'),b('..""2.3/'),b('00""1!31'),b('.2""2233*\u0089 ".4""2435*} ".6""2637*q ".8""2839*e ".:""2:3;*Y ".<""2<3=*M ".>""2>3?*A ".@""2@3A*5 ".B""2B3C*) ".D""2D3E'),b('7)*# "7,'),b('.F""2F3G*} ".H""2H3I*q ".J""2J3K*e ".L""2L3M*Y ".N""2N3O*M ".P""2P3Q*A ".R""2R3S*5 ".T""2T3U*) ".V""2V3W'),
b('!!.Y""2Y3Z+7$7#+-%7#+#%\'#%$## X$"# X"# X+\' 4!6[!! %'),b('!! ]7$,#&7$"+-$7 +#%\'"%$"# X"# X*# " \\+@$ ]7$+&$,#&7$""" X+\'%4"6^" %$"# X"# X'),b('7.*# " \\'),b('! ]7\'*# "7(,)&7\'*# "7("+A$.8""2839+1%7/+\'%4#6_# %$## X$"# X"# X'),b('! ]72+&$,#&72""" X+s$ ]! ]7.,#&7."+-$72+#%\'"%$"# X"# X,@&! ]7.,#&7."+-$72+#%\'"%$"# X"# X"+\'%4"6`" %$"# X"# X'),b('0a""1!3b*# "73'),b('0c""1!3d'),b('0e""1!3f'),b('7!*) "0g""1!3h'),b('! ]7)*\u0095 ".F""2F3G*\u0089 ".J""2J3K*} ".L""2L3M*q ".Y""2Y3Z*e ".P""2P3Q*Y ".H""2H3I*M ".@""2@3A*A ".i""2i3j*5 ".R""2R3S*) ".N""2N3O+\u009e$,\u009b&7)*\u0095 ".F""2F3G*\u0089 ".J""2J3K*} ".L""2L3M*q ".Y""2Y3Z*e ".P""2P3Q*Y ".H""2H3I*M ".@""2@3A*A ".i""2i3j*5 ".R""2R3S*) ".N""2N3O""" X+& 4!6k! %'),
b('! ]7)*\u0089 ".F""2F3G*} ".L""2L3M*q ".Y""2Y3Z*e ".P""2P3Q*Y ".H""2H3I*M ".@""2@3A*A ".i""2i3j*5 ".R""2R3S*) ".N""2N3O+\u0092$,\u008f&7)*\u0089 ".F""2F3G*} ".L""2L3M*q ".Y""2Y3Z*e ".P""2P3Q*Y ".H""2H3I*M ".@""2@3A*A ".i""2i3j*5 ".R""2R3S*) ".N""2N3O""" X+& 4!6k! %'),b('.T""2T3U*\u00e3 ".V""2V3W*\u00d7 ".l""2l3m*\u00cb ".n""2n3o*\u00bf ".:""2:3;*\u00b3 ".D""2D3E*\u00a7 ".2""2233*\u009b ".8""2839*\u008f ".p""2p3q*\u0083 "7&*} ".4""2435*q ".r""2r3s*e ".t""2t3u*Y ".6""2637*M ".>""2>3?*A ".v""2v3w*5 ".x""2x3y*) "7\'*# "7('),
b('! ]7)*\u012b ".F""2F3G*\u011f ".J""2J3K*\u0113 ".L""2L3M*\u0107 ".Y""2Y3Z*\u00fb ".P""2P3Q*\u00ef ".H""2H3I*\u00e3 ".@""2@3A*\u00d7 ".i""2i3j*\u00cb ".R""2R3S*\u00bf ".N""2N3O*\u00b3 ".T""2T3U*\u00a7 ".V""2V3W*\u009b ".l""2l3m*\u008f ".n""2n3o*\u0083 ".8""2839*w ".p""2p3q*k "7&*e ".4""2435*Y ".r""2r3s*M ".t""2t3u*A ".6""2637*5 ".v""2v3w*) ".x""2x3y+\u0134$,\u0131&7)*\u012b ".F""2F3G*\u011f ".J""2J3K*\u0113 ".L""2L3M*\u0107 ".Y""2Y3Z*\u00fb ".P""2P3Q*\u00ef ".H""2H3I*\u00e3 ".@""2@3A*\u00d7 ".i""2i3j*\u00cb ".R""2R3S*\u00bf ".N""2N3O*\u00b3 ".T""2T3U*\u00a7 ".V""2V3W*\u009b ".l""2l3m*\u008f ".n""2n3o*\u0083 ".8""2839*w ".p""2p3q*k "7&*e ".4""2435*Y ".r""2r3s*M ".t""2t3u*A ".6""2637*5 ".v""2v3w*) ".x""2x3y""" X+& 4!6k! %'),
b('!7/+A$.P""2P3Q+1%7/+\'%4#6z# %$## X$"# X"# X'),b('!7/+A$.4""2435+1%7/+\'%4#6{# %$## X$"# X"# X'),b('!7/+A$.>""2>3?+1%7/+\'%4#6|# %$## X$"# X"# X'),b('!7/+A$.T""2T3U+1%7/+\'%4#6}# %$## X$"# X"# X'),b('!7/+A$.V""2V3W+1%7/+\'%4#6~# %$## X$"# X"# X'),b('!.n""2n3o+1$7/+\'%4"6\u007f" %$"# X"# X'),b('!7/+7$.l""2l3m+\'%4"6\u0080" %$"# X"# X'),b('!7/+A$.D""2D3E+1%7/+\'%4#6\u0081# %$## X$"# X"# X'),b('!7/+A$.2""2233+1%7/+\'%4#6\u0082# %$## X$"# X"# X'),b('!7/+A$.8""2839+1%7/+\'%4#6\u0083# %$## X$"# X"# X'),
b('!7/+1$7&+\'%4"6\u0084" %$"# X"# X'),b('!7&+1$7/+\'%4"6\u0084" %$"# X"# X'),b('!7=+W$ ]7G*) "7K*# "7F,/&7G*) "7K*# "7F"+-%7>+#%\'#%$## X$"# X"# X'),b('0\u0085""1!3\u0086*A "0\u0087""1!3\u0088*5 "0\u0089""1!3\u008a*) "73*# "7.'),b('!7/+Y$7&+O% ]7J*# "7K,)&7J*# "7K"+1%7&+\'%4$6k$ %$$# X$## X$"# X"# X'),b('!7/+`$7&+V%! ]7J*# "7K,)&7J*# "7K"+! (%+2%7&+(%4$6\u008b$!!%$$# X$## X$"# X"# X'),b('7.*G ".L""2L3M*; "0\u008c""1!3\u008d*/ "0\u0089""1!3\u008a*# "73'),b('!.p""2p3q+K$0\u008e""1!3\u008f*5 "0\u0090""1!3\u0091*) "0\u0092""1!3\u0093+#%\'"%$"# X"# X'),
b('!7N+Q$.8""2839+A%7O*# " \\+1%7S+\'%4$6\u0094$ %$$# X$## X$"# X"# X'),b('!7N+k$.8""2839+[%7O*# " \\+K%7S+A%7_+7%7l*# " \\+\'%4&6\u0095& %$&# X$%# X$$# X$## X$"# X"# X'),b('!/\u0096""1$3\u0097*) "/\u0098""1#3\u0099+\' 4!6\u009a!! %'),b('!7P+b$!.8""2839+-$7R+#%\'"%$"# X"# X*# " \\+7%.:""2:3;+\'%4#6\u009b# %$## X$"# X"# X'),b(' ]7+*) "7-*# "7Q+2$,/&7+*) "7-*# "7Q""" X'),b('.<""2<3=*q ".>""2>3?*e ".@""2@3A*Y ".B""2B3C*M ".D""2D3E*A ".2""2233*5 ".6""2637*) ".4""2435'),b('! ]7+*_ "7-*Y ".<""2<3=*M ".>""2>3?*A ".@""2@3A*5 ".B""2B3C*) ".D""2D3E,e&7+*_ "7-*Y ".<""2<3=*M ".>""2>3?*A ".@""2@3A*5 ".B""2B3C*) ".D""2D3E"+& 4!6\u009c! %'),
b('!7T+N$!.8""2839+-$7^+#%\'"%$"# X"# X*# " \\+#%\'"%$"# X"# X'),b('!7U*) "7\\*# "7X+& 4!6\u009d! %'),b('! ]!7V+3$.J""2J3K+#%\'"%$"# X"# X,>&!7V+3$.J""2J3K+#%\'"%$"# X"# X"+G$7W+=%.J""2J3K*# " \\+\'%4#6\u009e# %$## X$"# X"# X'),b(' ]0\u009f""1!3\u00a0+,$,)&0\u009f""1!3\u00a0""" X'),b('!0$""1!3%+A$ ]0\u00a1""1!3\u00a2,)&0\u00a1""1!3\u00a2"+#%\'"%$"# X"# X'),b('!.r""2r3s+A$7Y+7%.t""2t3u+\'%4#6\u00a3# %$## X$"# X"# X'),b('!!7Z+\u00bf$.8""2839+\u00af%7Z+\u00a5%.8""2839+\u0095%7Z+\u008b%.8""2839+{%7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'-%$-# X$,# X$+# X$*# X$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0838 "!.\u00a4""2\u00a43\u00a5+\u00af$7Z+\u00a5%.8""2839+\u0095%7Z+\u008b%.8""2839+{%7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\',%$,# X$+# X$*# X$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0795 "!.\u00a4""2\u00a43\u00a5+\u0095$7Z+\u008b%.8""2839+{%7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'*%$*# X$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u070c "!.\u00a4""2\u00a43\u00a5+{$7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'(%$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u069d "!.\u00a4""2\u00a43\u00a5+a$7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'&%$&# X$%# X$$# X$## X$"# X"# X*\u0648 "!.\u00a4""2\u00a43\u00a5+G$7Z+=%.8""2839+-%7[+#%\'$%$$# X$## X$"# X"# X*\u060d "!.\u00a4""2\u00a43\u00a5+-$7[+#%\'"%$"# X"# X*\u05ec "!.\u00a4""2\u00a43\u00a5+-$7Z+#%\'"%$"# X"# X*\u05cb "!7Z+\u00a5$.\u00a4""2\u00a43\u00a5+\u0095%7Z+\u008b%.8""2839+{%7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'+%$+# X$*# X$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0538 "!7Z+\u00b6$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u008b%.\u00a4""2\u00a43\u00a5+{%7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'*%$*# X$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0494 "!7Z+\u00c7$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u009c%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+q%.\u00a4""2\u00a43\u00a5+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\')%$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u03df "!7Z+\u00d8$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00ad%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u0082%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+W%.\u00a4""2\u00a43\u00a5+G%7Z+=%.8""2839+-%7[+#%\'(%$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0319 "!7Z+\u00e9$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00be%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u0093%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+h%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+=%.\u00a4""2\u00a43\u00a5+-%7[+#%\'\'%$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0242 "!7Z+\u0114$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00e9%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00be%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u0093%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+h%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+=%.\u00a4""2\u00a43\u00a5+-%7Z+#%\'(%$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0140 "!7Z+\u0135$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u010a%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00df%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00b4%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u0089%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+^%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+3%.\u00a4""2\u00a43\u00a5+#%\'(%$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X+& 4!6\u00a6! %'),
b('!7#+S$7#*# " \\+C%7#*# " \\+3%7#*# " \\+#%\'$%$$# X$## X$"# X"# X'),b('!7Z+=$.8""2839+-%7Z+#%\'#%$## X$"# X"# X*# "7\\'),b('!7]+u$.J""2J3K+e%7]+[%.J""2J3K+K%7]+A%.J""2J3K+1%7]+\'%4\'6\u00a7\' %$\'# X$&# X$%# X$$# X$## X$"# X"# X'),b('!.\u00a8""2\u00a83\u00a9+3$0\u00aa""1!3\u00ab+#%\'"%$"# X"# X*\u00a0 "!.\u00ac""2\u00ac3\u00ad+=$0\u00ae""1!3\u00af+-%7!+#%\'#%$## X$"# X"# X*o "!.\u00b0""2\u00b03\u00b1+7$7!+-%7!+#%\'#%$## X$"# X"# X*D "!0\u00b2""1!3\u00b3+-$7!+#%\'"%$"# X"# X*# "7!'),b('!!7!*# " \\+c$7!*# " \\+S%7!*# " \\+C%7!*# " \\+3%7!*# " \\+#%\'%%$%# X$$# X$## X$"# X"# X+\' 4!6\u00b4!! %'),
b(' ]!.2""2233+-$7`+#%\'"%$"# X"# X,>&!.2""2233+-$7`+#%\'"%$"# X"# X"'),b('7a*A "7b*; "7c*5 "7d*/ "7e*) "7f*# "7g'),b('!/\u00b5""1*3\u00b6+b$/\u00b7""1#3\u00b8*G "/\u00b9""1#3\u00ba*; "/\u00bb""1$3\u00bc*/ "/\u00bd""1#3\u00be*# "76+(%4"6\u00bf"! %$"# X"# X'),b('!/\u00c0""1%3\u00c1+J$/\u00c2""1%3\u00c3*/ "/\u00c4""1"3\u00c5*# "76+(%4"6\u00c6"! %$"# X"# X'),b('!/\u00c7""1\'3\u00c8+2$7\u008f+(%4"6\u00c9"! %$"# X"# X'),b('!/\u00ca""1$3\u00cb+2$7\u00ef+(%4"6\u00cc"! %$"# X"# X'),b('!/\u00cd""1&3\u00ce+2$7T+(%4"6\u00cf"! %$"# X"# X'),
b('!/\u00d0""1"3\u00d1+R$!.>""2>3?+-$76+#%\'"%$"# X"# X*# " \\+\'%4"6\u00d2" %$"# X"# X'),b('!7h+T$!.>""2>3?+-$7i+#%\'"%$"# X"# X*# " \\+)%4"6\u00d3""! %$"# X"# X'),b('! ]7j+&$,#&7j""" X+\' 4!6\u00d4!! %'),b('! ]7j+&$,#&7j""" X+\' 4!6\u00d5!! %'),b('7k*) "7+*# "7-'),b('.r""2r3s*e ".t""2t3u*Y ".4""2435*M ".8""2839*A ".<""2<3=*5 ".@""2@3A*) ".B""2B3C'),b('!.6""2637+u$7m+k% ]!.<""2<3=+-$7m+#%\'"%$"# X"# X,>&!.<""2<3=+-$7m+#%\'"%$"# X"# X"+#%\'#%$## X$"# X"# X'),b('!7n+C$.>""2>3?+3%7o+)%4#6\u00d6#"" %$## X$"# X"# X'),
b(' ]7p*) "7+*# "7-+2$,/&7p*) "7+*# "7-""" X'),b(' ]7p*) "7+*# "7-,/&7p*) "7+*# "7-"'),b('.r""2r3s*e ".t""2t3u*Y ".4""2435*M ".6""2637*A ".8""2839*5 ".@""2@3A*) ".B""2B3C'),b('7\u0090*# "7r'),b("!7\u008f+K$7'+A%7s+7%7'+-%7\u0084+#%'%%$%# X$$# X$## X$\"# X\"# X"),b('7M*# "7t'),b('!7\u007f+G$.8""2839+7%7u*# "7x+\'%4#6\u00d7# %$## X$"# X"# X'),b('!7v*# "7w+N$!.6""2637+-$7\u0083+#%\'"%$"# X"# X*# " \\+#%\'"%$"# X"# X'),b('!.\u00d8""2\u00d83\u00d9+=$7\u0080+3%7w*# " \\+#%\'#%$## X$"# X"# X'),b('!.4""2435+-$7{+#%\'"%$"# X"# X'),
b('!7z+5$ ]7y,#&7y"+#%\'"%$"# X"# X'),b('7**) "7+*# "7-'),b('7+*\u008f "7-*\u0089 ".2""2233*} ".6""2637*q ".8""2839*e ".:""2:3;*Y ".<""2<3=*M ".>""2>3?*A ".@""2@3A*5 ".B""2B3C*) ".D""2D3E'),b('!7|+k$ ]!.4""2435+-$7|+#%\'"%$"# X"# X,>&!.4""2435+-$7|+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),b('! ]7~,#&7~"+k$ ]!.2""2233+-$7}+#%\'"%$"# X"# X,>&!.2""2233+-$7}+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),b(' ]7~,#&7~"'),b('7+*w "7-*q ".8""2839*e ".:""2:3;*Y ".<""2<3=*M ".>""2>3?*A ".@""2@3A*5 ".B""2B3C*) ".D""2D3E'),b('!7"+\u008d$ ]7"*G "7!*A ".@""2@3A*5 ".F""2F3G*) ".J""2J3K,M&7"*G "7!*A ".@""2@3A*5 ".F""2F3G*) ".J""2J3K"+\'%4"6\u00da" %$"# X"# X'),
b('7\u0081*# "7\u0082'),b('!!7O+3$.:""2:3;+#%\'"%$"# X"# X*# " \\+-$7S+#%\'"%$"# X"# X*# " \\'),b(' ]7+*\u0083 "7-*} ".B""2B3C*q ".D""2D3E*e ".2""2233*Y ".8""2839*M ".:""2:3;*A ".<""2<3=*5 ".>""2>3?*) ".@""2@3A+\u008c$,\u0089&7+*\u0083 "7-*} ".B""2B3C*q ".D""2D3E*e ".2""2233*Y ".8""2839*M ".:""2:3;*A ".<""2<3=*5 ".>""2>3?*) ".@""2@3A""" X'),b(' ]7y,#&7y"'),b('!/\u0098""1#3\u00db+y$.4""2435+i% ]7!+&$,#&7!""" X+P%.J""2J3K+@% ]7!+&$,#&7!""" X+\'%4%6\u00dc% %$%# X$$# X$## X$"# X"# X'),b('.\u00dd""2\u00dd3\u00de'),
b('.\u00df""2\u00df3\u00e0'),b('.\u00e1""2\u00e13\u00e2'),b('.\u00e3""2\u00e33\u00e4'),b('.\u00e5""2\u00e53\u00e6'),b('.\u00e7""2\u00e73\u00e8'),b('.\u00e9""2\u00e93\u00ea'),b('.\u00eb""2\u00eb3\u00ec'),b('.\u00ed""2\u00ed3\u00ee'),b('.\u00ef""2\u00ef3\u00f0'),b('!7\u0085*S "7\u0086*M "7\u0088*G "7\u0089*A "7\u008a*; "7\u008b*5 "7\u008c*/ "7\u008d*) "7\u008e*# "76+& 4!6\u00f1! %'),b("!7\u0084+K$7'+A%7\u0091+7%7'+-%7\u0093+#%'%%$%# X$$# X$## X$\"# X\"# X"),b("!7\u0092+' 4!6\u00f2!! %"),b('!7!+7$7!+-%7!+#%\'#%$## X$"# X"# X'),
b('! ]7**A "7+*; "7-*5 "73*/ "74*) "7\'*# "7(,G&7**A "7+*; "7-*5 "73*/ "74*) "7\'*# "7("+& 4!6\u00f3! %'),b('!7\u00b5+_$ ]!7A+-$7\u00b5+#%\'"%$"# X"# X,8&!7A+-$7\u00b5+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),b('!79+R$!.:""2:3;+-$79+#%\'"%$"# X"# X*# " \\+\'%4"6\u00f4" %$"# X"# X'),b('!7:*j "!7\u0097+_$ ]!7A+-$7\u0097+#%\'"%$"# X"# X,8&!7A+-$7\u0097+#%\'"%$"# X"# X"+#%\'"%$"# X"# X+& 4!6\u00f5! %'),b('!7L*# "7\u0098+c$ ]!7B+-$7\u009a+#%\'"%$"# X"# X,8&!7B+-$7\u009a+#%\'"%$"# X"# X"+\'%4"6\u00f6" %$"# X"# X'),
b('!7\u0099*# " \\+A$7@+7%7M+-%7?+#%\'$%$$# X$## X$"# X"# X'),b('!!76+_$ ]!7.+-$76+#%\'"%$"# X"# X,8&!7.+-$76+#%\'"%$"# X"# X"+#%\'"%$"# X"# X*# "7H+\' 4!6\u00f7!! %'),b('7\u009b*) "7\u009c*# "7\u009f'),b('!/\u00f8""1!3\u00f9+<$7<+2%7\u009e+(%4#6\u00fa#! %$## X$"# X"# X'),b('!/\u00fb""1\'3\u00fc+<$7<+2%7\u009d+(%4#6\u00fd#! %$## X$"# X"# X'),b('! ]7!+&$,#&7!""" X+\' 4!6\u00fe!! %'),b('!.\u00ff""2\u00ff3\u0100+x$!.J""2J3K+S$7!*# " \\+C%7!*# " \\+3%7!*# " \\+#%\'$%$$# X$## X$"# X"# X*# " \\+\'%4"6\u0101" %$"# X"# X'),
b('!76+N$!7<+-$7\u00a0+#%\'"%$"# X"# X*# " \\+)%4"6\u0102""! %$"# X"# X'),b('76*) "7T*# "7H'),b('!7\u00a2+_$ ]!7B+-$7\u00a3+#%\'"%$"# X"# X,8&!7B+-$7\u00a3+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),b('!/\u0103""1&3\u0104*G "/\u0105""1\'3\u0106*; "/\u0107""1$3\u0108*/ "/\u0109""1%3\u010a*# "76+& 4!6\u010b! %'),b('7\u00a4*# "7\u009f'),b('!/\u010c""1(3\u010d+O$7<+E%/\u010e""1(3\u010f*/ "/\u0110""1(3\u0111*# "76+#%\'#%$## X$"# X"# X'),b('!76+_$ ]!7A+-$76+#%\'"%$"# X"# X,8&!7A+-$76+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),
b('! ]7!+&$,#&7!""" X+\' 4!6\u0112!! %'),b("!7\u00a8+& 4!6\u0113! %"),b('!7\u00a9+s$7;+i%7\u00ae+_% ]!7B+-$7\u00af+#%\'"%$"# X"# X,8&!7B+-$7\u00af+#%\'"%$"# X"# X"+#%\'$%$$# X$## X$"# X"# X'),b('7\u00aa*# "7\u00ab'),b('/\u0114""1$3\u0115*S "/\u0116""1%3\u0117*G "/\u0118""1%3\u0119*; "/\u011a""1%3\u011b*/ "/\u011c""1+3\u011d*# "7\u00ac'),b('/\u011e""1\'3\u011f*/ "/\u0120""1)3\u0121*# "7\u00ac'),b('76*# "7\u00ad'),b('!/\u0122""1"3\u0123+-$76+#%\'"%$"# X"# X'),b('7\u00ac*# "76'),b('!76+7$7<+-%7\u00b0+#%\'#%$## X$"# X"# X'),
b('76*# "7H'),b('!7\u00b2+7$7.+-%7\u008f+#%\'#%$## X$"# X"# X'),b('! ]7!+&$,#&7!""" X+\' 4!6\u0124!! %'),b("!7\u009d+' 4!6\u0125!! %"),b('!7\u00b5+d$ ]!7B+-$7\u009f+#%\'"%$"# X"# X,8&!7B+-$7\u009f+#%\'"%$"# X"# X"+(%4"6\u0126"!!%$"# X"# X'),b('!!77+k$ ]!.J""2J3K+-$77+#%\'"%$"# X"# X,>&!.J""2J3K+-$77+#%\'"%$"# X"# X"+#%\'"%$"# X"# X+! (%'),b('!7L*# "7\u0098+c$ ]!7B+-$7\u00b7+#%\'"%$"# X"# X,8&!7B+-$7\u00b7+#%\'"%$"# X"# X"+\'%4"6\u0127" %$"# X"# X'),b('7\u00b8*# "7\u009f'),b('!/\u0128""1#3\u0129+<$7<+2%76+(%4#6\u012a#! %$## X$"# X"# X'),
b('! ]7!+&$,#&7!""" X+\' 4!6\u012b!! %'),b("!7\u009d+' 4!6\u012c!! %"),b('! ]7\u0099,#&7\u0099"+\u0081$7@+w%7M+m%7?+c% ]!7B+-$7\u009f+#%\'"%$"# X"# X,8&!7B+-$7\u009f+#%\'"%$"# X"# X"+\'%4%6\u012d% %$%# X$$# X$## X$"# X"# X'),b("7\u00bd"),b('!/\u012e""1&3\u012f+s$7.+i%7\u00c0+_% ]!7A+-$7\u00c0+#%\'"%$"# X"# X,8&!7A+-$7\u00c0+#%\'"%$"# X"# X"+#%\'$%$$# X$## X$"# X"# X*# "7\u00be'),b('!76+s$7.+i%7\u00bf+_% ]!7A+-$7\u00bf+#%\'"%$"# X"# X,8&!7A+-$7\u00bf+#%\'"%$"# X"# X"+#%\'$%$$# X$## X$"# X"# X'),b('!76+=$7<+3%76*# "7H+#%\'#%$## X$"# X"# X'),
b('7\u00c1*G "7\u00c3*A "7\u00c5*; "7\u00c7*5 "7\u00c8*/ "7\u00c9*) "7\u00ca*# "7\u00bf'),b('!/\u0130""1%3\u0131+7$7<+-%7\u00c2+#%\'#%$## X$"# X"# X'),b("!7I+' 4!6\u0132!! %"),b('!/\u0133""1&3\u0134+\u00a5$7<+\u009b%7D+\u0091%7\u00c4+\u0087% ]! ]7\'+&$,#&7\'""" X+-$7\u00c4+#%\'"%$"# X"# X,G&! ]7\'+&$,#&7\'""" X+-$7\u00c4+#%\'"%$"# X"# X"+-%7E+#%\'&%$&# X$%# X$$# X$## X$"# X"# X'),b('7t*# "7w'),b('!/\u0135""1%3\u0136+7$7<+-%7\u00c6+#%\'#%$## X$"# X"# X'),b("!7I+' 4!6\u0137!! %"),b('!/\u0138""1&3\u0139+<$7<+2%7I+(%4#6\u013a#! %$## X$"# X"# X'),
b('!/\u013b""1%3\u013c+_$7<+U%!/\u013d""1$3\u013e+& 4!6\u013f! %*4 "!/\u0140""1%3\u0141+& 4!6\u0142! %+#%\'#%$## X$"# X"# X'),b('!/\u0143""1)3\u0144+T$7<+J%/\u0145""1#3\u0146*/ "/\u0147""1(3\u0148*# "76+(%4#6\u0149#! %$## X$"# X"# X'),b('!/\u014a""1#3\u014b+\u009e$7<+\u0094%7D+\u008a%!7\u00cb+k$ ]!.D""2D3E+-$7\u00cb+#%\'"%$"# X"# X,>&!.D""2D3E+-$7\u00cb+#%\'"%$"# X"# X"+#%\'"%$"# X"# X+-%7E+#%\'%%$%# X$$# X$## X$"# X"# X'),b('!/\u014c""1(3\u014d*/ "/\u014e""1$3\u014f*# "76+\' 4!6\u0150!! %'),b('!76+_$ ]!7A+-$76+#%\'"%$"# X"# X,8&!7A+-$76+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),
b('!7\u00ce+K$7.+A%7\u00ce+7%7.+-%7\u008f+#%\'%%$%# X$$# X$## X$"# X"# X'),b('! ]7!+&$,#&7!""" X+\' 4!6\u0151!! %'),b('!7\u00d0+c$ ]!7A+-$7\u00d0+#%\'"%$"# X"# X,8&!7A+-$7\u00d0+#%\'"%$"# X"# X"+\'%4"6\u0152" %$"# X"# X'),b('!7\u0098+c$ ]!7B+-$7\u009f+#%\'"%$"# X"# X,8&!7B+-$7\u009f+#%\'"%$"# X"# X"+\'%4"6\u0153" %$"# X"# X'),b('!7L*T "7\u0098*N "!7@*# " \\+=$7t+3%7?*# " \\+#%\'#%$## X$"# X"# X+c$ ]!7B+-$7\u009f+#%\'"%$"# X"# X,8&!7B+-$7\u009f+#%\'"%$"# X"# X"+\'%4"6\u0154" %$"# X"# X'),b('!7\u00d3+c$ ]!7B+-$7\u00d4+#%\'"%$"# X"# X,8&!7B+-$7\u00d4+#%\'"%$"# X"# X"+\'%4"6\u0155" %$"# X"# X'),
b("!7\u0095+& 4!6\u0156! %"),b('!/\u0157""1(3\u0158+<$7<+2%76+(%4#6\u0159#! %$## X$"# X"# X*j "!/\u015a""1&3\u015b+<$7<+2%76+(%4#6\u015c#! %$## X$"# X"# X*: "!/\u015d""1*3\u015e+& 4!6\u015f! %*# "7\u009f'),b('!76+_$ ]!7A+-$76+#%\'"%$"# X"# X,8&!7A+-$76+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),b('!7\u00d7+_$ ]!7A+-$7\u00d7+#%\'"%$"# X"# X,8&!7A+-$7\u00d7+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),b('!7\u0098+_$ ]!7B+-$7\u009f+#%\'"%$"# X"# X,8&!7B+-$7\u009f+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),b('! ]7!+&$,#&7!""" X+\' 4!6\u0160!! %'),
b('!7\u00da+_$ ]!7B+-$7\u00db+#%\'"%$"# X"# X,8&!7B+-$7\u00db+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),b('!/\u0161""1&3\u0162*; "/\u0163""1\'3\u0164*/ "/\u0165""1*3\u0166*# "76+& 4!6\u0167! %'),b('!/\u0168""1&3\u0169+<$7<+2%7\u00dc+(%4#6\u016a#! %$## X$"# X"# X*\u0083 "!/\u00fb""1\'3\u00fc+<$7<+2%7\u009d+(%4#6\u016b#! %$## X$"# X"# X*S "!/\u016c""1+3\u016d+<$7<+2%7\u009d+(%4#6\u016e#! %$## X$"# X"# X*# "7\u009f'),b('/\u016f""1+3\u0170*k "/\u0171""1)3\u0172*_ "/\u0173""1(3\u0174*S "/\u0175""1\'3\u0176*G "/\u0177""1&3\u0178*; "/\u0179""1*3\u017a*/ "/\u017b""1)3\u017c*# "76'),
b('71*# " \\'),b('!76+_$ ]!7A+-$76+#%\'"%$"# X"# X,8&!7A+-$76+#%\'"%$"# X"# X"+#%\'"%$"# X"# X*# " \\'),b('!7L*# "7\u0098+c$ ]!7B+-$7\u00e0+#%\'"%$"# X"# X,8&!7B+-$7\u00e0+#%\'"%$"# X"# X"+\'%4"6\u017d" %$"# X"# X'),b('7\u00b8*# "7\u009f'),b('!7\u00e2+_$ ]!7A+-$7\u00e2+#%\'"%$"# X"# X,8&!7A+-$7\u00e2+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),b('!7\u00e9+s$7.+i%7\u00ec+_% ]!7B+-$7\u00e3+#%\'"%$"# X"# X,8&!7B+-$7\u00e3+#%\'"%$"# X"# X"+#%\'$%$$# X$## X$"# X"# X'),b('7\u00e4*; "7\u00e5*5 "7\u00e6*/ "7\u00e7*) "7\u00e8*# "7\u009f'),
b('!/\u017e""1#3\u017f+<$7<+2%7\u00ef+(%4#6\u0180#! %$## X$"# X"# X'),b('!/\u0181""1%3\u0182+<$7<+2%7T+(%4#6\u0183#! %$## X$"# X"# X'),b('!/\u0184""1(3\u0185+B$7<+8%7\\*# "7Y+(%4#6\u0186#! %$## X$"# X"# X'),b('!/\u0187""1&3\u0188+<$7<+2%76+(%4#6\u0189#! %$## X$"# X"# X'),b('!/\u018a""1%3\u018b+T$!7<+5$ ]7!,#&7!"+#%\'"%$"# X"# X*# " \\+\'%4"6\u018c" %$"# X"# X'),b('!7\u00ea+K$7;+A%76+7%7;+-%7\u00eb+#%\'%%$%# X$$# X$## X$"# X"# X'),b('!/\u0098""1#3\u00db*# "76+\' 4!6\u018d!! %'),b('!/\u00b7""1#3\u018e*G "/\u00b9""1#3\u018f*; "/\u00bd""1#3\u0190*/ "/\u00bb""1$3\u0191*# "76+\' 4!6\u0192!! %'),
b('!7\u00ed+H$!7C+-$7\u00ee+#%\'"%$"# X"# X*# " \\+#%\'"%$"# X"# X'),b('!7U*) "7\\*# "7X+& 4!6\u0193! %'),b('!!7!*# " \\+c$7!*# " \\+S%7!*# " \\+C%7!*# " \\+3%7!*# " \\+#%\'%%$%# X$$# X$## X$"# X"# X+\' 4!6\u0194!! %'),b('!!7!+C$7!*# " \\+3%7!*# " \\+#%\'#%$## X$"# X"# X+\' 4!6\u0195!! %'),b("7\u00bd"),b('!76+7$70+-%7\u00f2+#%\'#%$## X$"# X"# X'),b(' ]72*) "74*# "7.,/&72*) "74*# "7."'),b(' ]7%,#&7%"'),b('!7\u00f5+=$.8""2839+-%7\u00f6+#%\'#%$## X$"# X"# X'),b('!/\u0196""1%3\u0197*) "/\u0198""1$3\u0199+\' 4!6\u019a!! %'),
b('!7\u00f7+N$!.8""2839+-$7^+#%\'"%$"# X"# X*# " \\+#%\'"%$"# X"# X'),b('!7\\*) "7X*# "7\u0082+\' 4!6\u019b!! %'),b('! ]7\u00f9*) "7-*# "7\u00fa,/&7\u00f9*) "7-*# "7\u00fa"+& 4!6\u019c! %'),b('7"*S "7!*M ".F""2F3G*A ".J""2J3K*5 ".H""2H3I*) ".N""2N3O'),b('.L""2L3M*\u0095 ".B""2B3C*\u0089 ".<""2<3=*} ".R""2R3S*q ".T""2T3U*e ".V""2V3W*Y ".P""2P3Q*M ".@""2@3A*A ".D""2D3E*5 ".2""2233*) ".>""2>3?'),b('!7\u00fc+h$.8""2839+X%7\u00f6+N%!.\u019d""2\u019d3\u019e+-$7\u00eb+#%\'"%$"# X"# X*# " \\+#%\'$%$$# X$## X$"# X"# X'),
b('!/\u019f""1%3\u01a0*) "/\u01a1""1$3\u01a2+\' 4!6\u019a!! %'),b('!7\u00eb+Q$/\u00b7""1#3\u00b8*7 "/\u00b9""1#3\u00ba*+ " ]7+,#&7+"+\'%4"6\u01a3" %$"# X"# X'),b('!7\u0100+\u008f$.F""2F3G+\u007f%7\u00ff+u%.F""2F3G+e%7\u00ff+[%.F""2F3G+K%7\u00ff+A%.F""2F3G+1%7\u0101+\'%4)6\u01a4) %$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X'),b('!7#+A$7#+7%7#+-%7#+#%\'$%$$# X$## X$"# X"# X'),b('!7\u00ff+-$7\u00ff+#%\'"%$"# X"# X'),b('!7\u00ff+7$7\u00ff+-%7\u00ff+#%\'#%$## X$"# X"# X')],v=0,C=0,q=0,r={line:1,column:1,
seenCR:!1},t=0,u=[],F=0;if("startRule"in d){if(!(d.startRule in p))throw Error("Can't start parsing from rule \""+d.startRule+'".');k=p[d.startRule]}d.data={};p=a(k);if(p!==m&&v===g.length)return p;p!==m&&v<g.length&&h({type:"end",description:"end of input"});throw function(a,b,d){function f(a){var b=1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function m(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}
return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0180-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1080-\uFFFF]/g,function(a){return"\\u"+b(a)})}var d=Array(a.length),e;for(e=0;e<a.length;e++)d[e]=a[e].description;d=1<a.length?d.slice(0,-1).join(", ")+
" or "+d[a.length-1]:d[0];e=b?'"'+c(b)+'"':"end of input";return"Expected "+d+" but "+e+" found."}var h=e(d),p=d<g.length?g.charAt(d):null;null!==b&&f(b);return new c(null!==a?a:m(b,p),b,p,d,h.line,h.column)}(null,u,t);}}}()},{}],46:[function(k,l,n){l.exports=function(c){var g={AllBrowsers:{maskDtls:function(c){},unmaskDtls:function(c){return c}},Firefox:{isFirefox:function(){return"undefined"!==typeof mozRTCPeerConnection},cannotHandleExtraWhitespace:function(c){this.isFirefox()&&c.body&&(c.body=
c.body.replace(/ \r\n/g,"\r\n"))},hasMissingCLineInSDP:function(c){var e,h;if(c.indexOf("c=")>c.indexOf("m=")){h=c.match(/m=.*\r\n.*/g);for(var b=0;b<h.length;b++)0<=h[b].toString().search(/i=.*/)?(e=c.indexOf(h[b].toString())+h[b].toString().length,"c="!==c.substr(e,2)&&(c=c.substr(0,e)+"\r\nc=IN IP4 0.0.0.0"+c.substr(e))):0>h[b].toString().search(/c=.*/)&&(e=c.indexOf(h[b].toString().match(/.*/))+h[b].toString().match(/.*/).toString().length,c=c.substr(0,e)+"\r\nc=IN IP4 0.0.0.0"+c.substr(e))}return c},
hasIncompatibleCLineWithSomeSIPEndpoints:function(f){return f.replace(/(0\.0\.0\.0)/gmi,c.Utils.getRandomTestNetIP())}},Chrome:{needsExplicitlyInactiveSDP:function(c){var e,h;return g.Firefox.isFirefox()&&(h=c.indexOf("m=video 0"),-1!==h)?(e=c.substr(h),e=e.replace(/\r\nc=IN IP4.*\r\n$/,"\r\nc=IN IP4 0.0.0.0\r\na=inactive\r\n"),c.substr(0,h)+e):c},getsConfusedAboutGUM:function(c){c.mediaHandler&&c.mediaHandler.close()}}};return g}},{}],47:[function(k,l,n){var c={error:0,warn:1,log:2,debug:3};l.exports=
function(g){function f(c,b,a){this.logger=c;this.category=b;this.label=a}var e=function(){var e,b=2,a=!0,d=null;this.loggers={};e=this.getLogger("sip.loggerfactory");Object.defineProperties(this,{builtinEnabled:{get:function(){return a},set:function(b){"boolean"===typeof b?a=b:e.error('invalid "builtinEnabled" parameter value: '+JSON.stringify(b))}},level:{get:function(){return b},set:function(a){0<=a&&3>=a?b=a:3<a?b=3:c.hasOwnProperty(a)?b=c[a]:e.error('invalid "level" parameter value: '+JSON.stringify(a))}},
connector:{get:function(){return d},set:function(a){null===a||""===a||void 0===a?d=null:"function"===typeof a?d=a:e.error('invalid "connector" parameter value: '+JSON.stringify(a))}}})};e.prototype.print=function(c,b,a,d){"string"===typeof d&&(b=[new Date,b],a&&b.push(a),d=b.concat(d).join(" | "));c.call(g,d)};Object.keys(c).forEach(function(h){f.prototype[h]=function(b){this.logger[h](this.category,this.label,b)};e.prototype[h]=function(b,a,d){this.level>=c[h]&&(this.builtinEnabled&&this.print(g[h],
b,a,d),this.connector&&this.connector(h,b,a,d))}});e.prototype.getLogger=function(c,b){var a;if(b&&3===this.level)return new f(this,c,b);if(this.loggers[c])return this.loggers[c];a=new f(this,c);return this.loggers[c]=a};return e}},{}],48:[function(k,l,n){l.exports=function(c){var g=function(c,e){};g.prototype=Object.create(c.prototype,{isReady:{value:function(){}},close:{value:function(){}},getDescription:{value:function(c){}},setDescription:{value:function(c){}}});return g}},{}],49:[function(k,
l,n){l.exports=function(c){var g;g=function(f,e,h){var b;if(!(f&&f instanceof c.URI))throw new TypeError('missing or invalid "uri" parameter');this.uri=f;this.parameters={};for(b in h)this.setParam(b,h[b]);Object.defineProperties(this,{friendlyName:{get:function(){return this.displayName||f.aor}},displayName:{get:function(){return e},set:function(a){e=0===a?"0":a}}})};g.prototype={setParam:function(c,e){c&&(this.parameters[c.toLowerCase()]="undefined"===typeof e||null===e?null:e.toString())},getParam:c.URI.prototype.getParam,
hasParam:c.URI.prototype.hasParam,deleteParam:c.URI.prototype.deleteParam,clearParams:c.URI.prototype.clearParams,clone:function(){return new g(this.uri.clone(),this.displayName,JSON.parse(JSON.stringify(this.parameters)))},toString:function(){var c,e;c=this.displayName||0===this.displayName?'"'+this.displayName+'" ':"";c+="<"+this.uri.toString()+">";for(e in this.parameters)c+=";"+e,null!==this.parameters[e]&&(c+="="+this.parameters[e]);return c}};g.parse=function(f){f=c.Grammar.parse(f,"Name_Addr_Header");
if(-1!==f)return f};c.NameAddrHeader=g}},{}],50:[function(k,l,n){l.exports=function(c){c.Parser={parseMessage:function(g,f){var e,h,b,a,d=0;b=g.indexOf("\r\n");h=f.getLogger("sip.parser");if(-1===b)h.warn("no CRLF found, not a SIP message, discarded");else if(e=g.substring(0,b),a=c.Grammar.parse(e,"Request_Response"),-1===a)h.warn('error parsing first line of SIP message: "'+e+'"');else{a.status_code?(e=new c.IncomingResponse(f),e.status_code=a.status_code,e.reason_phrase=a.reason_phrase):(e=new c.IncomingRequest(f),
e.method=a.method,e.ruri=a.uri);e.data=g;for(d=b+2;;){a:{b=g;a=d;var m=0,p=0;if(b.substring(a,a+2).match(/(^\r\n)/))b=-2;else{for(;0===m;){p=b.indexOf("\r\n",a);if(-1===p){b=p;break a}!b.substring(p+2,p+4).match(/(^\r\n)/)&&b.charAt(p+2).match(/(^\s+)/)?a=p+2:m=p}b=m}}if(-2===b){b=d+2;break}else if(-1===b){h.error("malformed message");return}a=e;var m=g,k=d,d=b,l=p=void 0,n=void 0,v=void 0,p=m.indexOf(":",k),k=m.substring(k,p).trim(),m=m.substring(p+1,d).trim();switch(k.toLowerCase()){case "via":case "v":a.addHeader("via",
m);if(1===a.getHeaders("via").length){if(v=a.parseHeader("Via"))a.via=v,a.via_branch=v.branch}else v=0;break;case "from":case "f":a.setHeader("from",m);if(v=a.parseHeader("from"))a.from=v,a.from_tag=v.getParam("tag");break;case "to":case "t":a.setHeader("to",m);if(v=a.parseHeader("to"))a.to=v,a.to_tag=v.getParam("tag");break;case "record-route":v=c.Grammar.parse(m,"Record_Route");if(-1===v){v=void 0;break}n=v.length;for(l=0;l<n;l++)p=v[l],a.addHeader("record-route",m.substring(p.position,p.offset)),
a.headers["Record-Route"][a.getHeaders("record-route").length-1].parsed=p.parsed;break;case "call-id":case "i":a.setHeader("call-id",m);if(v=a.parseHeader("call-id"))a.call_id=m;break;case "contact":case "m":v=c.Grammar.parse(m,"Contact");if(-1===v){v=void 0;break}n=v.length;for(l=0;l<n;l++)p=v[l],a.addHeader("contact",m.substring(p.position,p.offset)),a.headers.Contact[a.getHeaders("contact").length-1].parsed=p.parsed;break;case "content-length":case "l":a.setHeader("content-length",m);v=a.parseHeader("content-length");
break;case "content-type":case "c":a.setHeader("content-type",m);v=a.parseHeader("content-type");break;case "cseq":a.setHeader("cseq",m);if(v=a.parseHeader("cseq"))a.cseq=v.value;a instanceof c.IncomingResponse&&(a.method=v.method);break;case "max-forwards":a.setHeader("max-forwards",m);v=a.parseHeader("max-forwards");break;case "www-authenticate":a.setHeader("www-authenticate",m);v=a.parseHeader("www-authenticate");break;case "proxy-authenticate":a.setHeader("proxy-authenticate",m);v=a.parseHeader("proxy-authenticate");
break;case "refer-to":case "r":a.setHeader("refer-to",m);if(v=a.parseHeader("refer-to"))a.refer_to=v;break;default:a.setHeader(k,m),v=0}a=void 0===v?{error:'error parsing header "'+k+'"'}:!0;if(!0!==a){h.error(a.error);return}d=b+2}e.hasHeader("content-length")?(h=e.getHeader("content-length"),e.body=g.substr(b,h)):e.body=g.substring(b);return e}}}}},{}],51:[function(k,l,n){l.exports=function(c){var g;g=function(f){var e={};this.registrar=f.configuration.registrarServer;this.expires=f.configuration.registerExpires;
this.contact=f.contact.toString();this.contact+=";reg-id=1";this.contact+=';+sip.instance="<urn:uuid:'+f.configuration.instanceId+'>"';this.call_id=c.Utils.createRandomToken(22);this.cseq=80;this.to_uri=f.configuration.uri;e.to_uri=this.to_uri;e.call_id=this.call_id;e.cseq=this.cseq;c.Utils.augment(this,c.ClientContext,[f,"REGISTER",this.registrar,{params:e}]);this.registrationExpiredTimer=this.registrationTimer=null;this.registered=!1;this.logger=f.getLogger("sip.registercontext")};g.prototype={register:function(f){var e=
this,h;this.options=f||{};h=(this.options.extraHeaders||[]).slice();h.push("Contact: "+this.contact+";expires="+this.expires);h.push("Allow: "+c.Utils.getAllowedMethods(this.ua));this.closeHeaders=f.closeWithHeaders?(this.options.extraHeaders||[]).slice():[];this.receiveResponse=function(b){var a,d,f=b.getHeaders("contact").length;if(b.cseq===this.cseq)switch(null!==this.registrationTimer&&(c.Timers.clearTimeout(this.registrationTimer),this.registrationTimer=null),!0){case /^1[0-9]{2}$/.test(b.status_code):this.emit("progress",
b);break;case /^2[0-9]{2}$/.test(b.status_code):this.emit("accepted",b);b.hasHeader("expires")&&(d=b.getHeader("expires"));null!==this.registrationExpiredTimer&&(c.Timers.clearTimeout(this.registrationExpiredTimer),this.registrationExpiredTimer=null);if(!f){this.logger.warn("no Contact header in response to REGISTER, response ignored");break}for(;f--;)if(a=b.parseHeader("contact",f),a.uri.user===this.ua.contact.uri.user){d=a.getParam("expires");break}else a=null;if(!a){this.logger.warn("no Contact header pointing to us, response ignored");
break}d||(d=this.expires);this.registrationTimer=c.Timers.setTimeout(function(){e.registrationTimer=null;e.register(e.options)},1E3*d-3E3);this.registrationExpiredTimer=c.Timers.setTimeout(function(){e.logger.warn("registration expired");e.registered&&e.unregistered(null,c.C.causes.EXPIRES)},1E3*d);a.hasParam("temp-gruu")&&(this.ua.contact.temp_gruu=c.URI.parse(a.getParam("temp-gruu").replace(/"/g,"")));a.hasParam("pub-gruu")&&(this.ua.contact.pub_gruu=c.URI.parse(a.getParam("pub-gruu").replace(/"/g,
"")));this.registered=!0;this.emit("registered",b||null);break;case /^423$/.test(b.status_code):b.hasHeader("min-expires")?(this.expires=b.getHeader("min-expires"),this.register(this.options)):(this.logger.warn("423 response received for REGISTER without Min-Expires"),this.registrationFailure(b,c.C.causes.SIP_FAILURE_CODE));break;default:a=c.Utils.sipErrorCause(b.status_code),this.registrationFailure(b,a)}};this.onRequestTimeout=function(){this.registrationFailure(null,c.C.causes.REQUEST_TIMEOUT)};
this.onTransportError=function(){this.registrationFailure(null,c.C.causes.CONNECTION_ERROR)};this.cseq++;this.request.cseq=this.cseq;this.request.setHeader("cseq",this.cseq+" REGISTER");this.request.extraHeaders=h;this.send()},registrationFailure:function(c,e){this.emit("failed",c||null,e||null)},onTransportClosed:function(){this.registered_before=this.registered;null!==this.registrationTimer&&(c.Timers.clearTimeout(this.registrationTimer),this.registrationTimer=null);null!==this.registrationExpiredTimer&&
(c.Timers.clearTimeout(this.registrationExpiredTimer),this.registrationExpiredTimer=null);this.registered&&this.unregistered(null,c.C.causes.CONNECTION_ERROR)},onTransportConnected:function(){this.register(this.options)},close:function(){var c={all:!1,extraHeaders:this.closeHeaders};this.registered_before=this.registered;this.unregister(c)},unregister:function(f){var e;this.registered?(f=f||{},e=(f.extraHeaders||[]).slice(),this.registered=!1,null!==this.registrationTimer&&(c.Timers.clearTimeout(this.registrationTimer),
this.registrationTimer=null),f.all?(e.push("Contact: *"),e.push("Expires: 0")):e.push("Contact: "+this.contact+";expires=0"),this.receiveResponse=function(e){var b;switch(!0){case /^1[0-9]{2}$/.test(e.status_code):this.emit("progress",e);break;case /^2[0-9]{2}$/.test(e.status_code):this.emit("accepted",e);null!==this.registrationExpiredTimer&&(c.Timers.clearTimeout(this.registrationExpiredTimer),this.registrationExpiredTimer=null);this.unregistered(e);break;default:b=c.Utils.sipErrorCause(e.status_code),
this.unregistered(e,b)}},this.onRequestTimeout=function(){},this.onTransportError=function(){},this.cseq++,this.request.cseq=this.cseq,this.request.setHeader("cseq",this.cseq+" REGISTER"),this.request.extraHeaders=e,this.send()):this.logger.warn("already unregistered")},unregistered:function(c,e){this.registered=!1;this.emit("unregistered",c||null,e||null)}};c.RegisterContext=g}},{}],52:[function(k,l,n){l.exports=function(c){var g;g=function(f,e){this.logger=e.getLogger("sip.requestsender");this.ua=
e;this.applicant=f;this.method=f.request.method;this.request=f.request;this.credentials=null;this.staled=this.challenged=!1;if(e.status===c.UA.C.STATUS_USER_CLOSED&&(this.method!==c.C.BYE||this.method!==c.C.ACK))this.onTransportError()};g.prototype={send:function(){switch(this.method){case "INVITE":this.clientTransaction=new c.Transactions.InviteClientTransaction(this,this.request,this.ua.transport);break;case "ACK":this.clientTransaction=new c.Transactions.AckClientTransaction(this,this.request,
this.ua.transport);break;default:this.clientTransaction=new c.Transactions.NonInviteClientTransaction(this,this.request,this.ua.transport)}this.clientTransaction.send();return this.clientTransaction},onRequestTimeout:function(){this.applicant.onRequestTimeout()},onTransportError:function(){this.applicant.onTransportError()},receiveResponse:function(f){var e,h;h=f.status_code;401===h||407===h?(401===f.status_code?(e=f.parseHeader("www-authenticate"),h="authorization"):(e=f.parseHeader("proxy-authenticate"),
h="proxy-authorization"),e?!this.challenged||!this.staled&&!0===e.stale?(this.credentials||(this.credentials=this.ua.configuration.authenticationFactory(this.ua)),this.credentials.authenticate(this.request,e)?(this.challenged=!0,e.stale&&(this.staled=!0),f.method===c.C.REGISTER?f=this.applicant.cseq+=1:this.request.dialog?f=this.request.dialog.local_seqnum+=1:(f=this.request.cseq+1,this.request.cseq=f),this.request.setHeader("cseq",f+" "+this.method),this.request.setHeader(h,this.credentials.toString()),
this.send()):this.applicant.receiveResponse(f)):this.applicant.receiveResponse(f):(this.logger.warn(f.status_code+" with wrong or missing challenge, cannot authenticate"),this.applicant.receiveResponse(f))):this.applicant.receiveResponse(f)}};c.RequestSender=g}},{}],53:[function(k,l,n){var c={};l.exports=function(g){var f=k("../package.json");Object.defineProperties(c,{version:{get:function(){return f.version}},name:{get:function(){return f.title}}});k("./Utils")(c,g);c.LoggerFactory=k("./LoggerFactory")(g.console);
c.EventEmitter=k("./EventEmitter")(g.console);c.C=k("./Constants")(c.name,c.version);c.Exceptions=k("./Exceptions");c.Timers=k("./Timers")(g.timers);c.Transport=g.Transport(c,g.WebSocket);k("./Parser")(c);k("./SIPMessage")(c);k("./URI")(c);k("./NameAddrHeader")(c);k("./Transactions")(c);k("./Dialogs")(c);k("./RequestSender")(c);k("./RegisterContext")(c);c.MediaHandler=k("./MediaHandler")(c.EventEmitter);k("./ClientContext")(c);k("./ServerContext")(c);k("./Session")(c,g);k("./Subscription")(c);c.WebRTC=
k("./WebRTC")(c,g);k("./UA")(c,g);c.Hacks=k("./Hacks")(c);k("./SanityCheck")(c);c.DigestAuthentication=k("./DigestAuthentication")(c.Utils);c.Grammar=k("./Grammar")(c);return c}},{"../package.json":36,"./ClientContext":37,"./Constants":38,"./Dialogs":40,"./DigestAuthentication":41,"./EventEmitter":42,"./Exceptions":43,"./Grammar":44,"./Hacks":46,"./LoggerFactory":47,"./MediaHandler":48,"./NameAddrHeader":49,"./Parser":50,"./RegisterContext":51,"./RequestSender":52,"./SIPMessage":54,"./SanityCheck":55,
"./ServerContext":56,"./Session":57,"./Subscription":59,"./Timers":60,"./Transactions":61,"./UA":63,"./URI":64,"./Utils":65,"./WebRTC":66}],54:[function(k,l,n){l.exports=function(c){var g,f,e,h;g=function(b,a,d,e,f,h){e=e||{};if(!b||!a||!d)return null;this.logger=d.getLogger("sip.sipmessage");this.ua=d;this.headers={};this.method=b;this.ruri=a;this.body=h;this.extraHeaders=(f||[]).slice();this.statusCode=e.status_code;this.reasonPhrase=e.reason_phrase;e.route_set?this.setHeader("route",e.route_set):
d.configuration.usePreloadedRoute&&this.setHeader("route",d.transport.server.sip_uri);this.setHeader("via","");this.setHeader("max-forwards",c.UA.C.MAX_FORWARDS);f=e.to_displayName||0===e.to_displayName?'"'+e.to_displayName+'" ':"";f+="<"+(e.to_uri||a)+">";f+=e.to_tag?";tag="+e.to_tag:"";this.to=new c.NameAddrHeader.parse(f);this.setHeader("to",f);a=e.from_displayName||0===e.from_displayName?'"'+e.from_displayName+'" ':d.configuration.displayName?'"'+d.configuration.displayName+'" ':"";a+="<"+(e.from_uri||
d.configuration.uri)+">;tag=";a+=e.from_tag||c.Utils.newTag();this.from=new c.NameAddrHeader.parse(a);this.setHeader("from",a);this.call_id=d=e.call_id||d.configuration.sipjsId+c.Utils.createRandomToken(15);this.setHeader("call-id",d);this.cseq=e=e.cseq||Math.floor(1E4*Math.random());this.setHeader("cseq",e+" "+b)};g.prototype={setHeader:function(b,a){this.headers[c.Utils.headerize(b)]=a instanceof Array?a:[a]},getHeader:function(b){var a,d=this.extraHeaders.length,e=this.headers[c.Utils.headerize(b)];
if(e){if(e[0])return e[0]}else for(b=new RegExp("^\\s*"+b+"\\s*:","i"),a=0;a<d;a++)if(e=this.extraHeaders[a],b.test(e))return e.substring(e.indexOf(":")+1).trim()},getHeaders:function(b){var a,d,e=this.headers[c.Utils.headerize(b)],f=[];if(e)for(a=e.length,b=0;b<a;b++)f.push(e[b]);else for(a=this.extraHeaders.length,d=new RegExp("^\\s*"+b+"\\s*:","i"),b=0;b<a;b++)e=this.extraHeaders[b],d.test(e)&&f.push(e.substring(e.indexOf(":")+1).trim());return f},hasHeader:function(b){var a,d=this.extraHeaders.length;
if(this.headers[c.Utils.headerize(b)])return!0;b=new RegExp("^\\s*"+b+"\\s*:","i");for(a=0;a<d;a++)if(b.test(this.extraHeaders[a]))return!0;return!1},toString:function(){var b,a,d,e,f=[];b=""+(this.method+" "+this.ruri+" SIP/2.0\r\n");for(a in this.headers)for(d=this.headers[a].length,e=0;e<d;e++)b+=a+": "+this.headers[a][e]+"\r\n";d=this.extraHeaders.length;for(e=0;e<d;e++)b+=this.extraHeaders[e].trim()+"\r\n";this.method===c.C.REGISTER?f.push("path","gruu"):this.method===c.C.INVITE&&(this.ua.contact.pub_gruu||
this.ua.contact.temp_gruu)&&f.push("gruu");this.ua.configuration.rel100===c.C.supported.SUPPORTED&&f.push("100rel");this.ua.configuration.replaces===c.C.supported.SUPPORTED&&f.push("replaces");f.push("outbound");b=b+("Supported: "+f+"\r\n")+("User-Agent: "+this.ua.configuration.userAgentString+"\r\n");this.body?(d=c.Utils.str_utf8_length(this.body),b+="Content-Length: "+d+"\r\n\r\n",b+=this.body):b+="Content-Length: 0\r\n\r\n";return b}};f=function(){this.body=this.to_tag=this.to=this.from_tag=this.from=
this.cseq=this.call_id=this.via_branch=this.via=this.method=this.headers=this.data=null};f.prototype={addHeader:function(b,a){var d={raw:a};b=c.Utils.headerize(b);this.headers[b]?this.headers[b].push(d):this.headers[b]=[d]},getHeader:function(b){if((b=this.headers[c.Utils.headerize(b)])&&b[0])return b[0].raw},getHeaders:function(b){var a,d=this.headers[c.Utils.headerize(b)],e=[];if(!d)return[];a=d.length;for(b=0;b<a;b++)e.push(d[b].raw);return e},hasHeader:function(b){return this.headers[c.Utils.headerize(b)]?
!0:!1},parseHeader:function(b,a){var d,e,f;b=c.Utils.headerize(b);a=a||0;if(this.headers[b])if(a>=this.headers[b].length)this.logger.log('not so many "'+b+'" headers present');else{d=this.headers[b][a];e=d.raw;if(d.parsed)return d.parsed;f=c.Grammar.parse(e,b.replace(/-/g,"_"));if(-1===f)this.headers[b].splice(a,1),this.logger.warn('error parsing "'+b+'" header field with value "'+e+'"');else return d.parsed=f}else this.logger.log('header "'+b+'" not present')},s:function(b,a){return this.parseHeader(b,
a)},setHeader:function(b,a){var d={raw:a};this.headers[c.Utils.headerize(b)]=[d]},toString:function(){return this.data}};e=function(b){this.logger=b.getLogger("sip.sipmessage");this.ua=b;this.headers={};this.server_transaction=this.transport=this.ruri=null};e.prototype=new f;e.prototype.reply=function(b,a,d,e,f,h){var g,k,l,n,q=[];l=this.getHeader("To");var r=k=0;n=c.Utils.buildStatusLine(b,a);d=(d||[]).slice();if(this.method===c.C.INVITE&&100<b&&200>=b)for(g=this.getHeaders("record-route"),a=g.length,
k;k<a;k++)n+="Record-Route: "+g[k]+"\r\n";k=this.getHeaders("via");a=k.length;for(r;r<a;r++)n+="Via: "+k[r]+"\r\n";!this.to_tag&&100<b?l+=";tag="+c.Utils.newTag():this.to_tag&&!this.s("to").hasParam("tag")&&(l+=";tag="+this.to_tag);n=n+("To: "+l+"\r\n")+("From: "+this.getHeader("From")+"\r\n");n+="Call-ID: "+this.call_id+"\r\n";n+="CSeq: "+this.cseq+" "+this.method+"\r\n";a=d.length;for(l=0;l<a;l++)n+=d[l].trim()+"\r\n";this.method===c.C.INVITE&&(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&
q.push("gruu");this.ua.configuration.rel100===c.C.supported.SUPPORTED&&q.push("100rel");this.ua.configuration.replaces===c.C.supported.SUPPORTED&&q.push("replaces");q.push("outbound");n+="Supported: "+q+"\r\n";n+="User-Agent: "+this.ua.configuration.userAgentString+"\r\n";e?(a=c.Utils.str_utf8_length(e),n+="Content-Type: application/sdp\r\n",n+="Content-Length: "+a+"\r\n\r\n",n+=e):n+="Content-Length: 0\r\n\r\n";this.server_transaction.receiveResponse(b,n).then(f,h);return n};e.prototype.reply_sl=
function(b,a){var d,e;d=0;var f=this.getHeaders("via"),h=f.length;e=c.Utils.buildStatusLine(b,a);for(d;d<h;d++)e+="Via: "+f[d]+"\r\n";d=this.getHeader("To");!this.to_tag&&100<b?d+=";tag="+c.Utils.newTag():this.to_tag&&!this.s("to").hasParam("tag")&&(d+=";tag="+this.to_tag);e=e+("To: "+d+"\r\n")+("From: "+this.getHeader("From")+"\r\n");e+="Call-ID: "+this.call_id+"\r\n";e+="CSeq: "+this.cseq+" "+this.method+"\r\n";e+="User-Agent: "+this.ua.configuration.userAgentString+"\r\n";e+="Content-Length: 0\r\n\r\n";
this.transport.send(e)};h=function(b){this.logger=b.getLogger("sip.sipmessage");this.headers={};this.reason_phrase=this.status_code=null};h.prototype=new f;c.OutgoingRequest=g;c.IncomingRequest=e;c.IncomingResponse=h}},{}],55:[function(k,l,n){l.exports=function(c){function g(a){var d;a=c.Utils.buildStatusLine(a);d=e.getHeaders("via");var f=d.length,h=0;for(h;h<f;h++)a+="Via: "+d[h]+"\r\n";d=e.getHeader("To");e.to_tag||(d+=";tag="+c.Utils.newTag());a=a+("To: "+d+"\r\n")+("From: "+e.getHeader("From")+
"\r\n");a+="Call-ID: "+e.call_id+"\r\n";a+="CSeq: "+e.cseq+" "+e.method+"\r\n";a+="\r\n";b.send(a)}var f,e,h,b,a=[],d=[],m=[];a.push(function(){if(!e.ruri||"sip"!==e.ruri.scheme)return g(416),!1});a.push(function(){if(!e.to_tag&&e.call_id.substr(0,5)===h.configuration.sipjsId)return g(482),!1});a.push(function(){var a=c.Utils.str_utf8_length(e.body),b=e.getHeader("content-length");if(a<b)return g(400),!1});a.push(function(){var a,b,d=e.from_tag,f=e.call_id,m=e.cseq;if(!e.to_tag)if(e.method===c.C.INVITE){if(a=
h.transactions.ist[e.via_branch],!a)for(b in h.transactions.ist)if(a=h.transactions.ist[b],a.request.from_tag===d&&a.request.call_id===f&&a.request.cseq===m)return g(482),!1}else if(a=h.transactions.nist[e.via_branch],!a)for(b in h.transactions.nist)if(a=h.transactions.nist[b],a.request.from_tag===d&&a.request.call_id===f&&a.request.cseq===m)return g(482),!1});d.push(function(){if(1<e.getHeaders("via").length)return f.warn("More than one Via header field present in the response. Dropping the response"),
!1});d.push(function(){var a=c.Utils.str_utf8_length(e.body),b=e.getHeader("content-length");if(a<b)return f.warn("Message body length is lower than the value in Content-Length header field. Dropping the response"),!1});m.push(function(){for(var a=["from","to","call_id","cseq","via"],b=a.length;b--;)if(!e.hasHeader(a[b]))return f.warn("Missing mandatory header field : "+a[b]+". Dropping the response"),!1});c.sanityCheck=function(g,k,l){e=g;h=k;b=l;f=h.getLogger("sip.sanitycheck");for(g=m.length;g--;)if(k=
m[g](e),!1===k)return!1;if(e instanceof c.IncomingRequest)for(g=a.length;g--;){if(k=a[g](e),!1===k)return!1}else if(e instanceof c.IncomingResponse)for(g=d.length;g--;)if(k=d[g](e),!1===k)return!1;return!0}}},{}],56:[function(k,l,n){l.exports=function(c){var g;g=function(f,e){this.ua=f;this.logger=f.getLogger("sip.servercontext");this.request=e;this.transaction=e.method===c.C.INVITE?new c.Transactions.InviteServerTransaction(e,f):new c.Transactions.NonInviteServerTransaction(e,f);e.body&&(this.body=
e.body);e.hasHeader("Content-Type")&&(this.contentType=e.getHeader("Content-Type"));this.method=e.method;this.data={};this.localIdentity=e.to;this.remoteIdentity=e.from};g.prototype=Object.create(c.EventEmitter.prototype);g.prototype.progress=function(c){c=Object.create(c||Object.prototype);c.statusCode||(c.statusCode=180);c.minCode=100;c.maxCode=199;c.events=["progress"];return this.reply(c)};g.prototype.accept=function(c){c=Object.create(c||Object.prototype);c.statusCode||(c.statusCode=200);c.minCode=
200;c.maxCode=299;c.events=["accepted"];return this.reply(c)};g.prototype.reject=function(c){c=Object.create(c||Object.prototype);c.statusCode||(c.statusCode=480);c.minCode=300;c.maxCode=699;c.events=["rejected","failed"];return this.reply(c)};g.prototype.reply=function(f){f=f||{};var e=f.statusCode||100,h=f.minCode||100,b=f.maxCode||699,a=c.Utils.getReasonPhrase(e,f.reasonPhrase),d=f.extraHeaders||[],m=f.body;f=f.events||[];var g;if(e<h||e>b)throw new TypeError("Invalid statusCode: "+e);g=this.request.reply(e,
a,d,m);f.forEach(function(b){this.emit(b,g,a)},this);return this};g.prototype.onRequestTimeout=function(){this.emit("failed",null,c.C.causes.REQUEST_TIMEOUT)};g.prototype.onTransportError=function(){this.emit("failed",null,c.C.causes.CONNECTION_ERROR)};c.ServerContext=g}},{}],57:[function(k,l,n){l.exports=function(c,g){var f=k("./Session/DTMF")(c),e,h,b={STATUS_NULL:0,STATUS_INVITE_SENT:1,STATUS_1XX_RECEIVED:2,STATUS_INVITE_RECEIVED:3,STATUS_WAITING_FOR_ANSWER:4,STATUS_ANSWERED:5,STATUS_WAITING_FOR_PRACK:6,
STATUS_WAITING_FOR_ACK:7,STATUS_CANCELED:8,STATUS_TERMINATED:9,STATUS_ANSWERED_WAITING_FOR_PRACK:10,STATUS_EARLY_MEDIA:11,STATUS_CONFIRMED:12};e=function(a){this.status=b.STATUS_NULL;this.dialog=null;this.earlyDialogs={};this.mediaHandlerFactory=a||c.WebRTC.MediaHandler.defaultFactory;this.hasAnswer=this.hasOffer=!1;this.timers={ackTimer:null,expiresTimer:null,invite2xxTimer:null,userNoAnswerTimer:null,rel1xxTimer:null,prackTimer:null};this.tones=this.endTime=this.startTime=null;this.remote_hold=
this.local_hold=!1;this.pending_actions={actions:[],length:function(){return this.actions.length},isPending:function(a){var b=0,c=this.actions.length;for(b;b<c;b++)if(this.actions[b].name===a)return!0;return!1},shift:function(){return this.actions.shift()},push:function(a){this.actions.push({name:a})},pop:function(a){var b=0,c=this.actions.length;for(b;b<c;b++)this.actions[b].name===a&&(this.actions.splice(b,1),c--,b--)}};this.early_sdp=null;this.rel100=c.C.supported.UNSUPPORTED};e.prototype={dtmf:function(a,
d){var e=[],h=this;d=d||{};if(void 0===a)throw new TypeError("Not enough arguments");if(this.status!==b.STATUS_CONFIRMED&&this.status!==b.STATUS_WAITING_FOR_ACK)throw new c.Exceptions.InvalidStateError(this.status);if("string"!==typeof a&&"number"!==typeof a||!a.toString().match(/^[0-9A-D#*,]+$/i))throw new TypeError("Invalid tones: "+a);for(a=a.toString().split("");0<a.length;)e.push(new f(this,a.shift(),d));if(this.tones)return this.tones=this.tones.concat(e),this;var g=function(){var a;if(h.status===
b.STATUS_TERMINATED||!h.tones||0===h.tones.length)return h.tones=null,this;a=h.tones.shift();a.on("failed",function(){h.tones=null});a.send(d);c.Timers.setTimeout(g,a.duration+a.interToneGap)};this.tones=e;g();return this},bye:function(a){a=Object.create(a||Object.prototype);var d=a.statusCode;if(this.status===b.STATUS_TERMINATED)return this.logger.error("Error: Attempted to send BYE in a terminated session."),this;this.logger.log("terminating Session");if(d&&(200>d||700<=d))throw new TypeError("Invalid statusCode: "+
d);a.receiveResponse=function(){};return this.sendRequest(c.C.BYE,a).terminated()},refer:function(a,d){d=d||{};var e=(d.extraHeaders||[]).slice(),f=a instanceof c.InviteServerContext||a instanceof c.InviteClientContext,h=a;if(void 0===a)throw new TypeError("Not enough arguments");if(this.status!==b.STATUS_CONFIRMED)throw new c.Exceptions.InvalidStateError(this.status);if(f)a='"'+a.remoteIdentity.friendlyName+'" <'+a.dialog.remote_target.toString()+"?Replaces="+a.dialog.id.call_id+"%3Bto-tag%3D"+a.dialog.id.remote_tag+
"%3Bfrom-tag%3D"+a.dialog.id.local_tag+">";else{try{a=c.Grammar.parse(a,"Refer_To").uri||a}catch(g){this.logger.debug(".refer() cannot parse Refer_To from",a),this.logger.debug("...falling through to normalizeTarget()")}a=this.ua.normalizeTarget(a);if(!a)throw new TypeError("Invalid target: "+h);}e.push("Contact: "+this.contact);e.push("Allow: "+c.Utils.getAllowedMethods(this.ua));e.push("Refer-To: "+a);e.push("Allow-Events: refer");e.push("Event: refer;id="+Math.floor(1E3*Math.random()+1));this.sendRequest(c.C.REFER,
{extraHeaders:e,body:d.body,receiveResponse:function(a){/^2[0-9]{2}$/.test(a.status_code)}.bind(this)});return this},followRefer:function(a){return function(a,b){var e=b.parseHeader("refer-to"),f=e.uri;if(f.scheme.match("^sips?$")){var h=[],k=f.getHeader("Replaces");void 0!==k&&h.push("Replaces: "+decodeURIComponent(k));f.clearHeaders();k=(k=this.mediaHandler.getReferMedia)?k.call(this.mediaHandler):this.mediaHint;c.Hacks.Chrome.getsConfusedAboutGUM(this);e=this.ua.invite(f,{media:k,params:{to_displayName:e.friendlyName},
extraHeaders:h});a.call(this,b,e);this.terminate()}else e=f.toString(),"function"===typeof g.open?g.open(e):this.logger.warn("referred to non-SIP URI but `open` isn't in the environment: "+e)}.bind(this,a)},sendRequest:function(a,b){b=b||{};var e=this,f=new c.OutgoingRequest(a,this.dialog.remote_target,this.ua,{cseq:b.cseq||(this.dialog.local_seqnum+=1),call_id:this.dialog.id.call_id,from_uri:this.dialog.local_uri,from_tag:this.dialog.id.local_tag,to_uri:this.dialog.remote_uri,to_tag:this.dialog.id.remote_tag,
route_set:this.dialog.route_set,statusCode:b.statusCode,reasonPhrase:b.reasonPhrase},b.extraHeaders||[],b.body);(new c.RequestSender({request:f,onRequestTimeout:function(){e.onRequestTimeout()},onTransportError:function(){e.onTransportError()},receiveResponse:b.receiveResponse||function(a){e.receiveNonInviteResponse(a)}},this.ua)).send();this.emit(a.toLowerCase(),f);return this},close:function(){var a;if(this.status===b.STATUS_TERMINATED)return this;this.logger.log("closing INVITE session "+this.id);
this.mediaHandler&&this.mediaHandler.close();for(a in this.timers)c.Timers.clearTimeout(this.timers[a]);this.dialog&&(this.dialog.terminate(),delete this.dialog);for(a in this.earlyDialogs)this.earlyDialogs[a].terminate(),delete this.earlyDialogs[a];this.status=b.STATUS_TERMINATED;delete this.ua.sessions[this.id];return this},createDialog:function(a,b,e){var f,h=a.call_id+a["UAS"===b?"to_tag":"from_tag"]+a["UAS"===b?"from_tag":"to_tag"];f=this.earlyDialogs[h];if(e){if(f)return!0;f=new c.Dialog(this,
a,b,c.Dialog.C.STATUS_EARLY);if(f.error)return this.logger.error(f.error),this.failed(a,c.C.causes.INTERNAL_ERROR),!1;this.earlyDialogs[h]=f;return!0}if(f){f.update(a,b);this.dialog=f;delete this.earlyDialogs[h];for(var g in this.earlyDialogs)this.earlyDialogs[g].terminate(),delete this.earlyDialogs[g];return!0}b=new c.Dialog(this,a,b);if(b.error)return this.logger.error(b.error),this.failed(a,c.C.causes.INTERNAL_ERROR),!1;this.to_tag=a.to_tag;this.dialog=b;return!0},isReadyToReinvite:function(){return this.mediaHandler.isReady()&&
!this.dialog.uac_pending_reply&&!this.dialog.uas_pending_reply},mute:function(a){if(a=this.mediaHandler.mute(a))this.onmute(a)},unmute:function(a){if(a=this.mediaHandler.unmute(a))this.onunmute(a)},hold:function(){if(this.status!==b.STATUS_WAITING_FOR_ACK&&this.status!==b.STATUS_CONFIRMED)throw new c.Exceptions.InvalidStateError(this.status);this.mediaHandler.hold();this.isReadyToReinvite()?!0!==this.local_hold&&(this.onhold("local"),this.sendReinvite({mangle:function(a){/a=(sendrecv|sendonly|recvonly|inactive)/.test(a)?
(a=a.replace(/a=sendrecv\r\n/g,"a=sendonly\r\n"),a=a.replace(/a=recvonly\r\n/g,"a=inactive\r\n")):a=a.replace(/(m=[^\r]*\r\n)/g,"$1a=sendonly\r\n");return a}})):this.pending_actions.isPending("unhold")?this.pending_actions.pop("unhold"):this.pending_actions.isPending("hold")||this.pending_actions.push("hold")},unhold:function(){if(this.status!==b.STATUS_WAITING_FOR_ACK&&this.status!==b.STATUS_CONFIRMED)throw new c.Exceptions.InvalidStateError(this.status);this.mediaHandler.unhold();this.isReadyToReinvite()?
!1!==this.local_hold&&(this.onunhold("local"),this.sendReinvite()):this.pending_actions.isPending("hold")?this.pending_actions.pop("hold"):this.pending_actions.isPending("unhold")||this.pending_actions.push("unhold")},isOnHold:function(){return{local:this.local_hold,remote:this.remote_hold}},receiveReinvite:function(a){var d=this;a.body&&("application/sdp"!==a.getHeader("Content-Type")?(this.logger.warn("invalid Content-Type"),a.reply(415)):this.mediaHandler.setDescription(a.body).then(this.mediaHandler.getDescription.bind(this.mediaHandler,
this.mediaHint)).then(function(c){a.reply(200,null,["Contact: "+d.contact],c,function(){d.status=b.STATUS_WAITING_FOR_ACK;d.setInvite2xxTimer(a,c);d.setACKTimer();var e=/a=(sendonly|inactive)/.test(a.body);if(d.remote_hold&&!e)d.onunhold("remote");else if(!d.remote_hold&&e)d.onhold("remote")})}).catch(function(b){b instanceof c.Exceptions.GetDescriptionError?b=500:(d.logger.error(b),b=488);a.reply(b)}))},sendReinvite:function(a){a=a||{};var d=this,e=(a.extraHeaders||[]).slice(),f=a.eventHandlers||
{};a=a.mangle||null;this.reinviteSucceeded=f.succeeded?f.succeeded:function(){c.Timers.clearTimeout(d.timers.ackTimer);c.Timers.clearTimeout(d.timers.invite2xxTimer);d.status=b.STATUS_CONFIRMED};this.reinviteFailed=f.failed?f.failed:function(){};e.push("Contact: "+this.contact);e.push("Allow: "+c.Utils.getAllowedMethods(this.ua));e.push("Content-Type: application/sdp");this.receiveResponse=this.receiveReinviteResponse;this.mediaHandler.getDescription(d.mediaHint).then(a).then(function(a){d.dialog.sendRequest(d,
c.C.INVITE,{extraHeaders:e,body:a})},function(){if(d.isReadyToReinvite())d.onReadyToReinvite();d.reinviteFailed()})},receiveRequest:function(a){switch(a.method){case c.C.BYE:a.reply(200);this.status===b.STATUS_CONFIRMED&&(this.emit("bye",a),this.terminated(a,c.C.causes.BYE));break;case c.C.INVITE:this.status===b.STATUS_CONFIRMED&&(this.logger.log("re-INVITE received"),this.receiveReinvite(a));break;case c.C.INFO:if(this.status===b.STATUS_CONFIRMED||this.status===b.STATUS_WAITING_FOR_ACK){var d,e,
h;d=a.getHeader("content-type");var g=/^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/,k=/^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/;d&&(d.match(/^application\/dtmf-relay/i)?(a.body&&(d=a.body.split("\r\n",2),2===d.length&&(g.test(d[0])&&(e=d[0].replace(g,"$2")),k.test(d[1])&&(h=parseInt(d[1].replace(k,"$2"),10)))),(new f(this,e,{duration:h})).init_incoming(a)):a.reply(415,null,["Accept: application/dtmf-relay"]))}break;case c.C.REFER:this.status===b.STATUS_CONFIRMED&&(this.logger.log("REFER received"),a.reply(202,
"Accepted"),e=this.listeners("refer").length,this.sendRequest(c.C.NOTIFY,{extraHeaders:["Event: refer","Subscription-State: terminated","Content-Type: message/sipfrag"],body:e?"SIP/2.0 100 Trying":"SIP/2.0 603 Declined",receiveResponse:function(){}}),e&&this.emit("refer",a));break;case c.C.NOTIFY:a.reply(200,"OK")}},receiveReinviteResponse:function(a){var d=this,e=a.getHeader("Content-Type");if(this.status!==b.STATUS_TERMINATED)switch(!0){case /^1[0-9]{2}$/.test(a.status_code):break;case /^2[0-9]{2}$/.test(a.status_code):this.status=
b.STATUS_CONFIRMED;this.sendRequest(c.C.ACK,{cseq:a.cseq});if(!a.body){this.reinviteFailed();break}else if("application/sdp"!==e){this.reinviteFailed();break}this.mediaHandler.setDescription(a.body).then(function(){d.reinviteSucceeded()},function(){d.reinviteFailed()});break;default:this.reinviteFailed()}},acceptAndTerminate:function(a,b,e){var f=[];b&&f.push("Reason: "+c.Utils.getReasonHeaderValue(b,e));if(this.dialog||this.createDialog(a,"UAC"))this.sendRequest(c.C.ACK,{cseq:a.cseq}),this.sendRequest(c.C.BYE,
{extraHeaders:f});return this},setInvite2xxTimer:function(a,d){var e=this,f=c.Timers.T1;this.timers.invite2xxTimer=c.Timers.setTimeout(function y(){e.status===b.STATUS_WAITING_FOR_ACK&&(e.logger.log("no ACK received, attempting to retransmit OK"),a.reply(200,null,["Contact: "+e.contact],d),f=Math.min(2*f,c.Timers.T2),e.timers.invite2xxTimer=c.Timers.setTimeout(y,f))},f)},setACKTimer:function(){var a=this;this.timers.ackTimer=c.Timers.setTimeout(function(){a.status===b.STATUS_WAITING_FOR_ACK&&(a.logger.log("no ACK received for an extended period of time, terminating the call"),
c.Timers.clearTimeout(a.timers.invite2xxTimer),a.sendRequest(c.C.BYE),a.terminated(null,c.C.causes.NO_ACK))},c.Timers.TIMER_H)},onReadyToReinvite:function(){var a=this.pending_actions.shift();if(a&&this[a.name])this[a.name]()},onTransportError:function(){this.status!==b.STATUS_CONFIRMED&&this.status!==b.STATUS_TERMINATED&&this.failed(null,c.C.causes.CONNECTION_ERROR)},onRequestTimeout:function(){this.status===b.STATUS_CONFIRMED?this.terminated(null,c.C.causes.REQUEST_TIMEOUT):this.status!==b.STATUS_TERMINATED&&
(this.failed(null,c.C.causes.REQUEST_TIMEOUT),this.terminated(null,c.C.causes.REQUEST_TIMEOUT))},onDialogError:function(a){this.status===b.STATUS_CONFIRMED?this.terminated(a,c.C.causes.DIALOG_ERROR):this.status!==b.STATUS_TERMINATED&&(this.failed(a,c.C.causes.DIALOG_ERROR),this.terminated(a,c.C.causes.DIALOG_ERROR))},onhold:function(a){this["local"===a?"local_hold":"remote_hold"]=!0;this.emit("hold",{originator:a})},onunhold:function(a){this["local"===a?"local_hold":"remote_hold"]=!1;this.emit("unhold",
{originator:a})},onmute:function(a){this.emit("muted",{audio:a.audio,video:a.video})},onunmute:function(a){this.emit("unmuted",{audio:a.audio,video:a.video})},failed:function(a,c){if(this.status===b.STATUS_TERMINATED)return this;this.emit("failed",a||null,c||null);return this},rejected:function(a,b){this.emit("rejected",a||null,b||null);return this},canceled:function(){this.emit("cancel");return this},accepted:function(a,b){b=c.Utils.getReasonPhrase(a&&a.status_code,b);this.startTime=new Date;this.replacee&&
(this.replacee.emit("replaced",this),this.replacee.terminate());this.emit("accepted",a,b);return this},terminated:function(a,c){if(this.status===b.STATUS_TERMINATED)return this;this.endTime=new Date;this.close();this.emit("terminated",a||null,c||null);return this},connecting:function(a){this.emit("connecting",{request:a});return this}};e.desugar=function(a){g.HTMLMediaElement&&a instanceof g.HTMLMediaElement&&(a={media:{constraints:{audio:!0,video:"VIDEO"===a.tagName},render:{remote:a}}});return a||
{}};e.C=b;c.Session=e;h=function(a,d){function e(a,b){d.hasHeader(a)&&0<=d.getHeader(a).toLowerCase().indexOf("100rel")&&(g.rel100=b)}function f(){var a={extraHeaders:["Contact: "+g.contact]};g.rel100!==c.C.supported.REQUIRED&&g.progress(a);g.status=b.STATUS_WAITING_FOR_ANSWER;g.timers.userNoAnswerTimer=c.Timers.setTimeout(function(){d.reply(408);g.failed(d,c.C.causes.NO_ANSWER);g.terminated(d,c.C.causes.NO_ANSWER)},g.ua.configuration.noAnswerTimeout);h&&(g.timers.expiresTimer=c.Timers.setTimeout(function(){g.status===
b.STATUS_WAITING_FOR_ANSWER&&(d.reply(487),g.failed(d,c.C.causes.EXPIRES),g.terminated(d,c.C.causes.EXPIRES))},h));g.emit("invite",d)}var h,g=this,k=d.getHeader("Content-Type"),l=d.parseHeader("Content-Disposition");if(!l&&"application/sdp"!==k||l&&"render"===l.type)this.renderbody=d.body,this.rendertype=k;else if("application/sdp"!==k&&l&&"session"===l.type){d.reply(415);return}c.Hacks.Firefox.cannotHandleExtraWhitespace(d);c.Hacks.AllBrowsers.maskDtls(d);c.Utils.augment(this,c.ServerContext,[a,
d]);c.Utils.augment(this,c.Session,[a.configuration.mediaHandlerFactory]);this.status=b.STATUS_INVITE_RECEIVED;this.from_tag=d.from_tag;this.id=d.call_id+this.from_tag;this.request=d;this.contact=this.ua.contact.toString();this.receiveNonInviteResponse=function(){};this.logger=a.getLogger("sip.inviteservercontext",this.id);this.ua.sessions[this.id]=this;d.hasHeader("expires")&&(h=1E3*d.getHeader("expires"));e("require",c.C.supported.REQUIRED);e("supported",c.C.supported.SUPPORTED);d.to_tag=c.Utils.newTag();
this.createDialog(d,"UAS",!0)?((this.mediaHandler=this.mediaHandlerFactory(this,{RTCConstraints:{optional:[{DtlsSrtpKeyAgreement:"true"}]}}))&&this.mediaHandler.getRemoteStreams&&(this.getRemoteStreams=this.mediaHandler.getRemoteStreams.bind(this.mediaHandler),this.getLocalStreams=this.mediaHandler.getLocalStreams.bind(this.mediaHandler)),!d.body||this.renderbody?c.Timers.setTimeout(f,0):(this.hasOffer=!0,this.mediaHandler.setDescription(d.body).then(f,function(a){g.logger.warn("invalid SDP");g.logger.warn(a);
d.reply(488)}))):d.reply(500,"Missing Contact header field")};h.prototype={reject:function(a){if(this.status===b.STATUS_TERMINATED)throw new c.Exceptions.InvalidStateError(this.status);this.logger.log("rejecting RTCSession");c.ServerContext.prototype.reject.call(this,a);return this.terminated()},terminate:function(a){a=a||{};var d=(a.extraHeaders||[]).slice(),e=a.body,f,h=this;this.status===b.STATUS_WAITING_FOR_ACK&&this.request.server_transaction.state!==c.Transactions.C.STATUS_TERMINATED?(f=this.dialog,
this.receiveRequest=function(a){a.method===c.C.ACK&&(this.request(c.C.BYE,{extraHeaders:d,body:e}),f.terminate())},this.request.server_transaction.on("stateChanged",function(){this.state===c.Transactions.C.STATUS_TERMINATED&&(this.request=new c.OutgoingRequest(c.C.BYE,this.dialog.remote_target,this.ua,{cseq:this.dialog.local_seqnum+=1,call_id:this.dialog.id.call_id,from_uri:this.dialog.local_uri,from_tag:this.dialog.id.local_tag,to_uri:this.dialog.remote_uri,to_tag:this.dialog.id.remote_tag,route_set:this.dialog.route_set},
d,e),(new c.RequestSender({request:this.request,onRequestTimeout:function(){h.onRequestTimeout()},onTransportError:function(){h.onTransportError()},receiveResponse:function(){}},this.ua)).send(),f.terminate())}),this.emit("bye",this.request),this.terminated(),this.dialog=f,this.ua.dialogs[f.id.toString()]=f):this.status===b.STATUS_CONFIRMED?this.bye(a):this.reject(a);return this},progress:function(a){function d(){f=a.statusCode||183;this.status=b.STATUS_WAITING_FOR_PRACK;g.push("Contact: "+this.contact);
g.push("Require: 100rel");g.push("RSeq: "+Math.floor(1E4*Math.random()));this.mediaHint=a.media;this.mediaHandler.getDescription(a.media).then(function(a){if(!this.isCanceled&&this.status!==b.STATUS_TERMINATED){this.early_sdp=a;this[this.hasOffer?"hasAnswer":"hasOffer"]=!0;var d=c.Timers.T1;this.timers.rel1xxTimer=c.Timers.setTimeout(function t(){this.request.reply(f,null,g,a);d*=2;this.timers.rel1xxTimer=c.Timers.setTimeout(t.bind(this),d)}.bind(this),d);this.timers.prackTimer=c.Timers.setTimeout(function(){this.status===
b.STATUS_WAITING_FOR_PRACK&&(this.logger.log("no PRACK received, rejecting the call"),c.Timers.clearTimeout(this.timers.rel1xxTimer),this.request.reply(504),this.terminated(null,c.C.causes.NO_PRACK))}.bind(this),64*c.Timers.T1);l=this.request.reply(f,h,g,a);this.emit("progress",l,h)}}.bind(this),function(){this.request.reply(480);this.failed(null,c.C.causes.WEBRTC_ERROR);this.terminated(null,c.C.causes.WEBRTC_ERROR)}.bind(this))}function e(){l=this.request.reply(f,h,g,k);this.emit("progress",l,h)}
a=a||{};var f=a.statusCode||180,h=a.reasonPhrase,g=(a.extraHeaders||[]).slice(),k=a.body,l;if(100>f||199<f)throw new TypeError("Invalid statusCode: "+f);if(this.isCanceled||this.status===b.STATUS_TERMINATED)return this;100!==a.statusCode&&(this.rel100===c.C.supported.REQUIRED||this.rel100===c.C.supported.SUPPORTED&&a.rel100||this.rel100===c.C.supported.SUPPORTED&&this.ua.configuration.rel100===c.C.supported.REQUIRED)?d.apply(this):e.apply(this);return this},accept:function(a){a=Object.create(e.desugar(a));
c.Utils.optionsOverride(a,"media","mediaConstraints",!0,this.logger,this.ua.configuration.media);this.mediaHint=a.media;var d=this,f=this.request,h=(a.extraHeaders||[]).slice();a=function(a){var e;d.mediaHandler.render();h.push("Contact: "+d.contact);h.push("Allow: "+c.Utils.getAllowedMethods(d.ua));d.hasOffer?d.hasAnswer=!0:d.hasOffer=!0;e=f.reply(200,null,h,a,function(){d.status=b.STATUS_WAITING_FOR_ACK;d.setInvite2xxTimer(f,a);d.setACKTimer()},function(){d.failed(null,c.C.causes.CONNECTION_ERROR);
d.terminated(null,c.C.causes.CONNECTION_ERROR)});d.status!==b.STATUS_TERMINATED&&d.accepted(e,c.Utils.getReasonPhrase(200))};var g=function(){d.status!==b.STATUS_TERMINATED&&(d.request.reply(480),d.failed(null,c.C.causes.WEBRTC_ERROR),d.terminated(null,c.C.causes.WEBRTC_ERROR))};if(this.status===b.STATUS_WAITING_FOR_PRACK)return this.status=b.STATUS_ANSWERED_WAITING_FOR_PRACK,this;if(this.status===b.STATUS_WAITING_FOR_ANSWER)this.status=b.STATUS_ANSWERED;else if(this.status!==b.STATUS_EARLY_MEDIA)throw new c.Exceptions.InvalidStateError(this.status);
if(!this.createDialog(f,"UAS"))return f.reply(500,"Missing Contact header field"),this;c.Timers.clearTimeout(this.timers.userNoAnswerTimer);this.status===b.STATUS_EARLY_MEDIA?a():this.mediaHandler.getDescription(d.mediaHint).then(a,g);return this},receiveRequest:function(a){function d(){var d;c.Timers.clearTimeout(this.timers.ackTimer);c.Timers.clearTimeout(this.timers.invite2xxTimer);this.status=b.STATUS_CONFIRMED;this.unmute();d=a.getHeader("Content-Type");"application/sdp"!==d&&(this.renderbody=
a.body,this.rendertype=d)}switch(a.method){case c.C.CANCEL:if(this.status===b.STATUS_WAITING_FOR_ANSWER||this.status===b.STATUS_WAITING_FOR_PRACK||this.status===b.STATUS_ANSWERED_WAITING_FOR_PRACK||this.status===b.STATUS_EARLY_MEDIA||this.status===b.STATUS_ANSWERED)this.status=b.STATUS_CANCELED,this.request.reply(487),this.canceled(a),this.rejected(a,c.C.causes.CANCELED),this.failed(a,c.C.causes.CANCELED),this.terminated(a,c.C.causes.CANCELED);break;case c.C.ACK:this.status===b.STATUS_WAITING_FOR_ACK&&
(this.hasAnswer?d.apply(this):a.body&&"application/sdp"===a.getHeader("content-type")?(c.Hacks.Firefox.cannotHandleExtraWhitespace(a),c.Hacks.AllBrowsers.maskDtls(a),this.hasAnswer=!0,this.mediaHandler.setDescription(a.body).then(d.bind(this),function(b){this.logger.warn(b);this.terminate({statusCode:"488",reasonPhrase:"Bad Media Description"});this.failed(a,c.C.causes.BAD_MEDIA_DESCRIPTION);this.terminated(a,c.C.causes.BAD_MEDIA_DESCRIPTION)}.bind(this))):this.early_sdp?d.apply(this):(this.failed(a,
c.C.causes.BAD_MEDIA_DESCRIPTION),this.terminated(a,c.C.causes.BAD_MEDIA_DESCRIPTION)));break;case c.C.PRACK:this.status===b.STATUS_WAITING_FOR_PRACK||this.status===b.STATUS_ANSWERED_WAITING_FOR_PRACK?this.hasAnswer?(c.Timers.clearTimeout(this.timers.rel1xxTimer),c.Timers.clearTimeout(this.timers.prackTimer),a.reply(200),this.status===b.STATUS_ANSWERED_WAITING_FOR_PRACK&&(this.status=b.STATUS_EARLY_MEDIA,this.accept()),this.status=b.STATUS_EARLY_MEDIA,this.mute()):a.body&&"application/sdp"===a.getHeader("content-type")?
(this.hasAnswer=!0,this.mediaHandler.setDescription(a.body).then(function(){c.Timers.clearTimeout(this.timers.rel1xxTimer);c.Timers.clearTimeout(this.timers.prackTimer);a.reply(200);this.status===b.STATUS_ANSWERED_WAITING_FOR_PRACK&&(this.status=b.STATUS_EARLY_MEDIA,this.accept());this.status=b.STATUS_EARLY_MEDIA;this.mute()}.bind(this),function(b){this.logger.warn(b);this.terminate({statusCode:"488",reasonPhrase:"Bad Media Description"});this.failed(a,c.C.causes.BAD_MEDIA_DESCRIPTION);this.terminated(a,
c.C.causes.BAD_MEDIA_DESCRIPTION)}.bind(this))):(this.terminate({statusCode:"488",reasonPhrase:"Bad Media Description"}),this.failed(a,c.C.causes.BAD_MEDIA_DESCRIPTION),this.terminated(a,c.C.causes.BAD_MEDIA_DESCRIPTION)):this.status===b.STATUS_EARLY_MEDIA&&a.reply(200);break;default:e.prototype.receiveRequest.apply(this,[a])}},onTransportError:function(){this.status!==b.STATUS_CONFIRMED&&this.status!==b.STATUS_TERMINATED&&this.failed(null,c.C.causes.CONNECTION_ERROR)},onRequestTimeout:function(){this.status===
b.STATUS_CONFIRMED?this.terminated(null,c.C.causes.REQUEST_TIMEOUT):this.status!==b.STATUS_TERMINATED&&(this.failed(null,c.C.causes.REQUEST_TIMEOUT),this.terminated(null,c.C.causes.REQUEST_TIMEOUT))}};c.InviteServerContext=h;h=function(a,d,f){f=Object.create(e.desugar(f));f.params=Object.create(f.params||Object.prototype);var h=(f.extraHeaders||[]).slice(),g=f.stunServers||null,k=f.turnServers||null,l=a.configuration.mediaHandlerFactory.isSupported;if(l&&!l())throw new c.Exceptions.NotSupportedError("Media not supported");
this.RTCConstraints=f.RTCConstraints||{};this.inviteWithoutSdp=f.inviteWithoutSdp||!1;this.anonymous=f.anonymous||!1;this.renderbody=f.renderbody||null;this.rendertype=f.rendertype||"text/plain";f.params.from_tag=this.from_tag;this.contact=a.contact.toString({anonymous:this.anonymous,outbound:this.anonymous?!a.contact.temp_gruu:!a.contact.pub_gruu});this.anonymous&&(f.params.from_displayName="Anonymous",f.params.from_uri="sip:anonymous@anonymous.invalid",h.push("P-Preferred-Identity: "+a.configuration.uri.toString()),
h.push("Privacy: id"));h.push("Contact: "+this.contact);h.push("Allow: "+c.Utils.getAllowedMethods(a));this.inviteWithoutSdp?this.renderbody&&(h.push("Content-Type: "+this.rendertype),h.push("Content-Disposition: render;handling=optional")):h.push("Content-Type: application/sdp");a.configuration.rel100===c.C.supported.REQUIRED&&h.push("Require: 100rel");a.configuration.replaces===c.C.supported.REQUIRED&&h.push("Require: replaces");f.extraHeaders=h;c.Utils.augment(this,c.ClientContext,[a,c.C.INVITE,
d,f]);c.Utils.augment(this,c.Session,[a.configuration.mediaHandlerFactory]);if(this.status!==b.STATUS_NULL)throw new c.Exceptions.InvalidStateError(this.status);this.from_tag=c.Utils.newTag();this.received_100=this.isCanceled=!1;this.method=c.C.INVITE;this.receiveNonInviteResponse=this.receiveResponse;this.receiveResponse=this.receiveInviteResponse;this.logger=a.getLogger("sip.inviteclientcontext");if(g)if(d=c.UA.configuration_check.optional.stunServers(g))this.stunServers=d;else throw new TypeError("Invalid stunServers: "+
g);if(k)if(d=c.UA.configuration_check.optional.turnServers(k))this.turnServers=d;else throw new TypeError("Invalid turnServers: "+k);a.applicants[this]=this;this.id=this.request.call_id+this.from_tag;(this.mediaHandler=this.mediaHandlerFactory(this,{RTCConstraints:this.RTCConstraints,stunServers:this.stunServers,turnServers:this.turnServers}))&&this.mediaHandler.getRemoteStreams&&(this.getRemoteStreams=this.mediaHandler.getRemoteStreams.bind(this.mediaHandler),this.getLocalStreams=this.mediaHandler.getLocalStreams.bind(this.mediaHandler));
c.Utils.optionsOverride(f,"media","mediaConstraints",!0,this.logger,this.ua.configuration.media);this.mediaHint=f.media};h.prototype={invite:function(){var a=this;this.ua.sessions[this.id]=this;this.inviteWithoutSdp?(this.request.body=a.renderbody,this.status=b.STATUS_INVITE_SENT,this.send()):this.mediaHandler.getDescription(a.mediaHint).then(function(c){a.isCanceled||a.status===b.STATUS_TERMINATED||(a.hasOffer=!0,a.request.body=c,a.status=b.STATUS_INVITE_SENT,a.send())},function(){a.status!==b.STATUS_TERMINATED&&
(a.failed(null,c.C.causes.WEBRTC_ERROR),a.terminated(null,c.C.causes.WEBRTC_ERROR))});return this},receiveInviteResponse:function(a){var d,e=this;d=a.call_id+a.from_tag+a.to_tag;var f=[],h={};if(this.status!==b.STATUS_TERMINATED&&a.method===c.C.INVITE){if(this.dialog&&200<=a.status_code&&299>=a.status_code){if(d!==this.dialog.id.toString()){if(!this.createDialog(a,"UAC",!0))return;this.earlyDialogs[d].sendRequest(this,c.C.ACK,{body:c.Utils.generateFakeSDP(a.body)});this.earlyDialogs[d].sendRequest(this,
c.C.BYE);this.status!==b.STATUS_CONFIRMED&&(this.failed(a,c.C.causes.WEBRTC_ERROR),this.terminated(a,c.C.causes.WEBRTC_ERROR));return}if(this.status===b.STATUS_CONFIRMED){this.sendRequest(c.C.ACK,{cseq:a.cseq});return}if(!this.hasAnswer)return}if(this.dialog&&200>a.status_code)-1!==this.dialog.pracked.indexOf(a.getHeader("rseq"))||this.dialog.pracked[this.dialog.pracked.length-1]>=a.getHeader("rseq")&&0<this.dialog.pracked.length||!this.earlyDialogs[d]&&!this.createDialog(a,"UAC",!0)||-1!==this.earlyDialogs[d].pracked.indexOf(a.getHeader("rseq"))||
this.earlyDialogs[d].pracked[this.earlyDialogs[d].pracked.length-1]>=a.getHeader("rseq")&&0<this.earlyDialogs[d].pracked.length||(f.push("RAck: "+a.getHeader("rseq")+" "+a.getHeader("cseq")),this.earlyDialogs[d].pracked.push(a.getHeader("rseq")),this.earlyDialogs[d].sendRequest(this,c.C.PRACK,{extraHeaders:f,body:c.Utils.generateFakeSDP(a.body)}));else if(this.isCanceled)100<=a.status_code&&200>a.status_code?(this.request.cancel(this.cancelReason),this.canceled(null)):200<=a.status_code&&299>a.status_code?
(this.acceptAndTerminate(a),this.emit("bye",this.request)):300<=a.status_code&&(d=c.C.REASON_PHRASE[a.status_code]||c.C.causes.CANCELED,this.rejected(a,d),this.failed(a,d),this.terminated(a,d));else switch(!0){case /^100$/.test(a.status_code):this.received_100=!0;this.emit("progress",a);break;case /^1[0-9]{2}$/.test(a.status_code):if(!a.to_tag){this.logger.warn("1xx response received without to tag");break}if(a.hasHeader("contact")&&!this.createDialog(a,"UAC",!0))break;this.status=b.STATUS_1XX_RECEIVED;
if(a.hasHeader("require")&&-1!==a.getHeader("require").indexOf("100rel")){if(this.dialog||!this.earlyDialogs[d])break;if(-1!==this.earlyDialogs[d].pracked.indexOf(a.getHeader("rseq"))||this.earlyDialogs[d].pracked[this.earlyDialogs[d].pracked.length-1]>=a.getHeader("rseq")&&0<this.earlyDialogs[d].pracked.length)break;c.Hacks.Firefox.cannotHandleExtraWhitespace(a);c.Hacks.AllBrowsers.maskDtls(a);if(a.body)if(this.hasOffer){if(!this.createDialog(a,"UAC"))break;this.hasAnswer=!0;this.dialog.pracked.push(a.getHeader("rseq"));
this.mediaHandler.setDescription(a.body).then(function(){f.push("RAck: "+a.getHeader("rseq")+" "+a.getHeader("cseq"));e.sendRequest(c.C.PRACK,{extraHeaders:f,receiveResponse:function(){}});e.status=b.STATUS_EARLY_MEDIA;e.mute();e.emit("progress",a)},function(b){e.logger.warn(b);e.acceptAndTerminate(a,488,"Not Acceptable Here");e.failed(a,c.C.causes.BAD_MEDIA_DESCRIPTION)})}else{var g=this.earlyDialogs[d];d=g.mediaHandler;g.pracked.push(a.getHeader("rseq"));d.setDescription(a.body).then(d.getDescription.bind(d,
e.mediaHint)).then(function(d){f.push("Content-Type: application/sdp");f.push("RAck: "+a.getHeader("rseq")+" "+a.getHeader("cseq"));g.sendRequest(e,c.C.PRACK,{extraHeaders:f,body:d});e.status=b.STATUS_EARLY_MEDIA;e.emit("progress",a)}).catch(function(d){d instanceof c.Exceptions.GetDescriptionError?(g.pracked.push(a.getHeader("rseq")),e.status!==b.STATUS_TERMINATED&&(e.failed(null,c.C.causes.WEBRTC_ERROR),e.terminated(null,c.C.causes.WEBRTC_ERROR))):(g.pracked.splice(g.pracked.indexOf(a.getHeader("rseq")),
1),e.logger.warn("invalid SDP"),e.logger.warn(d))})}else f.push("RAck: "+a.getHeader("rseq")+" "+a.getHeader("cseq")),this.earlyDialogs[d].pracked.push(a.getHeader("rseq")),this.earlyDialogs[d].sendRequest(this,c.C.PRACK,{extraHeaders:f}),this.emit("progress",a)}else this.emit("progress",a);break;case /^2[0-9]{2}$/.test(a.status_code):if(this.request.cseq+" "+this.request.method!==a.getHeader("cseq"))break;if(this.status===b.STATUS_EARLY_MEDIA&&this.dialog){this.status=b.STATUS_CONFIRMED;this.unmute();
h={};this.renderbody&&(f.push("Content-Type: "+this.rendertype),h.extraHeaders=f,h.body=this.renderbody);h.cseq=a.cseq;this.sendRequest(c.C.ACK,h);this.accepted(a);break}if(this.dialog)break;c.Hacks.Firefox.cannotHandleExtraWhitespace(a);c.Hacks.AllBrowsers.maskDtls(a);if(this.hasOffer)if(this.hasAnswer)this.renderbody&&(f.push("Content-Type: "+e.rendertype),h.extraHeaders=f,h.body=this.renderbody),this.sendRequest(c.C.ACK,h);else{if(!a.body){this.acceptAndTerminate(a,400,"Missing session description");
this.failed(a,c.C.causes.BAD_MEDIA_DESCRIPTION);break}if(!this.createDialog(a,"UAC"))break;this.hasAnswer=!0;this.mediaHandler.setDescription(a.body).then(function(){var d={};e.status=b.STATUS_CONFIRMED;e.unmute();e.renderbody&&(f.push("Content-Type: "+e.rendertype),d.extraHeaders=f,d.body=e.renderbody);d.cseq=a.cseq;e.sendRequest(c.C.ACK,d);e.accepted(a)},function(b){e.logger.warn(b);e.acceptAndTerminate(a,488,"Not Acceptable Here");e.failed(a,c.C.causes.BAD_MEDIA_DESCRIPTION)})}else if(this.earlyDialogs[d]&&
this.earlyDialogs[d].mediaHandler.localMedia){this.hasAnswer=this.hasOffer=!0;this.mediaHandler=this.earlyDialogs[d].mediaHandler;if(!this.createDialog(a,"UAC"))break;this.status=b.STATUS_CONFIRMED;this.sendRequest(c.C.ACK,{cseq:a.cseq});this.unmute();this.accepted(a)}else{if(!a.body){this.acceptAndTerminate(a,400,"Missing session description");this.failed(a,c.C.causes.BAD_MEDIA_DESCRIPTION);break}if(!this.createDialog(a,"UAC"))break;this.hasOffer=!0;this.mediaHandler.setDescription(a.body).then(this.mediaHandler.getDescription.bind(this.mediaHandler,
this.mediaHint)).then(function(d){e.isCanceled||e.status===b.STATUS_TERMINATED||(d=c.Hacks.Firefox.hasMissingCLineInSDP(d),e.status=b.STATUS_CONFIRMED,e.hasAnswer=!0,e.unmute(),e.sendRequest(c.C.ACK,{body:d,extraHeaders:["Content-Type: application/sdp"],cseq:a.cseq}),e.accepted(a))}).catch(function(b){b instanceof c.Exceptions.GetDescriptionError?e.logger.warn("there was a problem"):(e.logger.warn("invalid SDP"),e.logger.warn(b),a.reply(488))})}break;default:d=c.Utils.sipErrorCause(a.status_code),
this.rejected(a,d),this.failed(a,d),this.terminated(a,d)}}},cancel:function(a){a=a||{};if(this.status===b.STATUS_TERMINATED||this.status===b.STATUS_CONFIRMED)throw new c.Exceptions.InvalidStateError(this.status);this.logger.log("canceling RTCSession");a=c.Utils.getCancelReason(a.status_code,a.reason_phrase);try{this.request.cancel(a)}catch(d){}return this.canceled()},terminate:function(a){if(this.status===b.STATUS_TERMINATED)return this;this.status===b.STATUS_WAITING_FOR_ACK||this.status===b.STATUS_CONFIRMED?
this.bye(a):this.cancel(a);return this},receiveRequest:function(a){a.method===c.C.ACK&&this.status===b.STATUS_WAITING_FOR_ACK&&(c.Timers.clearTimeout(this.timers.ackTimer),c.Timers.clearTimeout(this.timers.invite2xxTimer),this.status=b.STATUS_CONFIRMED,this.unmute(),this.accepted());return e.prototype.receiveRequest.apply(this,[a])},onTransportError:function(){this.status!==b.STATUS_CONFIRMED&&this.status!==b.STATUS_TERMINATED&&this.failed(null,c.C.causes.CONNECTION_ERROR)},onRequestTimeout:function(){this.status===
b.STATUS_CONFIRMED?this.terminated(null,c.C.causes.REQUEST_TIMEOUT):this.status!==b.STATUS_TERMINATED&&(this.failed(null,c.C.causes.REQUEST_TIMEOUT),this.terminated(null,c.C.causes.REQUEST_TIMEOUT))}};c.InviteClientContext=h}},{"./Session/DTMF":58}],58:[function(k,l,n){l.exports=function(c){var g;g=function(f,e,h){if(void 0===e)throw new TypeError("Not enough arguments");this.logger=f.ua.getLogger("sip.invitecontext.dtmf",f.id);this.owner=f;this.direction=null;h=h||{};f=h.duration||null;h=h.interToneGap||
null;if("string"===typeof e)e=e.toUpperCase();else if("number"===typeof e)e=e.toString();else throw new TypeError("Invalid tone: "+e);if(e.match(/^[0-9A-D#*]$/))this.tone=e;else throw new TypeError("Invalid tone: "+e);if(f&&!c.Utils.isDecimal(f))throw new TypeError("Invalid tone duration: "+f);f?f<g.C.MIN_DURATION?(this.logger.warn('"duration" value is lower than the minimum allowed, setting it to '+g.C.MIN_DURATION+" milliseconds"),f=g.C.MIN_DURATION):f>g.C.MAX_DURATION?(this.logger.warn('"duration" value is greater than the maximum allowed, setting it to '+
g.C.MAX_DURATION+" milliseconds"),f=g.C.MAX_DURATION):f=Math.abs(f):f=g.C.DEFAULT_DURATION;this.duration=f;if(h&&!c.Utils.isDecimal(h))throw new TypeError("Invalid interToneGap: "+h);h?h<g.C.MIN_INTER_TONE_GAP?(this.logger.warn('"interToneGap" value is lower than the minimum allowed, setting it to '+g.C.MIN_INTER_TONE_GAP+" milliseconds"),h=g.C.MIN_INTER_TONE_GAP):h=Math.abs(h):h=g.C.DEFAULT_INTER_TONE_GAP;this.interToneGap=h};g.prototype=Object.create(c.EventEmitter.prototype);g.prototype.send=function(f){var e;
this.direction="outgoing";if(this.owner.status!==c.Session.C.STATUS_CONFIRMED&&this.owner.status!==c.Session.C.STATUS_WAITING_FOR_ACK)throw new c.Exceptions.InvalidStateError(this.owner.status);f=f||{};f=f.extraHeaders?f.extraHeaders.slice():[];f.push("Content-Type: application/dtmf-relay");e="Signal= "+this.tone+"\r\n";e+="Duration= "+this.duration;this.request=this.owner.dialog.sendRequest(this,c.C.INFO,{extraHeaders:f,body:e});this.owner.emit("dtmf",this.request,this)};g.prototype.receiveResponse=
function(f){var e;switch(!0){case /^1[0-9]{2}$/.test(f.status_code):break;case /^2[0-9]{2}$/.test(f.status_code):this.emit("succeeded",{originator:"remote",response:f});break;default:e=c.Utils.sipErrorCause(f.status_code),this.emit("failed",f,e)}};g.prototype.onRequestTimeout=function(){this.emit("failed",null,c.C.causes.REQUEST_TIMEOUT);this.owner.onRequestTimeout()};g.prototype.onTransportError=function(){this.emit("failed",null,c.C.causes.CONNECTION_ERROR);this.owner.onTransportError()};g.prototype.onDialogError=
function(f){this.emit("failed",f,c.C.causes.DIALOG_ERROR);this.owner.onDialogError(f)};g.prototype.init_incoming=function(c){this.direction="incoming";this.request=c;c.reply(200);this.tone&&this.duration?this.owner.emit("dtmf",c,this):this.logger.warn("invalid INFO DTMF received, discarded")};g.C={MIN_DURATION:70,MAX_DURATION:6E3,DEFAULT_DURATION:100,MIN_INTER_TONE_GAP:50,DEFAULT_INTER_TONE_GAP:500};return g}},{}],59:[function(k,l,n){l.exports=function(c){c.Subscription=function(g,f,e,h){h=Object.create(h||
Object.prototype);this.extraHeaders=h.extraHeaders=(h.extraHeaders||[]).slice();this.id=null;this.state="init";if(e)this.event=e;else throw new TypeError("Event necessary to create a subscription.");"number"!==typeof h.expires?(g.logger.warn("expires must be a number. Using default of 3600."),this.expires=3600):this.expires=h.expires;h.extraHeaders.push("Event: "+this.event);h.extraHeaders.push("Expires: "+this.expires);h.body&&(this.body=h.body);this.contact=g.contact.toString();h.extraHeaders.push("Contact: "+
this.contact);h.extraHeaders.push("Allow: "+c.Utils.getAllowedMethods(g));c.Utils.augment(this,c.ClientContext,[g,c.C.SUBSCRIBE,f,h]);this.logger=g.getLogger("sip.subscription");this.dialog=null;this.timers={N:null,sub_duration:null};this.errorCodes=[404,405,410,416,480,481,482,483,484,485,489,501,604]};c.Subscription.prototype={subscribe:function(){c.Timers.clearTimeout(this.timers.sub_duration);c.Timers.clearTimeout(this.timers.N);this.timers.N=c.Timers.setTimeout(this.timer_fire.bind(this),c.Timers.TIMER_N);
this.send();this.state="notify_wait";return this},refresh:function(){"terminated"!==this.state&&"pending"!==this.state&&"notify_wait"!==this.state&&this.dialog.sendRequest(this,c.C.SUBSCRIBE,{extraHeaders:this.extraHeaders,body:this.body})},receiveResponse:function(g){var f,e=c.Utils.getReasonPhrase(g.status_code);-1!==this.errorCodes.indexOf(g.status_code)?this.failed(g,null):/^2[0-9]{2}$/.test(g.status_code)&&(f=g.getHeader("Expires"),c.Timers.clearTimeout(this.timers.N),this.createConfirmedDialog(g,
"UAC")&&(this.id=this.dialog.id.toString(),this.ua.subscriptions[this.id]=this,this.emit("accepted",g,e)),f&&f<=this.expires?this.timers.sub_duration=c.Timers.setTimeout(this.refresh.bind(this),900*f):f?(this.logger.warn("Expires header in a 200-class response to SUBSCRIBE with a higher value than the one in the request"),this.failed(g,c.C.INVALID_EXPIRES_HEADER)):(this.logger.warn("Expires header missing in a 200-class response to SUBSCRIBE"),this.failed(g,c.C.EXPIRES_HEADER_MISSING)))},unsubscribe:function(){var g=
[];this.state="terminated";g.push("Event: "+this.event);g.push("Expires: 0");g.push("Contact: "+this.contact);g.push("Allow: "+c.Utils.getAllowedMethods(this.ua));this.request=new c.OutgoingRequest(this.method,this.request.to.uri.toString(),this.ua,null,g);this.receiveResponse=function(){};c.Timers.clearTimeout(this.timers.sub_duration);c.Timers.clearTimeout(this.timers.N);this.timers.N=c.Timers.setTimeout(this.timer_fire.bind(this),c.Timers.TIMER_N);this.send()},timer_fire:function(){"terminated"===
this.state?this.close():"pending"===this.state||"notify_wait"===this.state?(this.state="terminated",this.close()):this.refresh()},close:function(){"terminated"!==this.state&&this.unsubscribe();this.terminateDialog();c.Timers.clearTimeout(this.timers.N);c.Timers.clearTimeout(this.timers.sub_duration);delete this.ua.subscriptions[this.id]},createConfirmedDialog:function(g,f){var e;this.terminateDialog();e=new c.Dialog(this,g,f);if(e.error)return!1;this.dialog=e;return!0},terminateDialog:function(){this.dialog&&
(delete this.ua.subscriptions[this.id],this.dialog.terminate(),delete this.dialog)},receiveRequest:function(g){function f(){e.expires&&(e.expires=Math.min(h.expires,Math.max(e.expires,0)),h.timers.sub_duration=c.Timers.setTimeout(h.refresh.bind(h),900*e.expires))}var e,h=this;if(this.matchEvent(g))switch(e=g.parseHeader("Subscription-State"),g.reply(200,c.C.REASON_200),c.Timers.clearTimeout(this.timers.N),c.Timers.clearTimeout(this.timers.sub_duration),this.emit("notify",{request:g}),e.state){case "active":this.state=
"active";f();break;case "pending":"notify_wait"===this.state&&f();this.state="pending";break;case "terminated":if(e.reason)switch(this.logger.log("terminating subscription with reason "+e.reason),e.reason){case "deactivated":case "timeout":this.subscribe();return;case "probation":case "giveup":e.params&&e.params["retry-after"]?this.timers.sub_duration=c.Timers.setTimeout(h.subscribe.bind(h),e.params["retry-after"]):this.subscribe();return}this.close()}else g.reply(489)},failed:function(c,f){this.close();
this.emit("failed",c,f);return this},matchEvent:function(c){var f;if(!c.hasHeader("Event"))return this.logger.warn("missing Event header"),!1;if(!c.hasHeader("Subscription-State"))return this.logger.warn("missing Subscription-State header"),!1;f=c.parseHeader("event").event;return this.event!==f?(this.logger.warn("event match failed"),c.reply(481,"Event Match Failed"),!1):!0}}}},{}],60:[function(k,l,n){l.exports=function(c){var g={T1:500,T2:4E3,T4:5E3,TIMER_B:32E3,TIMER_D:0,TIMER_F:32E3,TIMER_H:32E3,
TIMER_I:0,TIMER_J:0,TIMER_K:0,TIMER_L:32E3,TIMER_M:32E3,TIMER_N:32E3,PROVISIONAL_RESPONSE_INTERVAL:6E4};["setTimeout","clearTimeout","setInterval","clearInterval"].forEach(function(f){g[f]=function(){return c[f].apply(c,arguments)}});return g}},{}],61:[function(k,l,n){l.exports=function(c){var g={STATUS_TRYING:1,STATUS_PROCEEDING:2,STATUS_CALLING:3,STATUS_ACCEPTED:4,STATUS_COMPLETED:5,STATUS_TERMINATED:6,STATUS_CONFIRMED:7,NON_INVITE_CLIENT:"nict",NON_INVITE_SERVER:"nist",INVITE_CLIENT:"ict",INVITE_SERVER:"ist"},
f=function(a,b,c){this.type=g.NON_INVITE_CLIENT;this.transport=c;this.id="z9hG4bK"+Math.floor(1E7*Math.random());this.request_sender=a;this.request=b;this.logger=a.ua.getLogger("sip.transaction.nict",this.id);b="SIP/2.0/"+(a.ua.configuration.hackViaTcp?"TCP":c.server.scheme);b+=" "+a.ua.configuration.viaHost+";branch="+this.id;this.request.setHeader("via",b);this.request_sender.ua.newTransaction(this)};f.prototype=Object.create(c.EventEmitter.prototype);f.prototype.stateChanged=function(a){this.state=
a;this.emit("stateChanged")};f.prototype.send=function(){this.stateChanged(g.STATUS_TRYING);this.F=c.Timers.setTimeout(this.timer_F.bind(this),c.Timers.TIMER_F);if(!this.transport.send(this.request))this.onTransportError()};f.prototype.onTransportError=function(){this.logger.log("transport error occurred, deleting non-INVITE client transaction "+this.id);c.Timers.clearTimeout(this.F);c.Timers.clearTimeout(this.K);this.stateChanged(g.STATUS_TERMINATED);this.request_sender.ua.destroyTransaction(this);
this.request_sender.onTransportError()};f.prototype.timer_F=function(){this.logger.log("Timer F expired for non-INVITE client transaction "+this.id);this.stateChanged(g.STATUS_TERMINATED);this.request_sender.ua.destroyTransaction(this);this.request_sender.onRequestTimeout()};f.prototype.timer_K=function(){this.stateChanged(g.STATUS_TERMINATED);this.request_sender.ua.destroyTransaction(this)};f.prototype.receiveResponse=function(a){var b=a.status_code;if(200>b)switch(this.state){case g.STATUS_TRYING:case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_PROCEEDING),
this.request_sender.receiveResponse(a)}else switch(this.state){case g.STATUS_TRYING:case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_COMPLETED);c.Timers.clearTimeout(this.F);if(408===b)this.request_sender.onRequestTimeout();else this.request_sender.receiveResponse(a);this.K=c.Timers.setTimeout(this.timer_K.bind(this),c.Timers.TIMER_K)}};var e=function(a,b,c){var e=this;this.type=g.INVITE_CLIENT;this.transport=c;this.id="z9hG4bK"+Math.floor(1E7*Math.random());this.request_sender=a;this.request=
b;this.logger=a.ua.getLogger("sip.transaction.ict",this.id);b="SIP/2.0/"+(a.ua.configuration.hackViaTcp?"TCP":c.server.scheme);b+=" "+a.ua.configuration.viaHost+";branch="+this.id;this.request.setHeader("via",b);this.request_sender.ua.newTransaction(this);this.request.cancel=function(a){e.cancel_request(e,a)}};e.prototype=Object.create(c.EventEmitter.prototype);e.prototype.stateChanged=function(a){this.state=a;this.emit("stateChanged")};e.prototype.send=function(){this.stateChanged(g.STATUS_CALLING);
this.B=c.Timers.setTimeout(this.timer_B.bind(this),c.Timers.TIMER_B);if(!this.transport.send(this.request))this.onTransportError()};e.prototype.onTransportError=function(){this.logger.log("transport error occurred, deleting INVITE client transaction "+this.id);c.Timers.clearTimeout(this.B);c.Timers.clearTimeout(this.D);c.Timers.clearTimeout(this.M);this.stateChanged(g.STATUS_TERMINATED);this.request_sender.ua.destroyTransaction(this);if(this.state!==g.STATUS_ACCEPTED)this.request_sender.onTransportError()};
e.prototype.timer_M=function(){this.logger.log("Timer M expired for INVITE client transaction "+this.id);this.state===g.STATUS_ACCEPTED&&(c.Timers.clearTimeout(this.B),this.stateChanged(g.STATUS_TERMINATED),this.request_sender.ua.destroyTransaction(this))};e.prototype.timer_B=function(){this.logger.log("Timer B expired for INVITE client transaction "+this.id);this.state===g.STATUS_CALLING&&(this.stateChanged(g.STATUS_TERMINATED),this.request_sender.ua.destroyTransaction(this),this.request_sender.onRequestTimeout())};
e.prototype.timer_D=function(){this.logger.log("Timer D expired for INVITE client transaction "+this.id);c.Timers.clearTimeout(this.B);this.stateChanged(g.STATUS_TERMINATED);this.request_sender.ua.destroyTransaction(this)};e.prototype.sendACK=function(a){this.ack="ACK "+this.request.ruri+" SIP/2.0\r\n";this.ack+="Via: "+this.request.headers.Via.toString()+"\r\n";this.request.headers.Route&&(this.ack+="Route: "+this.request.headers.Route.toString()+"\r\n");this.ack+="To: "+a.getHeader("to")+"\r\n";
this.ack+="From: "+this.request.headers.From.toString()+"\r\n";this.ack+="Call-ID: "+this.request.headers["Call-ID"].toString()+"\r\n";this.ack+="Content-Length: 0\r\n";this.ack+="CSeq: "+this.request.headers.CSeq.toString().split(" ")[0];this.ack+=" ACK\r\n\r\n";this.D=c.Timers.setTimeout(this.timer_D.bind(this),c.Timers.TIMER_D);this.transport.send(this.ack)};e.prototype.cancel_request=function(a,b){var e=a.request;this.cancel=c.C.CANCEL+" "+e.ruri+" SIP/2.0\r\n";this.cancel+="Via: "+e.headers.Via.toString()+
"\r\n";this.request.headers.Route&&(this.cancel+="Route: "+e.headers.Route.toString()+"\r\n");this.cancel+="To: "+e.headers.To.toString()+"\r\n";this.cancel+="From: "+e.headers.From.toString()+"\r\n";this.cancel+="Call-ID: "+e.headers["Call-ID"].toString()+"\r\n";this.cancel+="CSeq: "+e.headers.CSeq.toString().split(" ")[0]+" CANCEL\r\n";b&&(this.cancel+="Reason: "+b+"\r\n");this.cancel+="Content-Length: 0\r\n\r\n";this.state===g.STATUS_PROCEEDING&&this.transport.send(this.cancel)};e.prototype.receiveResponse=
function(a){var b=a.status_code;if(100<=b&&199>=b)switch(this.state){case g.STATUS_CALLING:this.stateChanged(g.STATUS_PROCEEDING);this.request_sender.receiveResponse(a);this.cancel&&this.transport.send(this.cancel);break;case g.STATUS_PROCEEDING:this.request_sender.receiveResponse(a)}else if(200<=b&&299>=b)switch(this.state){case g.STATUS_CALLING:case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_ACCEPTED);this.M=c.Timers.setTimeout(this.timer_M.bind(this),c.Timers.TIMER_M);this.request_sender.receiveResponse(a);
break;case g.STATUS_ACCEPTED:this.request_sender.receiveResponse(a)}else if(300<=b&&699>=b)switch(this.state){case g.STATUS_CALLING:case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_COMPLETED);this.sendACK(a);this.request_sender.receiveResponse(a);break;case g.STATUS_COMPLETED:this.sendACK(a)}};var h=function(a,b,c){this.transport=c;this.id="z9hG4bK"+Math.floor(1E7*Math.random());this.request_sender=a;this.request=b;this.logger=a.ua.getLogger("sip.transaction.nict",this.id);b="SIP/2.0/"+(a.ua.configuration.hackViaTcp?
"TCP":c.server.scheme);b+=" "+a.ua.configuration.viaHost+";branch="+this.id;this.request.setHeader("via",b)};h.prototype=Object.create(c.EventEmitter.prototype);h.prototype.send=function(){if(!this.transport.send(this.request))this.onTransportError()};h.prototype.onTransportError=function(){this.logger.log("transport error occurred, for an ACK client transaction "+this.id);this.request_sender.onTransportError()};var b=function(a,b){this.type=g.NON_INVITE_SERVER;this.id=a.via_branch;this.request=a;
this.transport=a.transport;this.ua=b;this.last_response="";a.server_transaction=this;this.logger=b.getLogger("sip.transaction.nist",this.id);this.state=g.STATUS_TRYING;b.newTransaction(this)};b.prototype=Object.create(c.EventEmitter.prototype);b.prototype.stateChanged=function(a){this.state=a;this.emit("stateChanged")};b.prototype.timer_J=function(){this.logger.log("Timer J expired for non-INVITE server transaction "+this.id);this.stateChanged(g.STATUS_TERMINATED);this.ua.destroyTransaction(this)};
b.prototype.onTransportError=function(){this.transportError||(this.transportError=!0,this.logger.log("transport error occurred, deleting non-INVITE server transaction "+this.id),c.Timers.clearTimeout(this.J),this.stateChanged(g.STATUS_TERMINATED),this.ua.destroyTransaction(this))};b.prototype.receiveResponse=function(a,b){var e=c.Utils.defer();if(100===a)switch(this.state){case g.STATUS_TRYING:this.stateChanged(g.STATUS_PROCEEDING);if(!this.transport.send(b))this.onTransportError();break;case g.STATUS_PROCEEDING:this.last_response=
b,this.transport.send(b)?e.resolve():(this.onTransportError(),e.reject())}else if(200<=a&&699>=a)switch(this.state){case g.STATUS_TRYING:case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_COMPLETED),this.last_response=b,this.J=c.Timers.setTimeout(this.timer_J.bind(this),c.Timers.TIMER_J),this.transport.send(b)?e.resolve():(this.onTransportError(),e.reject())}return e.promise};var a=function(a,b){this.type=g.INVITE_SERVER;this.id=a.via_branch;this.request=a;this.transport=a.transport;this.ua=b;this.last_response=
"";a.server_transaction=this;this.logger=b.getLogger("sip.transaction.ist",this.id);this.state=g.STATUS_PROCEEDING;b.newTransaction(this);this.resendProvisionalTimer=null;a.reply(100)};a.prototype=Object.create(c.EventEmitter.prototype);a.prototype.stateChanged=function(a){this.state=a;this.emit("stateChanged")};a.prototype.timer_H=function(){this.logger.log("Timer H expired for INVITE server transaction "+this.id);this.state===g.STATUS_COMPLETED&&this.logger.warn("transactions","ACK for INVITE server transaction was never received, call will be terminated");
this.stateChanged(g.STATUS_TERMINATED);this.ua.destroyTransaction(this)};a.prototype.timer_I=function(){this.stateChanged(g.STATUS_TERMINATED);this.ua.destroyTransaction(this)};a.prototype.timer_L=function(){this.logger.log("Timer L expired for INVITE server transaction "+this.id);this.state===g.STATUS_ACCEPTED&&(this.stateChanged(g.STATUS_TERMINATED),this.ua.destroyTransaction(this))};a.prototype.onTransportError=function(){this.transportError||(this.transportError=!0,this.logger.log("transport error occurred, deleting INVITE server transaction "+
this.id),null!==this.resendProvisionalTimer&&(c.Timers.clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),c.Timers.clearTimeout(this.L),c.Timers.clearTimeout(this.H),c.Timers.clearTimeout(this.I),this.stateChanged(g.STATUS_TERMINATED),this.ua.destroyTransaction(this))};a.prototype.resend_provisional=function(){if(!this.transport.send(this.last_response))this.onTransportError()};a.prototype.receiveResponse=function(a,b){var e=c.Utils.defer();if(100<=a&&199>=a)switch(this.state){case g.STATUS_PROCEEDING:if(!this.transport.send(b))this.onTransportError();
this.last_response=b}if(100<a&&199>=a&&this.state===g.STATUS_PROCEEDING)null===this.resendProvisionalTimer&&(this.resendProvisionalTimer=c.Timers.setInterval(this.resend_provisional.bind(this),c.Timers.PROVISIONAL_RESPONSE_INTERVAL));else if(200<=a&&299>=a)switch(this.state){case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_ACCEPTED),this.last_response=b,this.L=c.Timers.setTimeout(this.timer_L.bind(this),c.Timers.TIMER_L),null!==this.resendProvisionalTimer&&(c.Timers.clearInterval(this.resendProvisionalTimer),
this.resendProvisionalTimer=null);case g.STATUS_ACCEPTED:this.transport.send(b)?e.resolve():(this.onTransportError(),e.reject())}else if(300<=a&&699>=a)switch(this.state){case g.STATUS_PROCEEDING:null!==this.resendProvisionalTimer&&(c.Timers.clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),this.transport.send(b)?(this.stateChanged(g.STATUS_COMPLETED),this.H=c.Timers.setTimeout(this.timer_H.bind(this),c.Timers.TIMER_H),e.resolve()):(this.onTransportError(),e.reject())}return e.promise};
c.Transactions={C:g,checkTransaction:function(a,b){var e;switch(b.method){case c.C.INVITE:if(e=a.transactions.ist[b.via_branch]){switch(e.state){case g.STATUS_PROCEEDING:e.transport.send(e.last_response)}return!0}break;case c.C.ACK:if(e=a.transactions.ist[b.via_branch]){if(e.state===g.STATUS_ACCEPTED)return!1;if(e.state===g.STATUS_COMPLETED)return e.state=g.STATUS_CONFIRMED,e.I=c.Timers.setTimeout(e.timer_I.bind(e),c.Timers.TIMER_I),!0}else return!1;break;case c.C.CANCEL:if(e=a.transactions.ist[b.via_branch])return b.reply_sl(200),
e.state===g.STATUS_PROCEEDING?!1:!0;b.reply_sl(481);return!0;default:if(e=a.transactions.nist[b.via_branch]){switch(e.state){case g.STATUS_PROCEEDING:case g.STATUS_COMPLETED:e.transport.send(e.last_response)}return!0}}},NonInviteClientTransaction:f,InviteClientTransaction:e,AckClientTransaction:h,NonInviteServerTransaction:b,InviteServerTransaction:a}}},{}],62:[function(k,l,n){l.exports=function(c,g){var f;f=function(c,f){this.logger=c.getLogger("sip.transport");this.ua=c;this.ws=null;this.server=
f;this.reconnection_attempts=0;this.connected=this.closed=!1;this.reconnectTimer=null;this.lastTransportError={};this.ua.transport=this;this.connect()};f.prototype={send:function(c){c=c.toString();if(this.ws&&this.ws.readyState===g.OPEN)return!0===this.ua.configuration.traceSip&&this.logger.log("sending WebSocket message:\n\n"+c+"\n"),this.ws.send(c),!0;this.logger.warn("unable to send message, WebSocket is not open");return!1},disconnect:function(){this.ws&&(c.Timers.clearTimeout(this.reconnectTimer),
this.closed=!0,this.logger.log("closing WebSocket "+this.server.ws_uri),this.ws.close());null!==this.reconnectTimer&&(c.Timers.clearTimeout(this.reconnectTimer),this.reconnectTimer=null,this.ua.emit("disconnected",{transport:this,code:this.lastTransportError.code,reason:this.lastTransportError.reason}))},connect:function(){var c=this;if(this.ws&&(this.ws.readyState===g.OPEN||this.ws.readyState===g.CONNECTING))return this.logger.log("WebSocket "+this.server.ws_uri+" is already connected"),!1;this.ws&&
this.ws.close();this.logger.log("connecting to WebSocket "+this.server.ws_uri);this.ua.onTransportConnecting(this,0===this.reconnection_attempts?1:this.reconnection_attempts);try{this.ws=new g(this.server.ws_uri,"sip")}catch(f){this.logger.warn("error connecting to WebSocket "+this.server.ws_uri+": "+f)}this.ws.binaryType="arraybuffer";this.ws.onopen=function(){c.onOpen()};this.ws.onclose=function(b){c.onClose(b)};this.ws.onmessage=function(b){c.onMessage(b)};this.ws.onerror=function(b){c.onError(b)}},
onOpen:function(){this.connected=!0;this.logger.log("WebSocket "+this.server.ws_uri+" connected");null!==this.reconnectTimer&&(c.Timers.clearTimeout(this.reconnectTimer),this.reconnectTimer=null);this.reconnection_attempts=0;this.closed=!1;this.ua.onTransportConnected(this)},onClose:function(c){var f=this.connected;this.lastTransportError.code=c.code;this.lastTransportError.reason=c.reason;if(0<this.reconnection_attempts)this.logger.log("Reconnection attempt "+this.reconnection_attempts+" failed (code: "+
c.code+(c.reason?"| reason: "+c.reason:"")+")"),this.reconnect();else if(this.connected=!1,this.logger.log("WebSocket disconnected (code: "+c.code+(c.reason?"| reason: "+c.reason:"")+")"),!1===c.wasClean&&this.logger.warn("WebSocket abrupt disconnection"),!0===f)this.ua.onTransportClosed(this),this.closed?this.ua.emit("disconnected",{transport:this,code:this.lastTransportError.code,reason:this.lastTransportError.reason}):this.reconnect();else this.ua.onTransportError(this)},onMessage:function(e){var f;
e=e.data;if("\r\n"===e)!0===this.ua.configuration.traceSip&&this.logger.log("received WebSocket message with CRLF Keep Alive response");else{if("string"!==typeof e){try{e=String.fromCharCode.apply(null,new Uint8Array(e))}catch(b){this.logger.warn("received WebSocket binary message failed to be converted into string, message discarded");return}!0===this.ua.configuration.traceSip&&this.logger.log("received WebSocket binary message:\n\n"+e+"\n")}else!0===this.ua.configuration.traceSip&&this.logger.log("received WebSocket text message:\n\n"+
e+"\n");if((e=c.Parser.parseMessage(e,this.ua))&&!(this.ua.status===c.UA.C.STATUS_USER_CLOSED&&e instanceof c.IncomingRequest)&&c.sanityCheck(e,this.ua,this))if(e instanceof c.IncomingRequest)e.transport=this,this.ua.receiveRequest(e);else if(e instanceof c.IncomingResponse)switch(e.method){case c.C.INVITE:(f=this.ua.transactions.ict[e.via_branch])&&f.receiveResponse(e);break;case c.C.ACK:break;default:(f=this.ua.transactions.nict[e.via_branch])&&f.receiveResponse(e)}}},onError:function(c){this.logger.warn("WebSocket connection error: "+
JSON.stringify(c))},reconnect:function(){var e=this;this.reconnection_attempts+=1;this.reconnection_attempts>this.ua.configuration.wsServerMaxReconnection?(this.logger.warn("maximum reconnection attempts for WebSocket "+this.server.ws_uri),this.ua.onTransportError(this)):1===this.reconnection_attempts?(this.logger.log("Connection to WebSocket "+this.server.ws_uri+" severed, attempting first reconnect"),e.connect()):(this.logger.log("trying to reconnect to WebSocket "+this.server.ws_uri+" (reconnection attempt "+
this.reconnection_attempts+")"),this.reconnectTimer=c.Timers.setTimeout(function(){e.connect();e.reconnectTimer=null},1E3*this.ua.configuration.wsServerReconnectionTimeout))}};f.C={STATUS_READY:0,STATUS_DISCONNECTED:1,STATUS_ERROR:2};return f}},{}],63:[function(k,l,n){(function(c){l.exports=function(g,f){function e(a){if(a instanceof Function)return a.initialize||(a.initialize=function(){return g.Utils.Promise.resolve()}),a}var h,b={STATUS_INIT:0,STATUS_STARTING:1,STATUS_READY:2,STATUS_USER_CLOSED:3,
STATUS_NOT_READY:4,CONFIGURATION_ERROR:1,NETWORK_ERROR:2,EVENT_METHODS:{invite:"INVITE",message:"MESSAGE"},ALLOWED_METHODS:"ACK CANCEL BYE OPTIONS INFO NOTIFY".split(" "),ACCEPTED_BODY_TYPES:["application/sdp","application/dtmf-relay"],MAX_FORWARDS:70,TAG_LENGTH:10};h=function(a){b.ACCEPTED_BODY_TYPES=b.ACCEPTED_BODY_TYPES.toString();this.log=new g.LoggerFactory;this.logger=this.getLogger("sip.ua");this.cache={credentials:{}};this.configuration={};this.dialogs={};this.applicants={};this.data={};this.sessions=
{};this.subscriptions={};this.contact=this.transport=null;this.status=b.STATUS_INIT;this.error=null;this.transactions={nist:{},nict:{},ist:{},ict:{}};this.transportRecoverAttempts=0;this.transportRecoveryTimer=null;Object.defineProperties(this,{transactionsCount:{get:function(){var a,b=["nist","nict","ist","ict"],c=0;for(a in b)c+=Object.keys(this.transactions[b[a]]).length;return c}},nictTransactionsCount:{get:function(){return Object.keys(this.transactions.nict).length}},nistTransactionsCount:{get:function(){return Object.keys(this.transactions.nist).length}},
ictTransactionsCount:{get:function(){return Object.keys(this.transactions.ict).length}},istTransactionsCount:{get:function(){return Object.keys(this.transactions.ist).length}}});if(void 0===a)a={};else if("string"===typeof a||a instanceof String)a={uri:a};a.log&&(a.log.hasOwnProperty("builtinEnabled")&&(this.log.builtinEnabled=a.log.builtinEnabled),a.log.hasOwnProperty("level")&&(this.log.level=a.log.level),a.log.hasOwnProperty("connector")&&(this.log.connector=a.log.connector));try{this.loadConfig(a)}catch(d){throw this.status=
b.STATUS_NOT_READY,this.error=b.CONFIGURATION_ERROR,d;}this.registerContext=new g.RegisterContext(this);this.registerContext.on("failed",this.emit.bind(this,"registrationFailed"));this.registerContext.on("registered",this.emit.bind(this,"registered"));this.registerContext.on("unregistered",this.emit.bind(this,"unregistered"));this.configuration.autostart&&this.start();"function"===typeof f.addEventListener&&(c.chrome&&c.chrome.app&&c.chrome.app.runtime||f.addEventListener("unload",this.stop.bind(this)))};
h.prototype=Object.create(g.EventEmitter.prototype);h.prototype.register=function(a){this.configuration.register=!0;this.registerContext.register(a);return this};h.prototype.unregister=function(a){this.configuration.register=!1;this.registerContext.unregister(a);return this};h.prototype.isRegistered=function(){return this.registerContext.registered};h.prototype.isConnected=function(){return this.transport?this.transport.connected:!1};h.prototype.afterConnected=function(a){if(this.isConnected())a();
else this.once("connected",a)};h.prototype.invite=function(a,b){var c=new g.InviteClientContext(this,a,b);this.afterConnected(c.invite.bind(c));return c};h.prototype.subscribe=function(a,b,c){a=new g.Subscription(this,a,b,c);this.afterConnected(a.subscribe.bind(a));return a};h.prototype.message=function(a,b,c){if(void 0===b)throw new TypeError("Not enough arguments");c=Object.create(c||Object.prototype);c.contentType||(c.contentType="text/plain");c.body=b;return this.request(g.C.MESSAGE,a,c)};h.prototype.request=
function(a,b,c){a=new g.ClientContext(this,a,b,c);this.afterConnected(a.send.bind(a));return a};h.prototype.stop=function(){function a(){0===h.nistTransactionsCount&&0===h.nictTransactionsCount&&(h.removeListener("transactionDestroyed",a),h.transport.disconnect())}var c,e,f,h=this;this.logger.log("user requested closure...");if(this.status===b.STATUS_USER_CLOSED)return this.logger.warn("UA already closed"),this;g.Timers.clearTimeout(this.transportRecoveryTimer);this.logger.log("closing registerContext");
this.registerContext.close();for(c in this.sessions)this.logger.log("closing session "+c),this.sessions[c].terminate();for(e in this.subscriptions)this.logger.log("unsubscribing from subscription "+e),this.subscriptions[e].close();for(f in this.applicants)this.applicants[f].close();this.status=b.STATUS_USER_CLOSED;if(0===this.nistTransactionsCount&&0===this.nictTransactionsCount)this.transport.disconnect();else this.on("transactionDestroyed",a);return this};h.prototype.start=function(){var a;this.logger.log("user requested startup...");
this.status===b.STATUS_INIT?(a=this.getNextWsServer(),this.status=b.STATUS_STARTING,new g.Transport(this,a)):this.status===b.STATUS_USER_CLOSED?(this.logger.log("resuming"),this.status=b.STATUS_READY,this.transport.connect()):this.status===b.STATUS_STARTING?this.logger.log("UA is in STARTING status, not opening new connection"):this.status===b.STATUS_READY?this.logger.log("UA is in READY status, not resuming"):this.logger.error("Connection is down. Auto-Recovery system is trying to connect");return this};
h.prototype.normalizeTarget=function(a){return g.Utils.normalizeTarget(a,this.configuration.hostportParams)};h.prototype.saveCredentials=function(a){this.cache.credentials[a.realm]=this.cache.credentials[a.realm]||{};this.cache.credentials[a.realm][a.uri]=a;return this};h.prototype.getCredentials=function(a){var b,c;b=a.ruri.host;this.cache.credentials[b]&&this.cache.credentials[b][a.ruri]&&(c=this.cache.credentials[b][a.ruri],c.method=a.method);return c};h.prototype.getLogger=function(a,b){return this.log.getLogger(a,
b)};h.prototype.onTransportClosed=function(a){var b,c,e=["nict","ict","nist","ist"];a.server.status=g.Transport.C.STATUS_DISCONNECTED;this.logger.log("connection state set to "+g.Transport.C.STATUS_DISCONNECTED);c=e.length;for(a=0;a<c;a++)for(b in this.transactions[e[a]])this.transactions[e[a]][b].onTransportError();this.contact.pub_gruu||this.closeSessionsOnTransportError()};h.prototype.onTransportError=function(a){this.logger.log("transport "+a.server.ws_uri+" failed | connection state set to "+
g.Transport.C.STATUS_ERROR);a.server.status=g.Transport.C.STATUS_ERROR;this.emit("disconnected",{transport:a});this.status!==b.STATUS_USER_CLOSED&&((a=this.getNextWsServer())?new g.Transport(this,a):(this.closeSessionsOnTransportError(),this.error&&this.error===b.NETWORK_ERROR||(this.status=b.STATUS_NOT_READY,this.error=b.NETWORK_ERROR),this.recoverTransport()))};h.prototype.onTransportConnected=function(a){this.transport=a;this.transportRecoverAttempts=0;a.server.status=g.Transport.C.STATUS_READY;
this.logger.log("connection state set to "+g.Transport.C.STATUS_READY);this.status!==b.STATUS_USER_CLOSED&&(this.status=b.STATUS_READY,this.error=null,this.configuration.register&&this.configuration.authenticationFactory.initialize().then(function(){this.registerContext.onTransportConnected()}.bind(this)),this.emit("connected",{transport:a}))};h.prototype.onTransportConnecting=function(a,b){this.emit("connecting",{transport:a,attempts:b})};h.prototype.newTransaction=function(a){this.transactions[a.type][a.id]=
a;this.emit("newTransaction",{transaction:a})};h.prototype.destroyTransaction=function(a){delete this.transactions[a.type][a.id];this.emit("transactionDestroyed",{transaction:a})};h.prototype.receiveRequest=function(a){function c(b){return b&&b.user===a.ruri.user}var e,f,h;f=a.method;h=a.method.toLowerCase();var k=this;if(!(c(this.configuration.uri)||c(this.contact.uri)||c(this.contact.pub_gruu)||c(this.contact.temp_gruu)))this.logger.warn("Request-URI does not point to us"),a.method!==g.C.ACK&&a.reply_sl(404);
else if(a.ruri.scheme===g.C.SIPS)a.reply_sl(416);else if(!g.Transactions.checkTransaction(this,a)){if(f===g.C.OPTIONS)new g.Transactions.NonInviteServerTransaction(a,this),a.reply(200,null,["Allow: "+g.Utils.getAllowedMethods(this),"Accept: "+b.ACCEPTED_BODY_TYPES]);else if(f===g.C.MESSAGE){if(!this.listeners(h).length){new g.Transactions.NonInviteServerTransaction(a,this);a.reply(405,null,["Allow: "+g.Utils.getAllowedMethods(this)]);return}h=new g.ServerContext(this,a);h.body=a.body;h.content_type=
a.getHeader("Content-Type")||"text/plain";a.reply(200,null);this.emit("message",h)}else f!==g.C.INVITE&&f!==g.C.ACK&&new g.ServerContext(this,a);if(a.to_tag)(e=this.findDialog(a))?(f===g.C.INVITE&&new g.Transactions.InviteServerTransaction(a,this),e.receiveRequest(a)):f===g.C.NOTIFY?(f=this.findSession(a))?f.receiveRequest(a):(this.logger.warn("received NOTIFY request for a non existent session"),a.reply(481,"Subscription does not exist")):f!==g.C.ACK&&a.reply(481);else switch(f){case g.C.INVITE:if(f=
this.configuration.replaces!==g.C.supported.UNSUPPORTED&&a.parseHeader("replaces"))if(e=this.dialogs[f.call_id+f.replaces_to_tag+f.replaces_from_tag],!e){a.reply_sl(481,null);break}else if(e.owner.status===g.Session.C.STATUS_TERMINATED){a.reply_sl(603,null);break}else if(e.state===g.Dialog.C.STATUS_CONFIRMED&&f.early_only){a.reply_sl(486,null);break}f=this.configuration.mediaHandlerFactory.isSupported;!f||f()?(f=new g.InviteServerContext(this,a),f.replacee=e&&e.owner,f.on("invite",function(){k.emit("invite",
this)})):(this.logger.warn("INVITE received but WebRTC is not supported"),a.reply(488));break;case g.C.BYE:a.reply(481);break;case g.C.CANCEL:(f=this.findSession(a))?f.receiveRequest(a):this.logger.warn("received CANCEL request for a non existent session");break;case g.C.ACK:break;default:a.reply(405)}}};h.prototype.findSession=function(a){return this.sessions[a.call_id+a.from_tag]||this.sessions[a.call_id+a.to_tag]||null};h.prototype.findDialog=function(a){return this.dialogs[a.call_id+a.from_tag+
a.to_tag]||this.dialogs[a.call_id+a.to_tag+a.from_tag]||null};h.prototype.getNextWsServer=function(){var a,b,c,e=[];b=this.configuration.wsServers.length;for(a=0;a<b;a++)c=this.configuration.wsServers[a],c.status!==g.Transport.C.STATUS_ERROR&&(0===e.length?e.push(c):c.weight>e[0].weight?e=[c]:c.weight===e[0].weight&&e.push(c));a=Math.floor(Math.random()*e.length);return e[a]};h.prototype.closeSessionsOnTransportError=function(){for(var a in this.sessions)this.sessions[a].onTransportError();this.registerContext.onTransportClosed()};
h.prototype.recoverTransport=function(a){var b,c,e,f;a=a||this;e=a.transportRecoverAttempts;c=a.configuration.wsServers.length;for(b=0;b<c;b++)a.configuration.wsServers[b].status=0;f=a.getNextWsServer();b=Math.floor(Math.random()*Math.pow(2,e)+1)*a.configuration.connectionRecoveryMinInterval;b>a.configuration.connectionRecoveryMaxInterval&&(this.logger.log("time for next connection attempt exceeds connectionRecoveryMaxInterval, resetting counter"),b=a.configuration.connectionRecoveryMinInterval,e=
0);this.logger.log("next connection attempt in "+b+" seconds");this.transportRecoveryTimer=g.Timers.setTimeout(function(){a.transportRecoverAttempts=e+1;new g.Transport(a,f)},1E3*b)};h.prototype.loadConfig=function(a){function b(c,e){var d=c.replace(/([a-z][A-Z])/g,function(a){return a[0]+"_"+a[1].toLowerCase()});if(c!==d){var f=a.hasOwnProperty(c);a.hasOwnProperty(d)&&(e.warn(d+" is deprecated, please use "+c),f&&e.warn(c+" overriding "+d));a[c]=f?a[c]:a[d]}}var c,f,k,l={viaHost:g.Utils.createRandomToken(12)+
".invalid",uri:new g.URI("sip","anonymous."+g.Utils.createRandomToken(6),"anonymous.invalid",null,null),wsServers:[{scheme:"WSS",sip_uri:"<sip:edge.sip.onsip.com;transport=ws;lr>",status:0,weight:0,ws_uri:"wss://edge.sip.onsip.com"}],password:null,registerExpires:600,register:!0,registrarServer:null,wsServerMaxReconnection:3,wsServerReconnectionTimeout:4,connectionRecoveryMinInterval:2,connectionRecoveryMaxInterval:30,usePreloadedRoute:!1,userAgentString:g.C.USER_AGENT,iceCheckingTimeout:5E3,noAnswerTimeout:60,
stunServers:["stun:stun.l.google.com:19302"],turnServers:[],traceSip:!1,hackViaTcp:!1,hackIpInContact:!1,hackWssInTransport:!1,autostart:!0,rel100:g.C.supported.UNSUPPORTED,replaces:g.C.supported.UNSUPPORTED,mediaHandlerFactory:g.WebRTC.MediaHandler.defaultFactory,authenticationFactory:e(function(a){return new g.DigestAuthentication(a)})};for(c in h.configuration_check.mandatory)if(b(c,this.logger),a.hasOwnProperty(c))if(f=a[c],k=h.configuration_check.mandatory[c](f),void 0!==k)l[c]=k;else throw new g.Exceptions.ConfigurationError(c,
f);else throw new g.Exceptions.ConfigurationError(c);g.Utils.optionsOverride(a,"rel100","reliable",!0,this.logger,g.C.supported.UNSUPPORTED);var n=["stunServers","turnServers"];for(c in h.configuration_check.optional)if(b(c,this.logger),a.hasOwnProperty(c)&&(f=a[c],!(f instanceof Array&&0===f.length&&0>n.indexOf(c)||null===f||""===f||void 0===f||"number"===typeof f&&isNaN(f))))if(k=h.configuration_check.optional[c](f),void 0!==k)l[c]=k;else throw new g.Exceptions.ConfigurationError(c,f);if(l.connectionRecoveryMaxInterval<
l.connectionRecoveryMinInterval)throw new g.Exceptions.ConfigurationError("connectionRecoveryMaxInterval",l.connectionRecoveryMaxInterval);0===l.displayName&&(l.displayName="0");l.instanceId||(l.instanceId=g.Utils.newUUID());l.sipjsId=g.Utils.createRandomToken(5);f=l.uri.clone();f.user=null;l.hostportParams=f.toString().replace(/^sip:/i,"");l.authorizationUser||(l.authorizationUser=l.uri.user);l.registrarServer||(f=l.uri.clone(),f.user=null,l.registrarServer=f);l.noAnswerTimeout*=1E3;l.hackIpInContact&&
(l.viaHost=g.Utils.getRandomTestNetIP());this.contact={pub_gruu:null,temp_gruu:null,uri:new g.URI("sip",g.Utils.createRandomToken(8),l.viaHost,null,{transport:l.hackWssInTransport?"wss":"ws"}),toString:function(a){a=a||{};var b=a.outbound||null,c="<",c=a.anonymous?c+(this.temp_gruu||("sip:anonymous@anonymous.invalid;transport="+l.hackWssInTransport?"wss":"ws")).toString():c+(this.pub_gruu||this.uri).toString();b&&(c+=";ob");return c+">"}};g.Utils.optionsOverride(l,"media","mediaConstraints",!0,this.logger);
for(c in l)h.configuration_skeleton[c].value=l[c];Object.defineProperties(this.configuration,h.configuration_skeleton);for(c in l)h.configuration_skeleton[c].value="";this.logger.log("configuration parameters after validation:");for(c in l)switch(c){case "uri":case "registrarServer":case "mediaHandlerFactory":this.logger.log("\u00b7 "+c+": "+l[c]);break;case "password":this.logger.log("\u00b7 "+c+": NOT SHOWN");break;default:this.logger.log("\u00b7 "+c+": "+JSON.stringify(l[c]))}};h.configuration_skeleton=
function(){var a,b,c={},e="sipjsId hostportParams uri wsServers authorizationUser connectionRecoveryMaxInterval connectionRecoveryMinInterval displayName hackViaTcp hackIpInContact hackWssInTransport iceCheckingTimeout instanceId noAnswerTimeout password registerExpires registrarServer reliable rel100 replaces userAgentString autostart stunServers traceSip turnServers usePreloadedRoute wsServerMaxReconnection wsServerReconnectionTimeout mediaHandlerFactory media mediaConstraints authenticationFactory via_core_value viaHost".split(" ");
for(a in e)b=e[a],c[b]={value:"",writable:!1,configurable:!1};c.register={value:"",writable:!0,configurable:!1};return c}();h.configuration_check={mandatory:{},optional:{uri:function(a){/^sip:/i.test(a)||(a=g.C.SIP+":"+a);if((a=g.URI.parse(a))&&a.user)return a},wsServers:function(a){var b,c,e;if("string"===typeof a)a=[{ws_uri:a}];else if(a instanceof Array)for(c=a.length,b=0;b<c;b++)"string"===typeof a[b]&&(a[b]={ws_uri:a[b]});else return;if(0===a.length)return!1;c=a.length;for(b=0;b<c;b++){if(!a[b].ws_uri||
a[b].weight&&!Number(a[b].weight))return;e=g.Grammar.parse(a[b].ws_uri,"absoluteURI");if(-1===e||"wss"!==e.scheme&&"ws"!==e.scheme)return;a[b].sip_uri="<sip:"+e.host+(e.port?":"+e.port:"")+";transport=ws;lr>";a[b].weight||(a[b].weight=0);a[b].status=0;a[b].scheme=e.scheme.toUpperCase()}return a},authorizationUser:function(a){if(-1!==g.Grammar.parse('"'+a+'"',"quoted_string"))return a},connectionRecoveryMaxInterval:function(a){if(g.Utils.isDecimal(a)&&(a=Number(a),0<a))return a},connectionRecoveryMinInterval:function(a){if(g.Utils.isDecimal(a)&&
(a=Number(a),0<a))return a},displayName:function(a){if(-1!==g.Grammar.parse('"'+a+'"',"displayName"))return a},hackViaTcp:function(a){if("boolean"===typeof a)return a},hackIpInContact:function(a){if("boolean"===typeof a)return a},iceCheckingTimeout:function(a){if(g.Utils.isDecimal(a))return 500>a?5E3:a},hackWssInTransport:function(a){if("boolean"===typeof a)return a},instanceId:function(a){if("string"===typeof a&&(/^uuid:/i.test(a)&&(a=a.substr(5)),-1!==g.Grammar.parse(a,"uuid")))return a},noAnswerTimeout:function(a){if(g.Utils.isDecimal(a)&&
(a=Number(a),0<a))return a},password:function(a){return String(a)},rel100:function(a){return a===g.C.supported.REQUIRED?g.C.supported.REQUIRED:a===g.C.supported.SUPPORTED?g.C.supported.SUPPORTED:g.C.supported.UNSUPPORTED},replaces:function(a){return a===g.C.supported.REQUIRED?g.C.supported.REQUIRED:a===g.C.supported.SUPPORTED?g.C.supported.SUPPORTED:g.C.supported.UNSUPPORTED},register:function(a){if("boolean"===typeof a)return a},registerExpires:function(a){if(g.Utils.isDecimal(a)&&(a=Number(a),0<
a))return a},registrarServer:function(a){if("string"===typeof a&&(/^sip:/i.test(a)||(a=g.C.SIP+":"+a),(a=g.URI.parse(a))&&!a.user))return a},stunServers:function(a){var b,c,e;if("string"===typeof a)a=[a];else if(!(a instanceof Array))return;c=a.length;for(b=0;b<c;b++){e=a[b];/^stuns?:/.test(e)||(e="stun:"+e);if(-1===g.Grammar.parse(e,"stun_URI"))return;a[b]=e}return a},traceSip:function(a){if("boolean"===typeof a)return a},turnServers:function(a){var b,c,e,f,h,k;a instanceof Array||(a=[a]);e=a.length;
for(b=0;b<e;b++){f=a[b];f.server&&(f.urls=[f.server]);if(!f.urls||!f.username||!f.password)return;f.urls instanceof Array?h=f.urls.length:(f.urls=[f.urls],h=1);for(c=0;c<h;c++)if(k=f.urls[c],/^turns?:/.test(k)||(k="turn:"+k),-1===g.Grammar.parse(k,"turn_URI"))return}return a},userAgentString:function(a){if("string"===typeof a)return a},usePreloadedRoute:function(a){if("boolean"===typeof a)return a},wsServerMaxReconnection:function(a){if(g.Utils.isDecimal(a)&&(a=Number(a),0<a))return a},wsServerReconnectionTimeout:function(a){if(g.Utils.isDecimal(a)&&
(a=Number(a),0<a))return a},autostart:function(a){if("boolean"===typeof a)return a},mediaHandlerFactory:function(a){if(a instanceof Function){var b=function(){function b(a){1<c[a].length&&(c[a]=g.Utils.promisify(c,a,"getDescription"===a))}var c=a.apply(this,arguments);b("getDescription");b("setDescription");return c};b.isSupported=a.isSupported;return b}},authenticationFactory:e}};h.C=b;g.UA=h}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?
window:{})},{}],64:[function(k,l,n){l.exports=function(c){var g;g=function(f,e,h,b,a,d){var g,k;if(!h)throw new TypeError('missing or invalid "host" parameter');f=f||c.C.SIP;this.parameters={};this.headers={};for(g in a)this.setParam(g,a[g]);for(k in d)this.setHeader(k,d[k]);Object.defineProperties(this,{scheme:{get:function(){return f},set:function(a){f=a.toLowerCase()}},user:{get:function(){return e},set:function(a){e=a}},host:{get:function(){return h},set:function(a){h=a.toLowerCase()}},aor:{get:function(){return e+
"@"+h}},port:{get:function(){return b},set:function(a){b=0===a?a:parseInt(a,10)||null}}})};g.prototype={setParam:function(c,e){c&&(this.parameters[c.toLowerCase()]="undefined"===typeof e||null===e?null:e.toString().toLowerCase())},getParam:function(c){if(c)return this.parameters[c.toLowerCase()]},hasParam:function(c){if(c)return this.parameters.hasOwnProperty(c.toLowerCase())&&!0||!1},deleteParam:function(c){var e;c=c.toLowerCase();if(this.parameters.hasOwnProperty(c))return e=this.parameters[c],
delete this.parameters[c],e},clearParams:function(){this.parameters={}},setHeader:function(f,e){this.headers[c.Utils.headerize(f)]=e instanceof Array?e:[e]},getHeader:function(f){if(f)return this.headers[c.Utils.headerize(f)]},hasHeader:function(f){if(f)return this.headers.hasOwnProperty(c.Utils.headerize(f))&&!0||!1},deleteHeader:function(f){var e;f=c.Utils.headerize(f);if(this.headers.hasOwnProperty(f))return e=this.headers[f],delete this.headers[f],e},clearHeaders:function(){this.headers={}},clone:function(){return new g(this.scheme,
this.user,this.host,this.port,JSON.parse(JSON.stringify(this.parameters)),JSON.parse(JSON.stringify(this.headers)))},toString:function(){var f,e,h,b,a=[];b=this.scheme+":";this.scheme.match("^sips?$")||(b+="//");this.user&&(b+=c.Utils.escapeUser(this.user)+"@");b+=this.host;if(this.port||0===this.port)b+=":"+this.port;for(e in this.parameters)b+=";"+e,null!==this.parameters[e]&&(b+="="+this.parameters[e]);for(f in this.headers)for(h in this.headers[f])a.push(f+"="+this.headers[f][h]);0<a.length&&
(b+="?"+a.join("&"));return b}};g.parse=function(f){f=c.Grammar.parse(f,"SIP_URI");if(-1!==f)return f};c.URI=g}},{}],65:[function(k,l,n){l.exports=function(c,g){var f;f={Promise:g.Promise,defer:function(){var c={};c.promise=new f.Promise(function(f,b){c.resolve=f;c.reject=b});return c},promisify:function(c,h,b){var a=c[h];return function(d,h,g){return(new f.Promise(function(f,h){var g=[d,f,h];b&&(g=[f,h,d]);a.apply(c,g)})).then(h,g)}},augment:function(c,f,b,a){var d,g;g=f.prototype;for(d in g)if(a||
void 0===c[d])c[d]=g[d];f.apply(c,b)},optionsOverride:function(c,f,b,a,d,g){a&&c[b]&&d.warn(b+" is deprecated, please use "+f+" instead");c[f]&&c[b]&&d.warn(f+" overriding "+b);c[f]=c[f]||c[b]||g},str_utf8_length:function(c){return encodeURIComponent(c).replace(/%[A-F\d]{2}/g,"U").length},generateFakeSDP:function(c){if(c){var f=c.indexOf("o="),b=c.indexOf("\r\n",f);return"v=0\r\n"+c.slice(f,b)+"\r\ns=-\r\nt=0 0\r\nc=IN IP4 0.0.0.0"}},isFunction:function(c){return void 0!==c?"[object Function]"===
Object.prototype.toString.call(c):!1},isDecimal:function(c){return!isNaN(c)&&parseFloat(c)===parseInt(c,10)},createRandomToken:function(c,f){var b,a,d="";f=f||32;for(b=0;b<c;b++)a=Math.random()*f|0,d+=a.toString(f);return d},newTag:function(){return c.Utils.createRandomToken(c.UA.C.TAG_LENGTH)},newUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var f=16*Math.random()|0;return("x"===c?f:f&3|8).toString(16)})},hostType:function(e){if(e&&(e=c.Grammar.parse(e,
"host"),-1!==e))return e.host_type},normalizeTarget:function(e,f){var b,a;if(e){if(e instanceof c.URI)return e;if("string"===typeof e){a=e.split("@");switch(a.length){case 1:if(!f)return;b=e;a=f;break;case 2:b=a[0];a=a[1];break;default:b=a.slice(0,a.length-1).join("@"),a=a[a.length-1]}b=b.replace(/^(sips?|tel):/i,"");/^[\-\.\(\)]*\+?[0-9\-\.\(\)]+$/.test(b)&&(b=b.replace(/[\-\.\(\)]/g,""));e=c.C.SIP+":"+c.Utils.escapeUser(b)+"@"+a;if(b=c.URI.parse(e))return b}}},escapeUser:function(c){return encodeURIComponent(decodeURIComponent(c)).replace(/%3A/ig,
":").replace(/%2B/ig,"+").replace(/%3F/ig,"?").replace(/%2F/ig,"/")},headerize:function(c){var f={"Call-Id":"Call-ID",Cseq:"CSeq",Rack:"RAck",Rseq:"RSeq","Www-Authenticate":"WWW-Authenticate"};c=c.toLowerCase().replace(/_/g,"-").split("-");var b="",a=c.length,d;for(d=0;d<a;d++)0!==d&&(b+="-"),b+=c[d].charAt(0).toUpperCase()+c[d].substring(1);f[b]&&(b=f[b]);return b},sipErrorCause:function(e){for(var f in c.C.SIP_ERROR_CAUSES)if(-1!==c.C.SIP_ERROR_CAUSES[f].indexOf(e))return c.C.causes[f];return c.C.causes.SIP_FAILURE_CODE},
getReasonPhrase:function(e,f){return f||c.C.REASON_PHRASE[e]||""},getReasonHeaderValue:function(e,f){f=c.Utils.getReasonPhrase(e,f);return"SIP ;cause="+e+' ;text="'+f+'"'},getCancelReason:function(e,f){if(e&&200>e||699<e)throw new TypeError("Invalid status_code: "+e);if(e)return c.Utils.getReasonHeaderValue(e,f)},buildStatusLine:function(c,h){c=c||null;h=h||null;if(!c||100>c||699<c)throw new TypeError("Invalid status_code: "+c);if(h&&"string"!==typeof h&&!(h instanceof String))throw new TypeError("Invalid reason_phrase: "+
h);h=f.getReasonPhrase(c,h);return"SIP/2.0 "+c+" "+h+"\r\n"},getRandomTestNetIP:function(){return"192.0.2."+Math.floor(254*Math.random()+1)},getAllowedMethods:function(e){var f,b=c.UA.C.ALLOWED_METHODS.toString();for(f in c.UA.C.EVENT_METHODS)e.listeners(f).length&&(b+=","+c.UA.C.EVENT_METHODS[f]);return b},calculateMD5:function(c){function f(a,b){var c,d,e,g,h;e=a&2147483648;g=b&2147483648;c=a&1073741824;d=b&1073741824;h=(a&1073741823)+(b&1073741823);return c&d?h^2147483648^e^g:c|d?h&1073741824?
h^3221225472^e^g:h^1073741824^e^g:h^e^g}function b(a,b,c,d,e,g,k){a=f(a,f(f(b&c|~b&d,e),k));return f(a<<g|a>>>32-g,b)}function a(a,b,c,d,e,g,k){a=f(a,f(f(b&d|c&~d,e),k));return f(a<<g|a>>>32-g,b)}function d(a,b,c,d,e,g,k){a=f(a,f(f(b^c^d,e),k));return f(a<<g|a>>>32-g,b)}function g(a,b,c,d,e,k,l){a=f(a,f(f(c^(b|~d),e),l));return f(a<<k|a>>>32-k,b)}function k(a){var b="",c="",d;for(d=0;3>=d;d++)c=a>>>8*d&255,c="0"+c.toString(16),b+=c.substr(c.length-2,2);return b}var l=[],n,A,v,C,q,r,t,u;c=function(a){a=
a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):(127<d&&2048>d?b+=String.fromCharCode(d>>6|192):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128)),b+=String.fromCharCode(d&63|128))}return b}(c);l=function(a){var b,c=a.length;b=c+8;for(var d=16*((b-b%64)/64+1),e=Array(d-1),f=0,g=0;g<c;)b=(g-g%4)/4,f=g%4*8,e[b]|=a.charCodeAt(g)<<f,g++;b=(g-g%4)/4;e[b]|=128<<g%4*8;e[d-2]=c<<3;e[d-1]=c>>>29;return e}(c);q=1732584193;r=
4023233417;t=2562383102;u=271733878;for(c=0;c<l.length;c+=16)n=q,A=r,v=t,C=u,q=b(q,r,t,u,l[c+0],7,3614090360),u=b(u,q,r,t,l[c+1],12,3905402710),t=b(t,u,q,r,l[c+2],17,606105819),r=b(r,t,u,q,l[c+3],22,3250441966),q=b(q,r,t,u,l[c+4],7,4118548399),u=b(u,q,r,t,l[c+5],12,1200080426),t=b(t,u,q,r,l[c+6],17,2821735955),r=b(r,t,u,q,l[c+7],22,4249261313),q=b(q,r,t,u,l[c+8],7,1770035416),u=b(u,q,r,t,l[c+9],12,2336552879),t=b(t,u,q,r,l[c+10],17,4294925233),r=b(r,t,u,q,l[c+11],22,2304563134),q=b(q,r,t,u,l[c+12],
7,1804603682),u=b(u,q,r,t,l[c+13],12,4254626195),t=b(t,u,q,r,l[c+14],17,2792965006),r=b(r,t,u,q,l[c+15],22,1236535329),q=a(q,r,t,u,l[c+1],5,4129170786),u=a(u,q,r,t,l[c+6],9,3225465664),t=a(t,u,q,r,l[c+11],14,643717713),r=a(r,t,u,q,l[c+0],20,3921069994),q=a(q,r,t,u,l[c+5],5,3593408605),u=a(u,q,r,t,l[c+10],9,38016083),t=a(t,u,q,r,l[c+15],14,3634488961),r=a(r,t,u,q,l[c+4],20,3889429448),q=a(q,r,t,u,l[c+9],5,568446438),u=a(u,q,r,t,l[c+14],9,3275163606),t=a(t,u,q,r,l[c+3],14,4107603335),r=a(r,t,u,q,l[c+
8],20,1163531501),q=a(q,r,t,u,l[c+13],5,2850285829),u=a(u,q,r,t,l[c+2],9,4243563512),t=a(t,u,q,r,l[c+7],14,1735328473),r=a(r,t,u,q,l[c+12],20,2368359562),q=d(q,r,t,u,l[c+5],4,4294588738),u=d(u,q,r,t,l[c+8],11,2272392833),t=d(t,u,q,r,l[c+11],16,1839030562),r=d(r,t,u,q,l[c+14],23,4259657740),q=d(q,r,t,u,l[c+1],4,2763975236),u=d(u,q,r,t,l[c+4],11,1272893353),t=d(t,u,q,r,l[c+7],16,4139469664),r=d(r,t,u,q,l[c+10],23,3200236656),q=d(q,r,t,u,l[c+13],4,681279174),u=d(u,q,r,t,l[c+0],11,3936430074),t=d(t,u,
q,r,l[c+3],16,3572445317),r=d(r,t,u,q,l[c+6],23,76029189),q=d(q,r,t,u,l[c+9],4,3654602809),u=d(u,q,r,t,l[c+12],11,3873151461),t=d(t,u,q,r,l[c+15],16,530742520),r=d(r,t,u,q,l[c+2],23,3299628645),q=g(q,r,t,u,l[c+0],6,4096336452),u=g(u,q,r,t,l[c+7],10,1126891415),t=g(t,u,q,r,l[c+14],15,2878612391),r=g(r,t,u,q,l[c+5],21,4237533241),q=g(q,r,t,u,l[c+12],6,1700485571),u=g(u,q,r,t,l[c+3],10,2399980690),t=g(t,u,q,r,l[c+10],15,4293915773),r=g(r,t,u,q,l[c+1],21,2240044497),q=g(q,r,t,u,l[c+8],6,1873313359),u=
g(u,q,r,t,l[c+15],10,4264355552),t=g(t,u,q,r,l[c+6],15,2734768916),r=g(r,t,u,q,l[c+13],21,1309151649),q=g(q,r,t,u,l[c+4],6,4149444226),u=g(u,q,r,t,l[c+11],10,3174756917),t=g(t,u,q,r,l[c+2],15,718787259),r=g(r,t,u,q,l[c+9],21,3951481745),q=f(q,n),r=f(r,A),t=f(t,v),u=f(u,C);return(k(q)+k(r)+k(t)+k(u)).toLowerCase()}};c.Utils=f}},{}],66:[function(k,l,n){l.exports=function(c,g){var f;f={};f.MediaHandler=k("./WebRTC/MediaHandler")(c);f.MediaStreamManager=k("./WebRTC/MediaStreamManager")(c,g);var e;f.isSupported=
function(){if(void 0!==e)return e;f.MediaStream=g.MediaStream;f.getUserMedia=g.getUserMedia;f.RTCPeerConnection=g.RTCPeerConnection;f.RTCSessionDescription=g.RTCSessionDescription;f.RTCPeerConnection&&f.RTCSessionDescription?(f.getUserMedia&&(f.getUserMedia=c.Utils.promisify(g,"getUserMedia")),e=!0):e=!1;return e};return f}},{"./WebRTC/MediaHandler":67,"./WebRTC/MediaStreamManager":68}],67:[function(k,l,n){l.exports=function(c){var g=function(f,e){function g(a,b){if(a.mediaStreamManager.on)a.mediaStreamManager.on(b,
function(){a.emit.apply(a,[b].concat(Array.prototype.slice.call(arguments)))})}e=e||{};this.logger=f.ua.getLogger("sip.invitecontext.mediahandler",f.id);this.session=f;this.localMedia=null;this.ready=!0;this.mediaStreamManager=e.mediaStreamManager||new c.WebRTC.MediaStreamManager(this.logger);this.videoMuted=this.audioMuted=!1;var b,a,d,k,l=this,n=[];b=e.stunServers||null;var y=e.turnServers||null,A=this.session.ua.configuration;this.RTCConstraints=e.RTCConstraints||{};b||(b=A.stunServers);y||(y=
A.turnServers);[].concat(b).forEach(function(a){n.push({url:a})});d=y.length;for(b=0;b<d;b++)for(k=y[b],a=0;a<k.urls.length;a++)n.push({url:k.urls[a],username:k.username,credential:k.password});this.onIceCompleted=c.Utils.defer();this.onIceCompleted.promise.then(function(a){l.emit("iceGatheringComplete",a);l.iceCheckingTimer&&(c.Timers.clearTimeout(l.iceCheckingTimer),l.iceCheckingTimer=null)});this.peerConnection=new c.WebRTC.RTCPeerConnection({iceServers:n},this.RTCConstraints);this._remoteStreams=
[];this.peerConnection.onaddstream=function(a){l.logger.log("stream added: "+a.stream.id);l._remoteStreams.push(a.stream);l.render();l.emit("addStream",a)};this.peerConnection.onremovestream=function(a){l.logger.log("stream removed: "+a.stream.id)};this.peerConnection.onicecandidate=function(a){l.emit("iceCandidate",a);a.candidate?l.logger.log("ICE candidate received: "+(null===a.candidate.candidate?null:a.candidate.candidate.trim())):l.onIceCompleted.resolve(this)};this.peerConnection.onicegatheringstatechange=
function(){l.logger.log("RTCIceGatheringState changed: "+this.iceGatheringState);"gathering"===this.iceGatheringState&&l.emit("iceGathering",this);"complete"===this.iceGatheringState&&l.onIceCompleted.resolve(this)};this.peerConnection.oniceconnectionstatechange=function(){var a;"checking"===this.iceConnectionState&&(l.iceCheckingTimer=c.Timers.setTimeout(function(){l.logger.log("RTCIceChecking Timeout Triggered after "+A.iceCheckingTimeout+" milliseconds");l.onIceCompleted.resolve(this)}.bind(this),
A.iceCheckingTimeout));switch(this.iceConnectionState){case "new":a="iceConnection";break;case "checking":a="iceConnectionChecking";break;case "connected":a="iceConnectionConnected";break;case "completed":a="iceConnectionCompleted";break;case "failed":a="iceConnectionFailed";break;case "disconnected":a="iceConnectionDisconnected";break;case "closed":a="iceConnectionClosed";break;default:l.logger.warn("Unknown iceConnection state:",this.iceConnectionState);return}l.emit(a,this)};this.peerConnection.onstatechange=
function(){l.logger.log('PeerConnection state changed to "'+this.readyState+'"')};g(this,"userMediaRequest");g(this,"userMedia");g(this,"userMediaFailed")};g.defaultFactory=function(c,e){return new g(c,e)};g.defaultFactory.isSupported=function(){return c.WebRTC.isSupported()};g.prototype=Object.create(c.MediaHandler.prototype,{isReady:{writable:!0,value:function(){return this.ready}},close:{writable:!0,value:function(){this.logger.log("closing PeerConnection");this._remoteStreams=[];this.peerConnection&&
"closed"!==this.peerConnection.signalingState&&(this.peerConnection.close(),this.localMedia&&this.mediaStreamManager.release(this.localMedia))}},getDescription:{writable:!0,value:function(f){var e=this,g=e.mediaStreamManager.acquire;1<g.length&&(g=c.Utils.promisify(this.mediaStreamManager,"acquire",!0));f=f||{};!0===f.dataChannel&&(f.dataChannel={});this.mediaHint=f;e.localMedia?(e.logger.log("already have local media"),g=c.Utils.Promise.resolve(e.localMedia)):(e.logger.log("acquiring local media"),
g=g.call(e.mediaStreamManager,f).then(function(b){e.logger.log("acquired local media streams");e.localMedia=b;e.session.connecting();return b},function(b){e.logger.error("unable to acquire streams");e.logger.error(b);e.session.connecting();throw b;}).then(this.addStreams.bind(this)));return g.then(function(){e.hasOffer("remote")?e.peerConnection.ondatachannel=function(b){e.dataChannel=b.channel;e.emit("dataChannel",e.dataChannel)}:f.dataChannel&&e.peerConnection.createDataChannel&&(e.dataChannel=
e.peerConnection.createDataChannel("sipjs",f.dataChannel),e.emit("dataChannel",e.dataChannel));e.render();return e.createOfferOrAnswer(e.RTCConstraints)})}},setDescription:{writable:!0,value:function(f){f={type:this.hasOffer("local")?"answer":"offer",sdp:f};this.emit("setDescription",f);f=new c.WebRTC.RTCSessionDescription(f);return c.Utils.promisify(this.peerConnection,"setRemoteDescription")(f)}},getReferMedia:{writable:!0,value:function(){function c(e,b){return 0<b[e]().length}function e(e){return this.getLocalStreams().some(c.bind(null,
e))&&this.getRemoteStreams().some(c.bind(null,e))}return{constraints:{audio:e.call(this,"getAudioTracks"),video:e.call(this,"getVideoTracks")}}}},isMuted:{writable:!0,value:function(){return{audio:this.audioMuted,video:this.videoMuted}}},mute:{writable:!0,value:function(c){if(0!==this.getLocalStreams().length){c=c||{audio:0<this.getLocalStreams()[0].getAudioTracks().length,video:0<this.getLocalStreams()[0].getVideoTracks().length};var e=!1,g=!1;c.audio&&!this.audioMuted&&(this.audioMuted=e=!0,this.toggleMuteAudio(!0));
c.video&&!this.videoMuted&&(this.videoMuted=g=!0,this.toggleMuteVideo(!0));if(e||g)return{audio:e,video:g}}}},unmute:{writable:!0,value:function(c){if(0!==this.getLocalStreams().length){c=c||{audio:0<this.getLocalStreams()[0].getAudioTracks().length,video:0<this.getLocalStreams()[0].getVideoTracks().length};var e=!1,g=!1;c.audio&&this.audioMuted&&(e=!0,this.audioMuted=!1,this.toggleMuteAudio(!1));c.video&&this.videoMuted&&(g=!0,this.videoMuted=!1,this.toggleMuteVideo(!1));if(e||g)return{audio:e,video:g}}}},
hold:{writable:!0,value:function(){this.toggleMuteAudio(!0);this.toggleMuteVideo(!0)}},unhold:{writable:!0,value:function(){this.audioMuted||this.toggleMuteAudio(!1);this.videoMuted||this.toggleMuteVideo(!1)}},getLocalStreams:{writable:!0,value:function(){var c=this.peerConnection;return c&&"closed"===c.signalingState?(this.logger.warn("peerConnection is closed, getLocalStreams returning []"),[]):c.getLocalStreams&&c.getLocalStreams()||c.localStreams||[]}},getRemoteStreams:{writable:!0,value:function(){var c=
this.peerConnection;return c&&"closed"===c.signalingState?(this.logger.warn("peerConnection is closed, getRemoteStreams returning this._remoteStreams"),this._remoteStreams):c.getRemoteStreams&&c.getRemoteStreams()||c.remoteStreams||[]}},render:{writable:!0,value:function(f){f=f||this.mediaHint&&this.mediaHint.render;if(!f)return!1;var e={local:"getLocalStreams",remote:"getRemoteStreams"};Object.keys(e).forEach(function(g){var b=this[e[g]]();c.WebRTC.MediaStreamManager.render(b,f[g])}.bind(this))}},
hasOffer:{writable:!0,value:function(c){return this.peerConnection.signalingState==="have-"+c+"-offer"}},createOfferOrAnswer:{writable:!0,value:function(f){var e=this,g,b=e.peerConnection;e.ready=!1;g=e.hasOffer("remote")?"createAnswer":"createOffer";return c.Utils.promisify(b,g,!0)(f).then(c.Utils.promisify(b,"setLocalDescription")).then(function(){var a=c.Utils.defer();"complete"===b.iceConnectionState||"completed"===b.iceConnectionState?a.resolve():e.onIceCompleted.promise.then(a.resolve);return a.promise}).then(function(){var a=
b.localDescription.sdp,a=c.Hacks.Chrome.needsExplicitlyInactiveSDP(a),a=c.Hacks.AllBrowsers.unmaskDtls(a),a=c.Hacks.Firefox.hasIncompatibleCLineWithSomeSIPEndpoints(a),a={type:"createOffer"===g?"offer":"answer",sdp:a};e.emit("getDescription",a);e.ready=!0;return a.sdp}).catch(function(a){e.logger.error(a);e.ready=!0;throw new c.Exceptions.GetDescriptionError(a);})}},addStreams:{writable:!0,value:function(f){try{f=[].concat(f),f.forEach(function(c){this.peerConnection.addStream(c)},this)}catch(e){return this.logger.error("error adding stream"),
this.logger.error(e),c.Utils.Promise.reject(e)}return c.Utils.Promise.resolve()}},toggleMuteHelper:{writable:!0,value:function(c,e){this.getLocalStreams().forEach(function(g){g[c]().forEach(function(b){b.enabled=!e})})}},toggleMuteAudio:{writable:!0,value:function(c){this.toggleMuteHelper("getAudioTracks",c)}},toggleMuteVideo:{writable:!0,value:function(c){this.toggleMuteHelper("getVideoTracks",c)}}});return g}},{}],68:[function(k,l,n){l.exports=function(c,g){var f=function(e,f){if(!c.WebRTC.isSupported())throw new c.Exceptions.NotSupportedError("Media not supported");
this.mediaHint=f||{constraints:{audio:!0,video:!0}};this.acquisitions={}};f.streamId=function(c){return c.getAudioTracks().concat(c.getVideoTracks()).map(function(c){return c.id}).join("")};f.render=function(e,f){function b(a,b){if("undefined"!==typeof a.src)g.revokeObjectURL(a.src),a.src=g.createObjectURL(b);else if("undefined"!==typeof(a.srcObject||a.mozSrcObject))a.srcObject=a.mozSrcObject=b;else return!1;return!0}function a(a){a.ensurePlayingIntervalId=c.Timers.setInterval(function(){a.paused?
a.play():c.Timers.clearInterval(a.ensurePlayingIntervalId)},100)}if(!f)return!1;if(Array.isArray(f)&&!f.length)throw new TypeError("elements must not be empty");f=[].concat(f);[].concat(e).forEach(function(c,e,f){"function"===typeof c&&(c=c());c=c[f%c.length];(g.attachMediaStream||b)(c,e);a(c)}.bind(null,f))};f.prototype=Object.create(c.EventEmitter.prototype,{acquire:{writable:!0,value:function(e){e=Object.keys(e||{}).length?e:this.mediaHint;var g=function(a,b){b=[].concat(b);b.forEach(function(b){b=
f.streamId(b);this.acquisitions[b]=!!a},this);return c.Utils.Promise.resolve(b)}.bind(this);if(e.stream)return g(!0,e.stream);var b=e.constraints||this.mediaHint&&this.mediaHint.constraints||{audio:!0,video:!0},a=c.Utils.defer();c.Timers.setTimeout(function(){this.emit("userMediaRequest",b);var d=function(a,b){var c=Array.prototype.slice.call(arguments,2),d=[a].concat(c);this.emit.apply(this,d);return b.apply(null,c)}.bind(this);a.resolve(c.WebRTC.getUserMedia(b).then(d.bind(this,"userMedia",g.bind(null,
!1)),d.bind(this,"userMediaFailed",function(a){throw a;})))}.bind(this),0);return a.promise}},release:{writable:!0,value:function(c){c=[].concat(c);c.forEach(function(c){var b=f.streamId(c);!1===this.acquisitions[b]&&c.stop();delete this.acquisitions[b]},this)}}});return f}},{}],69:[function(k,l,n){(function(c){function g(c,e){if(null!=c){var g=e.charAt(0).toUpperCase()+e.slice(1),g=[e,"webkit"+g,"moz"+g],b;for(b in g){var a=c[g[b]];if(a)return a.bind(c)}}}c=c.window||c;l.exports={WebSocket:c.WebSocket,
Transport:k("./Transport"),open:c.open,Promise:c.Promise,timers:c,console:c.console||{debug:function(){},log:function(){},warn:function(){},error:function(){}},MediaStream:g(c,"MediaStream"),getUserMedia:g(c.navigator,"getUserMedia"),RTCPeerConnection:g(c,"RTCPeerConnection"),RTCSessionDescription:g(c,"RTCSessionDescription"),addEventListener:g(c,"addEventListener"),HTMLMediaElement:c.HTMLMediaElement,attachMediaStream:c.attachMediaStream,createObjectURL:c.URL&&c.URL.createObjectURL,revokeObjectURL:c.URL&&
c.URL.revokeObjectURL}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./Transport":62}],70:[function(k,l,n){l.exports=k("./SIP")(k("./environment"))},{"./SIP":53,"./environment":69}],71:[function(k,l,n){n.XMLHttpRequest=XMLHttpRequest},{}],72:[function(k,l,n){l.exports={name:"twilio-rtc-conversations",title:"Twilio RTC Conversations",description:"Twilio RTC Conversations JavaScript library",version:"0.8.3",homepage:"https://twilio.com",
author:"Mark Andrus Roberts <mroberts@twilio.com>",keywords:["twilio","webrtc","library","javascript"],devDependencies:{browserify:"^9.0.3",cheerio:"^0.18.0",closurecompiler:"^1.5.1",jsdoc:"^3.3.0-beta2",jshint:"^2.6.3","jshint-stylish":"^1.0.0",jsonwebtoken:"^5.0.0",mocha:"^1.21.5",promptly:"^0.2.0",q:"^1.0.1",twilio:"*"},engines:{node:">=0.12"},license:"MIT","private":!0,scripts:{test:"make test"},dependencies:{"sip.js":"git+ssh://git@code.hq.twilio.com/client/SIP.js.git#stable-twilio",ws:"^0.6.3",
xmlhttprequest:"git+https://github.com/markandrus/node-XMLHttpRequest.git"}}},{}],73:[function(k,l,n){(function(c){function g(){Object.defineProperties(this,{AccessToken:{enumerable:!0,value:f},Endpoint:{enumerable:!0,value:e},getUserMedia:{enumerable:!0,value:h},LocalMedia:{enumerable:!0,value:b}});return this}var f=k("../lib/accesstoken"),e=k("../lib/endpoint"),h=k("../lib/webrtc/getusermedia"),b=k("../lib/media").LocalMedia;(c.Twilio=c.Twilio||new g).Endpoint||g.call(c.Twilio)}).call(this,"undefined"!==
typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"../lib/accesstoken":1,"../lib/endpoint":3,"../lib/media":5,"../lib/webrtc/getusermedia":25}]},{},[73]);
